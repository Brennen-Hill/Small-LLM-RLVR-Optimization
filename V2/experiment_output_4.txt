Experiment Starting...
Loading Datasets...
Map:   0%|          | 0/500 [00:00<?, ? examples/s]Map: 100%|##########| 500/500 [00:00<00:00, 16005.62 examples/s]
Map:   0%|          | 0/500 [00:00<?, ? examples/s]Map: 100%|##########| 500/500 [00:00<00:00, 16305.78 examples/s]

====================
STARTING Method 1: Baseline
====================

=== METHOD 1: BASELINE (SEQUENTIAL) ===

>>> Training: m1_step1_math
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:51<50:14, 51.10s/it]  3%|3         | 2/60 [01:33<44:37, 46.16s/it]  5%|5         | 3/60 [02:00<35:35, 37.46s/it]  7%|6         | 4/60 [02:24<29:46, 31.91s/it]  8%|8         | 5/60 [03:07<32:58, 35.97s/it]                                              {'loss': 0.021, 'grad_norm': 0.8019441366195679, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 26263.0, 'completions/mean_length': 218.0375, 'completions/min_length': 80.8, 'completions/max_length': 437.8, 'completions/clipped_ratio': 0.0625, 'completions/mean_terminated_length': 199.8268585205078, 'completions/min_terminated_length': 80.8, 'completions/max_terminated_length': 352.2, 'rewards/format_reward_func/mean': 0.1875, 'rewards/format_reward_func/std': 0.24146220088005066, 'rewards/correctness_reward_func/mean': 0.625, 'rewards/correctness_reward_func/std': 0.777623450756073, 'reward': 0.8125, 'reward_std': 0.7263696789741516, 'frac_reward_zero_std': 0.05, 'kl': 0.0023619812447577713, 'entropy': 0.8945650160312653, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.926833516388434, 'epoch': 0.04}
  8%|8         | 5/60 [03:07<32:58, 35.97s/it] 10%|#         | 6/60 [03:46<33:24, 37.13s/it] 12%|#1        | 7/60 [04:11<29:17, 33.15s/it] 13%|#3        | 8/60 [04:34<25:47, 29.75s/it] 15%|#5        | 9/60 [04:57<23:37, 27.79s/it] 17%|#6        | 10/60 [05:39<26:41, 32.02s/it]                                               {'loss': 0.0187, 'grad_norm': 0.7789560556411743, 'learning_rate': 1.7e-05, 'num_tokens': 49966.0, 'completions/mean_length': 193.6875, 'completions/min_length': 57.8, 'completions/max_length': 385.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 189.86583251953124, 'completions/min_terminated_length': 57.8, 'completions/max_terminated_length': 366.6, 'rewards/format_reward_func/mean': 0.35, 'rewards/format_reward_func/std': 0.22698371708393097, 'rewards/correctness_reward_func/mean': 0.6, 'rewards/correctness_reward_func/std': 0.8772503733634949, 'reward': 0.95, 'reward_std': 0.6407872319221497, 'frac_reward_zero_std': 0.15, 'kl': 0.008176596253179014, 'entropy': 0.8017206326127052, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 29.861303266591857, 'epoch': 0.08}
 17%|#6        | 10/60 [05:39<26:41, 32.02s/it] 18%|#8        | 11/60 [06:19<28:16, 34.62s/it] 20%|##        | 12/60 [07:01<29:26, 36.81s/it] 22%|##1       | 13/60 [07:35<28:12, 36.02s/it] 23%|##3       | 14/60 [08:17<28:50, 37.62s/it] 25%|##5       | 15/60 [08:55<28:26, 37.92s/it]                                               {'loss': 0.0341, 'grad_norm': 0.6832303404808044, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 76692.0, 'completions/mean_length': 223.925, 'completions/min_length': 90.0, 'completions/max_length': 492.4, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 212.77250061035156, 'completions/min_terminated_length': 90.0, 'completions/max_terminated_length': 419.4, 'rewards/format_reward_func/mean': 0.29375, 'rewards/format_reward_func/std': 0.25025702714920045, 'rewards/correctness_reward_func/mean': 0.5375, 'rewards/correctness_reward_func/std': 0.7292799234390259, 'reward': 0.83125, 'reward_std': 0.7185150980949402, 'frac_reward_zero_std': 0.0, 'kl': 0.010018591722473501, 'entropy': 0.9030385196208954, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 38.705679625002084, 'epoch': 0.12}
 25%|##5       | 15/60 [08:55<28:26, 37.92s/it] 27%|##6       | 16/60 [09:17<24:08, 32.93s/it] 28%|##8       | 17/60 [09:37<21:00, 29.31s/it] 30%|###       | 18/60 [10:07<20:31, 29.31s/it] 32%|###1      | 19/60 [10:42<21:11, 31.01s/it] 33%|###3      | 20/60 [11:23<22:44, 34.12s/it]                                               {'loss': 0.0048, 'grad_norm': 0.770857572555542, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 100165.0, 'completions/mean_length': 189.5125, 'completions/min_length': 53.4, 'completions/max_length': 369.2, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 185.69666748046876, 'completions/min_terminated_length': 53.4, 'completions/max_terminated_length': 350.8, 'rewards/format_reward_func/mean': 0.325, 'rewards/format_reward_func/std': 0.237288761138916, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.8482209324836731, 'reward': 0.825, 'reward_std': 0.7324542999267578, 'frac_reward_zero_std': 0.05, 'kl': 0.01374238240532577, 'entropy': 0.822018851339817, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 29.089956666791114, 'epoch': 0.16}
 33%|###3      | 20/60 [11:23<22:44, 34.12s/it] 35%|###5      | 21/60 [12:05<23:44, 36.52s/it] 37%|###6      | 22/60 [12:30<20:53, 32.98s/it] 38%|###8      | 23/60 [13:06<20:57, 33.99s/it] 40%|####      | 24/60 [13:36<19:38, 32.74s/it] 42%|####1     | 25/60 [14:04<18:14, 31.28s/it]                                               {'loss': 0.0043, 'grad_norm': 0.5924637317657471, 'learning_rate': 1.2e-05, 'num_tokens': 125083.0, 'completions/mean_length': 202.825, 'completions/min_length': 76.0, 'completions/max_length': 391.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 202.825, 'completions/min_terminated_length': 76.0, 'completions/max_terminated_length': 391.2, 'rewards/format_reward_func/mean': 0.325, 'rewards/format_reward_func/std': 0.2415460467338562, 'rewards/correctness_reward_func/mean': 0.625, 'rewards/correctness_reward_func/std': 0.8642676115036011, 'reward': 0.95, 'reward_std': 0.7450986385345459, 'frac_reward_zero_std': 0.05, 'kl': 0.05345257231965661, 'entropy': 0.87584238499403, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 31.63825578340329, 'epoch': 0.2}
 42%|####1     | 25/60 [14:04<18:14, 31.28s/it] 43%|####3     | 26/60 [14:30<16:48, 29.67s/it] 45%|####5     | 27/60 [14:51<14:55, 27.13s/it] 47%|####6     | 28/60 [15:21<14:56, 28.01s/it] 48%|####8     | 29/60 [15:40<13:02, 25.25s/it] 50%|#####     | 30/60 [16:15<14:04, 28.15s/it]                                               {'loss': 0.0263, 'grad_norm': 0.6996539831161499, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 147560.0, 'completions/mean_length': 183.4125, 'completions/min_length': 70.2, 'completions/max_length': 325.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 183.4125, 'completions/min_terminated_length': 70.2, 'completions/max_terminated_length': 325.6, 'rewards/format_reward_func/mean': 0.425, 'rewards/format_reward_func/std': 0.17834565937519073, 'rewards/correctness_reward_func/mean': 0.8125, 'rewards/correctness_reward_func/std': 0.9175387501716614, 'reward': 1.2375, 'reward_std': 0.8218036532402039, 'frac_reward_zero_std': 0.1, 'kl': 0.017553551867604256, 'entropy': 0.6765233770012855, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 25.6664120586036, 'epoch': 0.24}
 50%|#####     | 30/60 [16:15<14:04, 28.15s/it] 52%|#####1    | 31/60 [16:45<13:54, 28.79s/it] 53%|#####3    | 32/60 [17:28<15:27, 33.11s/it] 55%|#####5    | 33/60 [17:55<14:01, 31.17s/it] 57%|#####6    | 34/60 [18:29<13:50, 31.93s/it] 58%|#####8    | 35/60 [19:12<14:41, 35.26s/it]                                               {'loss': 0.0129, 'grad_norm': 0.7317642569541931, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 174097.0, 'completions/mean_length': 221.5625, 'completions/min_length': 101.4, 'completions/max_length': 424.8, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 214.11000061035156, 'completions/min_terminated_length': 101.4, 'completions/max_terminated_length': 399.6, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.15985905528068542, 'rewards/correctness_reward_func/mean': 0.825, 'rewards/correctness_reward_func/std': 0.9326136350631714, 'reward': 1.2375, 'reward_std': 0.7552871704101562, 'frac_reward_zero_std': 0.05, 'kl': 0.02394152423366904, 'entropy': 1.026959602534771, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.81744955000759, 'epoch': 0.28}
 58%|#####8    | 35/60 [19:12<14:41, 35.26s/it] 60%|######    | 36/60 [19:40<13:14, 33.09s/it] 62%|######1   | 37/60 [20:09<12:16, 32.04s/it] 63%|######3   | 38/60 [20:41<11:38, 31.77s/it] 65%|######5   | 39/60 [21:20<11:53, 33.97s/it] 67%|######6   | 40/60 [22:05<12:30, 37.54s/it]                                               {'loss': 0.0101, 'grad_norm': 0.8270673155784607, 'learning_rate': 7e-06, 'num_tokens': 200034.0, 'completions/mean_length': 216.8625, 'completions/min_length': 72.8, 'completions/max_length': 408.2, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 208.7964294433594, 'completions/min_terminated_length': 72.8, 'completions/max_terminated_length': 381.8, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.20262537002563477, 'rewards/correctness_reward_func/mean': 0.3375, 'rewards/correctness_reward_func/std': 0.6073249340057373, 'reward': 0.73125, 'reward_std': 0.5028115242719651, 'frac_reward_zero_std': 0.15, 'kl': 0.022675933968275785, 'entropy': 1.111589615046978, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.17870888359321, 'epoch': 0.32}
 67%|######6   | 40/60 [22:06<12:30, 37.54s/it] 68%|######8   | 41/60 [22:44<11:56, 37.72s/it] 70%|#######   | 42/60 [23:24<11:32, 38.47s/it] 72%|#######1  | 43/60 [23:55<10:15, 36.19s/it] 73%|#######3  | 44/60 [24:38<10:15, 38.47s/it] 75%|#######5  | 45/60 [25:07<08:53, 35.55s/it]                                               {'loss': 0.0396, 'grad_norm': 0.5879818797111511, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 226496.0, 'completions/mean_length': 217.275, 'completions/min_length': 77.6, 'completions/max_length': 407.2, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 210.43035583496095, 'completions/min_terminated_length': 77.6, 'completions/max_terminated_length': 373.0, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.20121701657772065, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.8931827425956727, 'reward': 1.0375, 'reward_std': 0.7520676493644715, 'frac_reward_zero_std': 0.1, 'kl': 0.06784568475559354, 'entropy': 0.7817365944385528, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 35.98490329200577, 'epoch': 0.36}
 75%|#######5  | 45/60 [25:07<08:53, 35.55s/it] 77%|#######6  | 46/60 [25:31<07:26, 31.87s/it] 78%|#######8  | 47/60 [26:12<07:31, 34.73s/it] 80%|########  | 48/60 [26:58<07:36, 38.02s/it] 82%|########1 | 49/60 [27:34<06:53, 37.59s/it] 83%|########3 | 50/60 [28:02<05:46, 34.67s/it]                                               {'loss': -0.0118, 'grad_norm': 0.610445499420166, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 249926.0, 'completions/mean_length': 196.425, 'completions/min_length': 67.6, 'completions/max_length': 375.8, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 192.6, 'completions/min_terminated_length': 67.6, 'completions/max_terminated_length': 366.6, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.1936569482088089, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.8821720600128173, 'reward': 1.05, 'reward_std': 0.7084575891494751, 'frac_reward_zero_std': 0.15, 'kl': 0.020479950308799743, 'entropy': 0.8893645539879799, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.73208008319489, 'epoch': 0.4}
 83%|########3 | 50/60 [28:02<05:46, 34.67s/it] 85%|########5 | 51/60 [28:22<04:32, 30.29s/it] 87%|########6 | 52/60 [29:09<04:41, 35.17s/it] 88%|########8 | 53/60 [29:51<04:21, 37.40s/it] 90%|######### | 54/60 [30:36<03:56, 39.46s/it] 92%|#########1| 55/60 [31:17<03:20, 40.17s/it]                                               {'loss': 0.0338, 'grad_norm': 0.6144649386405945, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 275569.0, 'completions/mean_length': 217.9375, 'completions/min_length': 77.6, 'completions/max_length': 437.4, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 210.3574981689453, 'completions/min_terminated_length': 77.6, 'completions/max_terminated_length': 386.8, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.17975401282310485, 'rewards/correctness_reward_func/mean': 0.9, 'rewards/correctness_reward_func/std': 0.9077311515808105, 'reward': 1.31875, 'reward_std': 0.7616771936416626, 'frac_reward_zero_std': 0.1, 'kl': 0.02941565467044711, 'entropy': 0.8785172283649445, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 38.71502106700209, 'epoch': 0.44}
 92%|#########1| 55/60 [31:17<03:20, 40.17s/it] 93%|#########3| 56/60 [32:07<02:52, 43.06s/it] 95%|#########5| 57/60 [32:47<02:06, 42.17s/it] 97%|#########6| 58/60 [33:27<01:22, 41.32s/it] 98%|#########8| 59/60 [34:09<00:41, 41.71s/it]100%|##########| 60/60 [34:40<00:00, 38.28s/it]                                               {'loss': 0.0406, 'grad_norm': 0.6095784306526184, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 303272.0, 'completions/mean_length': 238.1875, 'completions/min_length': 106.0, 'completions/max_length': 430.6, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 231.22999877929686, 'completions/min_terminated_length': 106.0, 'completions/max_terminated_length': 392.0, 'rewards/format_reward_func/mean': 0.38125, 'rewards/format_reward_func/std': 0.20916408598423003, 'rewards/correctness_reward_func/mean': 0.4625, 'rewards/correctness_reward_func/std': 0.8016517877578735, 'reward': 0.84375, 'reward_std': 0.5554687142372131, 'frac_reward_zero_std': 0.15, 'kl': 0.01959262667223811, 'entropy': 0.884655250608921, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.86782887400186, 'epoch': 0.48}
100%|##########| 60/60 [34:40<00:00, 38.28s/it]                                               {'train_runtime': 2082.0411, 'train_samples_per_second': 0.461, 'train_steps_per_second': 0.029, 'train_loss': 0.019534906434516112, 'epoch': 0.48}
100%|##########| 60/60 [34:42<00:00, 38.28s/it]100%|##########| 60/60 [34:42<00:00, 34.70s/it]
>>> Merging Step 1 for clean sequential training...

>>> Training: m1_step2_logic
>>> Attaching new LoRA adapter to dense model...
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/peft/tuners/tuners_utils.py:282: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:19<18:54, 19.23s/it]  3%|3         | 2/60 [00:32<15:08, 15.66s/it]  5%|5         | 3/60 [00:49<15:42, 16.53s/it]  7%|6         | 4/60 [01:10<16:48, 18.01s/it]  8%|8         | 5/60 [01:28<16:44, 18.26s/it]                                              {'loss': -0.01, 'grad_norm': 1.2906681299209595, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 12822.0, 'completions/mean_length': 72.625, 'completions/min_length': 15.4, 'completions/max_length': 224.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 72.625, 'completions/min_terminated_length': 15.4, 'completions/max_terminated_length': 224.4, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.1707427144050598, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.676719355583191, 'reward': 0.94375, 'reward_std': 0.5888664126396179, 'frac_reward_zero_std': 0.1, 'kl': 0.001714388036634773, 'entropy': 1.1200769305229188, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.43877453339228, 'epoch': 0.04}
  8%|8         | 5/60 [01:28<16:44, 18.26s/it] 10%|#         | 6/60 [01:52<18:06, 20.12s/it] 12%|#1        | 7/60 [02:14<18:16, 20.69s/it] 13%|#3        | 8/60 [02:26<15:39, 18.06s/it] 15%|#5        | 9/60 [02:43<15:01, 17.68s/it] 17%|#6        | 10/60 [03:02<14:56, 17.93s/it]                                               {'loss': 0.1016, 'grad_norm': 2.166827917098999, 'learning_rate': 1.7e-05, 'num_tokens': 26363.0, 'completions/mean_length': 80.7625, 'completions/min_length': 14.6, 'completions/max_length': 237.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 80.7625, 'completions/min_terminated_length': 14.6, 'completions/max_terminated_length': 237.2, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.18750216364860534, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.7679317593574524, 'reward': 0.91875, 'reward_std': 0.607588279247284, 'frac_reward_zero_std': 0.15, 'kl': 0.005848107882775367, 'entropy': 1.0794970273971558, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 18.310046358406545, 'epoch': 0.08}
 17%|#6        | 10/60 [03:02<14:56, 17.93s/it] 18%|#8        | 11/60 [03:24<15:37, 19.13s/it] 20%|##        | 12/60 [03:35<13:30, 16.89s/it] 22%|##1       | 13/60 [04:16<18:50, 24.04s/it] 23%|##3       | 14/60 [04:34<17:03, 22.25s/it] 25%|##5       | 15/60 [04:44<13:54, 18.54s/it]                                               {'loss': 0.0128, 'grad_norm': 1.728057861328125, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 39812.0, 'completions/mean_length': 75.9125, 'completions/min_length': 12.4, 'completions/max_length': 253.8, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 70.31583404541016, 'completions/min_terminated_length': 12.4, 'completions/max_terminated_length': 182.4, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.1579040080308914, 'rewards/correctness_reward_func/mean': 0.8, 'rewards/correctness_reward_func/std': 0.8273842573165894, 'reward': 1.21875, 'reward_std': 0.6166520714759827, 'frac_reward_zero_std': 0.1, 'kl': 0.016019291384145616, 'entropy': 0.9086188361048698, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.056703500199365, 'epoch': 0.12}
 25%|##5       | 15/60 [04:44<13:54, 18.54s/it] 27%|##6       | 16/60 [05:00<13:05, 17.85s/it] 28%|##8       | 17/60 [05:15<12:11, 17.01s/it] 30%|###       | 18/60 [05:37<12:53, 18.42s/it] 32%|###1      | 19/60 [05:52<11:54, 17.43s/it] 33%|###3      | 20/60 [06:08<11:14, 16.85s/it]                                               {'loss': -0.004, 'grad_norm': 0.9137577414512634, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 53035.0, 'completions/mean_length': 66.0875, 'completions/min_length': 13.0, 'completions/max_length': 207.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 66.0875, 'completions/min_terminated_length': 13.0, 'completions/max_terminated_length': 207.0, 'rewards/format_reward_func/mean': 0.425, 'rewards/format_reward_func/std': 0.17834565937519073, 'rewards/correctness_reward_func/mean': 0.5375, 'rewards/correctness_reward_func/std': 0.8322416424751282, 'reward': 0.9625, 'reward_std': 0.582246994972229, 'frac_reward_zero_std': 0.25, 'kl': 0.02158350166864693, 'entropy': 0.8780880510807038, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 16.390210800000933, 'epoch': 0.16}
 33%|###3      | 20/60 [06:08<11:14, 16.85s/it] 35%|###5      | 21/60 [06:45<14:55, 22.95s/it] 37%|###6      | 22/60 [06:56<12:20, 19.47s/it] 38%|###8      | 23/60 [07:09<10:42, 17.38s/it] 40%|####      | 24/60 [07:27<10:39, 17.76s/it] 42%|####1     | 25/60 [07:38<09:02, 15.51s/it]                                               {'loss': -0.0248, 'grad_norm': 1.8952581882476807, 'learning_rate': 1.2e-05, 'num_tokens': 64493.0, 'completions/mean_length': 54.425, 'completions/min_length': 11.0, 'completions/max_length': 221.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 54.425, 'completions/min_terminated_length': 11.0, 'completions/max_terminated_length': 221.2, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.1336242973804474, 'rewards/correctness_reward_func/mean': 0.85, 'rewards/correctness_reward_func/std': 0.9564035415649415, 'reward': 1.3, 'reward_std': 0.8143407225608825, 'frac_reward_zero_std': 0.1, 'kl': 0.05217044670134783, 'entropy': 0.8530105367302895, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.64283304179553, 'epoch': 0.2}
 42%|####1     | 25/60 [07:38<09:02, 15.51s/it] 43%|####3     | 26/60 [07:56<09:14, 16.32s/it] 45%|####5     | 27/60 [08:14<09:19, 16.96s/it] 47%|####6     | 28/60 [08:29<08:46, 16.46s/it] 48%|####8     | 29/60 [08:42<07:52, 15.24s/it] 50%|#####     | 30/60 [08:51<06:42, 13.42s/it]                                               {'loss': 0.0362, 'grad_norm': 2.3258655071258545, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 75889.0, 'completions/mean_length': 52.5, 'completions/min_length': 12.8, 'completions/max_length': 179.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 52.5, 'completions/min_terminated_length': 12.8, 'completions/max_terminated_length': 179.8, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.12746951282024382, 'rewards/correctness_reward_func/mean': 0.8875, 'rewards/correctness_reward_func/std': 0.9599985718727112, 'reward': 1.34375, 'reward_std': 0.7950603485107421, 'frac_reward_zero_std': 0.25, 'kl': 0.07962316945195198, 'entropy': 0.7388977915048599, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.392176992201712, 'epoch': 0.24}
 50%|#####     | 30/60 [08:51<06:42, 13.42s/it] 52%|#####1    | 31/60 [09:09<07:11, 14.87s/it] 53%|#####3    | 32/60 [09:24<06:58, 14.95s/it] 55%|#####5    | 33/60 [09:35<06:11, 13.77s/it] 57%|#####6    | 34/60 [09:49<05:55, 13.67s/it] 58%|#####8    | 35/60 [10:02<05:39, 13.58s/it]                                               {'loss': -0.034, 'grad_norm': 1.1459527015686035, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 89034.0, 'completions/mean_length': 73.0125, 'completions/min_length': 15.8, 'completions/max_length': 173.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 73.0125, 'completions/min_terminated_length': 15.8, 'completions/max_terminated_length': 173.6, 'rewards/format_reward_func/mean': 0.49375, 'rewards/format_reward_func/std': 0.025, 'rewards/correctness_reward_func/mean': 0.975, 'rewards/correctness_reward_func/std': 0.9129081964492798, 'reward': 1.46875, 'reward_std': 0.7260930061340332, 'frac_reward_zero_std': 0.25, 'kl': 0.04825787260197103, 'entropy': 0.8726223677396774, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.937126808206084, 'epoch': 0.28}
 58%|#####8    | 35/60 [10:02<05:39, 13.58s/it] 60%|######    | 36/60 [10:14<05:12, 13.00s/it] 62%|######1   | 37/60 [10:20<04:10, 10.91s/it] 63%|######3   | 38/60 [10:48<05:51, 15.99s/it] 65%|######5   | 39/60 [11:05<05:44, 16.42s/it] 67%|######6   | 40/60 [11:21<05:22, 16.12s/it]                                               {'loss': 0.0437, 'grad_norm': 1.5468964576721191, 'learning_rate': 7e-06, 'num_tokens': 100610.0, 'completions/mean_length': 56.6, 'completions/min_length': 12.4, 'completions/max_length': 191.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 56.6, 'completions/min_terminated_length': 12.4, 'completions/max_terminated_length': 191.4, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.18149565458297728, 'rewards/correctness_reward_func/mean': 0.8, 'rewards/correctness_reward_func/std': 0.9063985466957092, 'reward': 1.21875, 'reward_std': 0.7141043663024902, 'frac_reward_zero_std': 0.1, 'kl': 0.09554186393506825, 'entropy': 0.8708476975560189, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 15.348971466597868, 'epoch': 0.32}
 67%|######6   | 40/60 [11:21<05:22, 16.12s/it] 68%|######8   | 41/60 [11:30<04:28, 14.12s/it] 70%|#######   | 42/60 [11:48<04:33, 15.18s/it] 72%|#######1  | 43/60 [11:57<03:48, 13.45s/it] 73%|#######3  | 44/60 [12:05<03:09, 11.83s/it] 75%|#######5  | 45/60 [12:22<03:21, 13.43s/it]                                               {'loss': 0.1131, 'grad_norm': 2.1117777824401855, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 111899.0, 'completions/mean_length': 40.3625, 'completions/min_length': 13.0, 'completions/max_length': 143.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 40.3625, 'completions/min_terminated_length': 13.0, 'completions/max_terminated_length': 143.4, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.06831300854682923, 'rewards/correctness_reward_func/mean': 0.6, 'rewards/correctness_reward_func/std': 0.9029604196548462, 'reward': 1.075, 'reward_std': 0.7177316248416901, 'frac_reward_zero_std': 0.3, 'kl': 0.09836358088068664, 'entropy': 0.8612917304039002, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.069033474399475, 'epoch': 0.36}
 75%|#######5  | 45/60 [12:22<03:21, 13.43s/it] 77%|#######6  | 46/60 [12:40<03:26, 14.72s/it] 78%|#######8  | 47/60 [12:53<03:04, 14.20s/it] 80%|########  | 48/60 [13:05<02:40, 13.41s/it] 82%|########1 | 49/60 [13:19<02:28, 13.54s/it] 83%|########3 | 50/60 [13:28<02:03, 12.35s/it]                                               {'loss': -0.0098, 'grad_norm': 1.626865267753601, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 124114.0, 'completions/mean_length': 52.2875, 'completions/min_length': 12.4, 'completions/max_length': 157.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 52.2875, 'completions/min_terminated_length': 12.4, 'completions/max_terminated_length': 157.0, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.13756606876850128, 'rewards/correctness_reward_func/mean': 0.8875, 'rewards/correctness_reward_func/std': 0.9657014966011047, 'reward': 1.35, 'reward_std': 0.753502082824707, 'frac_reward_zero_std': 0.25, 'kl': 0.12441794155165553, 'entropy': 0.8007332861423493, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.855752442401718, 'epoch': 0.4}
 83%|########3 | 50/60 [13:28<02:03, 12.35s/it] 85%|########5 | 51/60 [13:43<01:58, 13.17s/it] 87%|########6 | 52/60 [13:54<01:39, 12.43s/it] 88%|########8 | 53/60 [14:04<01:21, 11.70s/it] 90%|######### | 54/60 [14:14<01:07, 11.17s/it] 92%|#########1| 55/60 [14:27<00:58, 11.72s/it]                                               {'loss': -0.0623, 'grad_norm': 2.126136541366577, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 133810.0, 'completions/mean_length': 33.3, 'completions/min_length': 13.2, 'completions/max_length': 136.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 33.3, 'completions/min_terminated_length': 13.2, 'completions/max_terminated_length': 136.2, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.8, 'rewards/correctness_reward_func/std': 0.9027939796447754, 'reward': 1.275, 'reward_std': 0.6910995244979858, 'frac_reward_zero_std': 0.3, 'kl': 0.14088699603453278, 'entropy': 0.7187868803739548, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 11.478308291806025, 'epoch': 0.44}
 92%|#########1| 55/60 [14:27<00:58, 11.72s/it] 93%|#########3| 56/60 [14:37<00:45, 11.34s/it] 95%|#########5| 57/60 [14:48<00:33, 11.29s/it] 97%|#########6| 58/60 [15:00<00:22, 11.45s/it] 98%|#########8| 59/60 [15:15<00:12, 12.44s/it]100%|##########| 60/60 [15:31<00:00, 13.65s/it]                                               {'loss': 0.0552, 'grad_norm': 2.3793749809265137, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 144666.0, 'completions/mean_length': 40.1, 'completions/min_length': 13.2, 'completions/max_length': 151.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 40.1, 'completions/min_terminated_length': 13.2, 'completions/max_terminated_length': 151.8, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.06531128883361817, 'rewards/correctness_reward_func/mean': 0.85, 'rewards/correctness_reward_func/std': 0.9578243136405945, 'reward': 1.325, 'reward_std': 0.6993484973907471, 'frac_reward_zero_std': 0.3, 'kl': 0.1287564005702734, 'entropy': 0.7213471010327339, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.64760560799623, 'epoch': 0.48}
100%|##########| 60/60 [15:31<00:00, 13.65s/it]                                               {'train_runtime': 932.6271, 'train_samples_per_second': 1.029, 'train_steps_per_second': 0.064, 'train_loss': 0.01814021117364367, 'epoch': 0.48}
100%|##########| 60/60 [15:32<00:00, 13.65s/it]100%|##########| 60/60 [15:32<00:00, 15.54s/it]
Accuracy on Task A (Math): 20.00%
Accuracy on Task B (Logic): 68.00%
>>> Method 1: Baseline COMPLETED SUCCESSFULLY.

====================
STARTING Method 2: Replay
====================

=== METHOD 2: EXPERIENCE REPLAY ===

>>> Training: m2_step1_math
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:41<40:39, 41.35s/it]  3%|3         | 2/60 [01:23<40:32, 41.93s/it]  5%|5         | 3/60 [01:50<33:14, 35.00s/it]  7%|6         | 4/60 [02:09<26:44, 28.65s/it]  8%|8         | 5/60 [02:43<27:55, 30.45s/it]                                              {'loss': 0.0125, 'grad_norm': 0.7205731272697449, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 27006.0, 'completions/mean_length': 227.325, 'completions/min_length': 76.4, 'completions/max_length': 404.2, 'completions/clipped_ratio': 0.0625, 'completions/mean_terminated_length': 209.65412292480468, 'completions/min_terminated_length': 76.4, 'completions/max_terminated_length': 348.0, 'rewards/format_reward_func/mean': 0.15625, 'rewards/format_reward_func/std': 0.23413876593112945, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.7907753109931945, 'reward': 0.79375, 'reward_std': 0.5950500965118408, 'frac_reward_zero_std': 0.1, 'kl': 0.001778986069257371, 'entropy': 0.8802082255482674, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 32.0688705670007, 'epoch': 0.04}
  8%|8         | 5/60 [02:43<27:55, 30.45s/it] 10%|#         | 6/60 [03:19<29:10, 32.42s/it] 12%|#1        | 7/60 [03:48<27:35, 31.24s/it] 13%|#3        | 8/60 [04:17<26:30, 30.58s/it] 15%|#5        | 9/60 [04:43<24:44, 29.12s/it] 17%|#6        | 10/60 [05:09<23:32, 28.25s/it]                                               {'loss': 0.0038, 'grad_norm': 0.7360445261001587, 'learning_rate': 1.7e-05, 'num_tokens': 51696.0, 'completions/mean_length': 206.025, 'completions/min_length': 75.6, 'completions/max_length': 375.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 206.025, 'completions/min_terminated_length': 75.6, 'completions/max_terminated_length': 375.4, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.25238566994667055, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.8169429302215576, 'reward': 0.7375, 'reward_std': 0.7079315304756164, 'frac_reward_zero_std': 0.0, 'kl': 0.004561235883738845, 'entropy': 0.6777708187699318, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.74185132540297, 'epoch': 0.08}
 17%|#6        | 10/60 [05:09<23:32, 28.25s/it] 18%|#8        | 11/60 [05:47<25:24, 31.11s/it] 20%|##        | 12/60 [06:31<28:06, 35.14s/it] 22%|##1       | 13/60 [07:01<26:20, 33.62s/it] 23%|##3       | 14/60 [07:41<27:18, 35.62s/it] 25%|##5       | 15/60 [08:14<26:06, 34.80s/it]                                               {'loss': 0.0355, 'grad_norm': 0.5045266151428223, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 80011.0, 'completions/mean_length': 243.7875, 'completions/min_length': 88.0, 'completions/max_length': 446.4, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 238.125, 'completions/min_terminated_length': 88.0, 'completions/max_terminated_length': 439.0, 'rewards/format_reward_func/mean': 0.275, 'rewards/format_reward_func/std': 0.25074589252471924, 'rewards/correctness_reward_func/mean': 0.4375, 'rewards/correctness_reward_func/std': 0.7332215189933777, 'reward': 0.7125, 'reward_std': 0.5979347169399262, 'frac_reward_zero_std': 0.15, 'kl': 0.009054907143581658, 'entropy': 1.0140393495559692, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.499399433183136, 'epoch': 0.12}
 25%|##5       | 15/60 [08:14<26:06, 34.80s/it] 27%|##6       | 16/60 [08:56<27:03, 36.89s/it] 28%|##8       | 17/60 [09:37<27:20, 38.15s/it] 30%|###       | 18/60 [10:19<27:27, 39.22s/it] 32%|###1      | 19/60 [10:45<24:08, 35.34s/it] 33%|###3      | 20/60 [11:26<24:38, 36.97s/it]                                               {'loss': 0.042, 'grad_norm': 0.7339351773262024, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 107151.0, 'completions/mean_length': 235.35, 'completions/min_length': 84.8, 'completions/max_length': 470.8, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 224.09750061035157, 'completions/min_terminated_length': 84.8, 'completions/max_terminated_length': 384.4, 'rewards/format_reward_func/mean': 0.30625, 'rewards/format_reward_func/std': 0.2389538586139679, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.8748960256576538, 'reward': 0.95625, 'reward_std': 0.6929036378860474, 'frac_reward_zero_std': 0.05, 'kl': 0.013404644047841429, 'entropy': 0.872581185400486, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 37.753399633796654, 'epoch': 0.16}
 33%|###3      | 20/60 [11:26<24:38, 36.97s/it] 35%|###5      | 21/60 [12:00<23:24, 36.01s/it] 37%|###6      | 22/60 [12:23<20:30, 32.38s/it] 38%|###8      | 23/60 [12:51<18:59, 30.81s/it] 40%|####      | 24/60 [13:23<18:50, 31.40s/it] 42%|####1     | 25/60 [13:50<17:28, 29.96s/it]                                               {'loss': -0.0361, 'grad_norm': 0.6781320571899414, 'learning_rate': 1.2e-05, 'num_tokens': 133521.0, 'completions/mean_length': 220.975, 'completions/min_length': 113.0, 'completions/max_length': 348.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 220.975, 'completions/min_terminated_length': 113.0, 'completions/max_terminated_length': 348.4, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.2073718011379242, 'rewards/correctness_reward_func/mean': 0.775, 'rewards/correctness_reward_func/std': 0.9489079475402832, 'reward': 1.16875, 'reward_std': 0.8403115510940552, 'frac_reward_zero_std': 0.1, 'kl': 0.01769334776327014, 'entropy': 0.7995841801166534, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.337639534202754, 'epoch': 0.2}
 42%|####1     | 25/60 [13:50<17:28, 29.96s/it] 43%|####3     | 26/60 [14:24<17:41, 31.21s/it] 45%|####5     | 27/60 [15:00<17:56, 32.61s/it] 47%|####6     | 28/60 [15:31<17:11, 32.22s/it] 48%|####8     | 29/60 [15:57<15:42, 30.41s/it] 50%|#####     | 30/60 [16:28<15:15, 30.51s/it]                                               {'loss': 0.0259, 'grad_norm': 0.6396528482437134, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 158491.0, 'completions/mean_length': 214.575, 'completions/min_length': 89.2, 'completions/max_length': 392.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 214.575, 'completions/min_terminated_length': 89.2, 'completions/max_terminated_length': 392.8, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.20262537002563477, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.926913321018219, 'reward': 1.25625, 'reward_std': 0.8410307705402374, 'frac_reward_zero_std': 0.05, 'kl': 0.017241076100617647, 'entropy': 0.7573109328746795, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 31.100565108004957, 'epoch': 0.24}
 50%|#####     | 30/60 [16:28<15:15, 30.51s/it] 52%|#####1    | 31/60 [17:12<16:37, 34.40s/it] 53%|#####3    | 32/60 [17:54<17:08, 36.75s/it] 55%|#####5    | 33/60 [18:36<17:18, 38.46s/it] 57%|#####6    | 34/60 [19:20<17:17, 39.90s/it] 58%|#####8    | 35/60 [20:02<16:55, 40.61s/it]                                               {'loss': 0.0829, 'grad_norm': 0.6629019379615784, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 188300.0, 'completions/mean_length': 262.4625, 'completions/min_length': 91.8, 'completions/max_length': 512.0, 'completions/clipped_ratio': 0.1125, 'completions/mean_terminated_length': 232.40809936523436, 'completions/min_terminated_length': 91.8, 'completions/max_terminated_length': 428.6, 'rewards/format_reward_func/mean': 0.35625, 'rewards/format_reward_func/std': 0.23077536523342132, 'rewards/correctness_reward_func/mean': 0.725, 'rewards/correctness_reward_func/std': 0.911711573600769, 'reward': 1.08125, 'reward_std': 0.7194646954536438, 'frac_reward_zero_std': 0.1, 'kl': 0.020241344207897784, 'entropy': 1.067509551346302, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 42.11889020000526, 'epoch': 0.28}
 58%|#####8    | 35/60 [20:02<16:55, 40.61s/it] 60%|######    | 36/60 [20:39<15:52, 39.67s/it] 62%|######1   | 37/60 [21:23<15:40, 40.90s/it] 63%|######3   | 38/60 [22:05<15:08, 41.30s/it] 65%|######5   | 39/60 [22:41<13:52, 39.65s/it] 67%|######6   | 40/60 [23:27<13:47, 41.37s/it]                                               {'loss': 0.0611, 'grad_norm': 0.6721694469451904, 'learning_rate': 7e-06, 'num_tokens': 218293.0, 'completions/mean_length': 267.5625, 'completions/min_length': 93.2, 'completions/max_length': 484.4, 'completions/clipped_ratio': 0.05, 'completions/mean_terminated_length': 256.40607299804685, 'completions/min_terminated_length': 93.2, 'completions/max_terminated_length': 464.6, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.19680694341659546, 'rewards/correctness_reward_func/mean': 0.3625, 'rewards/correctness_reward_func/std': 0.6613142728805542, 'reward': 0.76875, 'reward_std': 0.6043181002140046, 'frac_reward_zero_std': 0.2, 'kl': 0.02213592892512679, 'entropy': 1.2195569545030593, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 40.33274265840591, 'epoch': 0.32}
 67%|######6   | 40/60 [23:27<13:47, 41.37s/it] 68%|######8   | 41/60 [24:08<13:08, 41.52s/it] 70%|#######   | 42/60 [24:50<12:25, 41.43s/it] 72%|#######1  | 43/60 [25:22<10:58, 38.75s/it] 73%|#######3  | 44/60 [26:04<10:34, 39.67s/it] 75%|#######5  | 45/60 [26:42<09:45, 39.03s/it]                                               {'loss': 0.0069, 'grad_norm': 0.6349403262138367, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 247370.0, 'completions/mean_length': 249.9625, 'completions/min_length': 115.6, 'completions/max_length': 468.0, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 243.33499755859376, 'completions/min_terminated_length': 115.6, 'completions/max_terminated_length': 427.4, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.15246951282024385, 'rewards/correctness_reward_func/mean': 0.6875, 'rewards/correctness_reward_func/std': 0.8672120094299316, 'reward': 1.1375, 'reward_std': 0.7290844857692719, 'frac_reward_zero_std': 0.15, 'kl': 0.03091249456629157, 'entropy': 0.8035079091787338, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 38.39116426739493, 'epoch': 0.36}
 75%|#######5  | 45/60 [26:42<09:45, 39.03s/it] 77%|#######6  | 46/60 [27:14<08:37, 36.97s/it] 78%|#######8  | 47/60 [27:55<08:19, 38.42s/it] 80%|########  | 48/60 [28:42<08:08, 40.72s/it] 82%|########1 | 49/60 [29:09<06:45, 36.85s/it] 83%|########3 | 50/60 [29:40<05:48, 34.83s/it]                                               {'loss': 0.0071, 'grad_norm': 0.6130396127700806, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 272406.0, 'completions/mean_length': 216.5, 'completions/min_length': 96.2, 'completions/max_length': 399.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 213.13250122070312, 'completions/min_terminated_length': 96.2, 'completions/max_terminated_length': 380.0, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.10562257766723633, 'rewards/correctness_reward_func/mean': 0.75, 'rewards/correctness_reward_func/std': 0.9016423702239991, 'reward': 1.20625, 'reward_std': 0.7817476630210877, 'frac_reward_zero_std': 0.1, 'kl': 0.02762110368348658, 'entropy': 0.8818802192807198, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 35.24428820839967, 'epoch': 0.4}
 83%|########3 | 50/60 [29:40<05:48, 34.83s/it] 85%|########5 | 51/60 [30:24<05:39, 37.68s/it] 87%|########6 | 52/60 [31:13<05:29, 41.24s/it] 88%|########8 | 53/60 [31:53<04:45, 40.82s/it] 90%|######### | 54/60 [32:36<04:09, 41.51s/it] 92%|#########1| 55/60 [33:11<03:17, 39.59s/it]                                               {'loss': 0.0522, 'grad_norm': 0.5736122727394104, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 299944.0, 'completions/mean_length': 241.625, 'completions/min_length': 116.8, 'completions/max_length': 471.0, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 230.31749877929687, 'completions/min_terminated_length': 116.8, 'completions/max_terminated_length': 423.2, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.18891051709651946, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.9283154964447021, 'reward': 1.275, 'reward_std': 0.7355756759643555, 'frac_reward_zero_std': 0.1, 'kl': 0.02801445033401251, 'entropy': 0.8554733961820602, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 41.80099104959809, 'epoch': 0.44}
 92%|#########1| 55/60 [33:12<03:17, 39.59s/it] 93%|#########3| 56/60 [33:57<02:45, 41.36s/it] 95%|#########5| 57/60 [34:34<02:00, 40.20s/it] 97%|#########6| 58/60 [35:10<01:17, 38.76s/it] 98%|#########8| 59/60 [35:54<00:40, 40.40s/it]100%|##########| 60/60 [36:35<00:00, 40.48s/it]                                               {'loss': -0.0301, 'grad_norm': 0.48767897486686707, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 328233.0, 'completions/mean_length': 245.5125, 'completions/min_length': 118.4, 'completions/max_length': 442.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 245.5125, 'completions/min_terminated_length': 118.4, 'completions/max_terminated_length': 442.4, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.1433130085468292, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.9061808824539185, 'reward': 1.16875, 'reward_std': 0.5530204951763154, 'frac_reward_zero_std': 0.25, 'kl': 0.0294767202809453, 'entropy': 0.8587960407137871, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 40.075037292196065, 'epoch': 0.48}
100%|##########| 60/60 [36:35<00:00, 40.48s/it]                                               {'train_runtime': 2196.117, 'train_samples_per_second': 0.437, 'train_steps_per_second': 0.027, 'train_loss': 0.021983899424473444, 'epoch': 0.48}
100%|##########| 60/60 [36:36<00:00, 40.48s/it]100%|##########| 60/60 [36:36<00:00, 36.60s/it]
>>> Merging Step 1...

>>> Training: m2_step2_mixed
>>> Attaching new LoRA adapter to dense model...
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/peft/tuners/tuners_utils.py:282: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:27<27:11, 27.65s/it]  3%|3         | 2/60 [00:44<20:39, 21.38s/it]  5%|5         | 3/60 [01:06<20:38, 21.72s/it]  7%|6         | 4/60 [01:23<18:19, 19.64s/it]  8%|8         | 5/60 [01:37<16:23, 17.88s/it]                                              {'loss': 0.1272, 'grad_norm': 0.9369527101516724, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 14412.0, 'completions/mean_length': 90.0, 'completions/min_length': 15.2, 'completions/max_length': 251.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 90.0, 'completions/min_terminated_length': 15.2, 'completions/max_terminated_length': 251.2, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.1235992282629013, 'rewards/correctness_reward_func/mean': 0.7875, 'rewards/correctness_reward_func/std': 0.7994954824447632, 'reward': 1.225, 'reward_std': 0.5555637061595917, 'frac_reward_zero_std': 0.15, 'kl': 0.003710751299513504, 'entropy': 0.9723415985703469, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.225092841210426, 'epoch': 0.03}
  8%|8         | 5/60 [01:37<16:23, 17.88s/it] 10%|#         | 6/60 [02:18<23:00, 25.56s/it] 12%|#1        | 7/60 [02:37<20:36, 23.33s/it] 13%|#3        | 8/60 [02:57<19:26, 22.44s/it] 15%|#5        | 9/60 [03:38<23:55, 28.15s/it] 17%|#6        | 10/60 [04:04<22:48, 27.37s/it]                                               {'loss': 0.1379, 'grad_norm': 0.7860879898071289, 'learning_rate': 1.7e-05, 'num_tokens': 33018.0, 'completions/mean_length': 131.625, 'completions/min_length': 16.0, 'completions/max_length': 373.2, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 122.00916748046875, 'completions/min_terminated_length': 16.0, 'completions/max_terminated_length': 306.4, 'rewards/format_reward_func/mean': 0.425, 'rewards/format_reward_func/std': 0.17534393966197967, 'rewards/correctness_reward_func/mean': 0.45, 'rewards/correctness_reward_func/std': 0.7273085951805115, 'reward': 0.875, 'reward_std': 0.55694100856781, 'frac_reward_zero_std': 0.2, 'kl': 0.014127401635050774, 'entropy': 1.0568429857492447, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.72640252459387, 'epoch': 0.06}
 17%|#6        | 10/60 [04:04<22:48, 27.37s/it] 18%|#8        | 11/60 [04:30<22:07, 27.09s/it] 20%|##        | 12/60 [04:39<17:15, 21.58s/it] 22%|##1       | 13/60 [05:12<19:43, 25.19s/it] 23%|##3       | 14/60 [05:31<17:46, 23.19s/it] 25%|##5       | 15/60 [06:01<18:48, 25.09s/it]                                               {'loss': 0.0829, 'grad_norm': 1.2008602619171143, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 47291.0, 'completions/mean_length': 78.0625, 'completions/min_length': 16.0, 'completions/max_length': 297.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 78.0625, 'completions/min_terminated_length': 16.0, 'completions/max_terminated_length': 297.8, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.17989921867847442, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.851622200012207, 'reward': 1.0625, 'reward_std': 0.7379184007644654, 'frac_reward_zero_std': 0.15, 'kl': 0.07251938616391271, 'entropy': 0.9957629323005677, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.97796969979536, 'epoch': 0.1}
 25%|##5       | 15/60 [06:01<18:48, 25.09s/it] 27%|##6       | 16/60 [06:22<17:36, 24.00s/it] 28%|##8       | 17/60 [06:49<17:48, 24.84s/it] 30%|###       | 18/60 [07:09<16:23, 23.42s/it] 32%|###1      | 19/60 [07:30<15:31, 22.71s/it] 33%|###3      | 20/60 [07:39<12:28, 18.71s/it]                                               {'loss': -0.1372, 'grad_norm': 2.330035448074341, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 61610.0, 'completions/mean_length': 80.4875, 'completions/min_length': 12.2, 'completions/max_length': 250.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 80.4875, 'completions/min_terminated_length': 12.2, 'completions/max_terminated_length': 250.0, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.11759271919727325, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.7935500144958496, 'reward': 1.075, 'reward_std': 0.6286898851394653, 'frac_reward_zero_std': 0.25, 'kl': 0.08992162700742483, 'entropy': 0.8251440808176994, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.38364815841196, 'epoch': 0.13}
 33%|###3      | 20/60 [07:39<12:28, 18.71s/it] 35%|###5      | 21/60 [08:04<13:23, 20.60s/it] 37%|###6      | 22/60 [08:22<12:28, 19.69s/it] 38%|###8      | 23/60 [08:41<11:59, 19.44s/it] 40%|####      | 24/60 [09:02<12:00, 20.02s/it] 42%|####1     | 25/60 [09:21<11:27, 19.65s/it]                                               {'loss': 0.0065, 'grad_norm': 1.1598851680755615, 'learning_rate': 1.2e-05, 'num_tokens': 75974.0, 'completions/mean_length': 81.05, 'completions/min_length': 14.4, 'completions/max_length': 258.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 81.05, 'completions/min_terminated_length': 14.4, 'completions/max_terminated_length': 258.6, 'rewards/format_reward_func/mean': 0.46875, 'rewards/format_reward_func/std': 0.10915650427341461, 'rewards/correctness_reward_func/mean': 1.2, 'rewards/correctness_reward_func/std': 0.9206164002418518, 'reward': 1.66875, 'reward_std': 0.7636429965496063, 'frac_reward_zero_std': 0.25, 'kl': 0.08680677562952041, 'entropy': 0.727880010008812, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.925534358402366, 'epoch': 0.16}
 42%|####1     | 25/60 [09:21<11:27, 19.65s/it] 43%|####3     | 26/60 [09:39<10:55, 19.26s/it] 45%|####5     | 27/60 [09:54<09:47, 17.80s/it] 47%|####6     | 28/60 [10:27<11:53, 22.30s/it] 48%|####8     | 29/60 [10:51<11:47, 22.81s/it] 50%|#####     | 30/60 [11:07<10:23, 20.78s/it]                                               {'loss': 0.0179, 'grad_norm': 1.393345594406128, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 90297.0, 'completions/mean_length': 84.6375, 'completions/min_length': 13.8, 'completions/max_length': 264.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 84.6375, 'completions/min_terminated_length': 13.8, 'completions/max_terminated_length': 264.6, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 1.3125, 'rewards/correctness_reward_func/std': 0.93850337266922, 'reward': 1.7875, 'reward_std': 0.8608069241046905, 'frac_reward_zero_std': 0.2, 'kl': 0.055106125120073554, 'entropy': 0.8289916440844536, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.720423741609558, 'epoch': 0.19}
 50%|#####     | 30/60 [11:07<10:23, 20.78s/it] 52%|#####1    | 31/60 [11:25<09:46, 20.21s/it] 53%|#####3    | 32/60 [11:35<07:53, 16.89s/it] 55%|#####5    | 33/60 [12:00<08:42, 19.35s/it] 57%|#####6    | 34/60 [12:14<07:41, 17.75s/it] 58%|#####8    | 35/60 [12:47<09:20, 22.44s/it]                                               {'loss': 0.1199, 'grad_norm': 1.426271915435791, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 103145.0, 'completions/mean_length': 65.9, 'completions/min_length': 14.2, 'completions/max_length': 253.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 65.9, 'completions/min_terminated_length': 14.2, 'completions/max_terminated_length': 253.0, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.11831300854682922, 'rewards/correctness_reward_func/mean': 0.8375, 'rewards/correctness_reward_func/std': 0.9740092635154725, 'reward': 1.3, 'reward_std': 0.8258682131767273, 'frac_reward_zero_std': 0.15, 'kl': 0.07264240081422031, 'entropy': 0.9433250337839126, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.732665058798737, 'epoch': 0.22}
 58%|#####8    | 35/60 [12:47<09:20, 22.44s/it] 60%|######    | 36/60 [13:03<08:12, 20.51s/it] 62%|######1   | 37/60 [13:16<06:56, 18.12s/it] 63%|######3   | 38/60 [13:46<08:01, 21.87s/it] 65%|######5   | 39/60 [14:00<06:50, 19.55s/it] 67%|######6   | 40/60 [14:16<06:08, 18.40s/it]                                               {'loss': -0.0068, 'grad_norm': 0.9505512118339539, 'learning_rate': 7e-06, 'num_tokens': 116643.0, 'completions/mean_length': 69.975, 'completions/min_length': 14.6, 'completions/max_length': 218.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 69.975, 'completions/min_terminated_length': 14.6, 'completions/max_terminated_length': 218.4, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.09946779310703277, 'rewards/correctness_reward_func/mean': 0.9125, 'rewards/correctness_reward_func/std': 0.962653398513794, 'reward': 1.375, 'reward_std': 0.6232050776481628, 'frac_reward_zero_std': 0.3, 'kl': 0.059775182884186505, 'entropy': 1.097187988460064, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.465907949596293, 'epoch': 0.26}
 67%|######6   | 40/60 [14:16<06:08, 18.40s/it] 68%|######8   | 41/60 [14:33<05:42, 18.02s/it] 70%|#######   | 42/60 [14:52<05:26, 18.11s/it] 72%|#######1  | 43/60 [15:32<07:03, 24.90s/it] 73%|#######3  | 44/60 [15:57<06:35, 24.74s/it] 75%|#######5  | 45/60 [16:30<06:49, 27.29s/it]                                               {'loss': 0.0734, 'grad_norm': 0.31122294068336487, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 134352.0, 'completions/mean_length': 122.7125, 'completions/min_length': 15.2, 'completions/max_length': 336.8, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 117.45416717529297, 'completions/min_terminated_length': 15.2, 'completions/max_terminated_length': 291.2, 'rewards/format_reward_func/mean': 0.49375, 'rewards/format_reward_func/std': 0.025, 'rewards/correctness_reward_func/mean': 0.9, 'rewards/correctness_reward_func/std': 0.9692806124687194, 'reward': 1.39375, 'reward_std': 0.5178214907646179, 'frac_reward_zero_std': 0.5, 'kl': 0.029439267283305526, 'entropy': 0.8797615468502045, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 26.306221024799743, 'epoch': 0.29}
 75%|#######5  | 45/60 [16:30<06:49, 27.29s/it] 77%|#######6  | 46/60 [16:46<05:34, 23.89s/it] 78%|#######8  | 47/60 [17:01<04:37, 21.35s/it] 80%|########  | 48/60 [17:21<04:11, 20.92s/it] 82%|########1 | 49/60 [17:30<03:10, 17.36s/it] 83%|########3 | 50/60 [17:44<02:41, 16.18s/it]                                               {'loss': 0.1122, 'grad_norm': 1.2601255178451538, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 146940.0, 'completions/mean_length': 62.1, 'completions/min_length': 15.8, 'completions/max_length': 175.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 62.1, 'completions/min_terminated_length': 15.8, 'completions/max_terminated_length': 175.8, 'rewards/format_reward_func/mean': 0.5, 'rewards/format_reward_func/std': 0.0, 'rewards/correctness_reward_func/mean': 0.9125, 'rewards/correctness_reward_func/std': 0.9093323945999146, 'reward': 1.4125, 'reward_std': 0.6059401035308838, 'frac_reward_zero_std': 0.4, 'kl': 0.0710981735959649, 'entropy': 0.9206103727221489, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.44320628280111, 'epoch': 0.32}
 83%|########3 | 50/60 [17:44<02:41, 16.18s/it] 85%|########5 | 51/60 [18:02<02:32, 16.93s/it] 87%|########6 | 52/60 [18:34<02:50, 21.26s/it] 88%|########8 | 53/60 [19:02<02:43, 23.30s/it] 90%|######### | 54/60 [19:11<01:55, 19.18s/it] 92%|#########1| 55/60 [19:36<01:43, 20.76s/it]                                               {'loss': 0.1214, 'grad_norm': 0.937086284160614, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 161139.0, 'completions/mean_length': 87.3875, 'completions/min_length': 15.4, 'completions/max_length': 282.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 87.3875, 'completions/min_terminated_length': 15.4, 'completions/max_terminated_length': 282.8, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.8175734162330628, 'reward': 1.3375, 'reward_std': 0.6122490644454956, 'frac_reward_zero_std': 0.3, 'kl': 0.06162597085349262, 'entropy': 0.9658680394291878, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.025260099800654, 'epoch': 0.35}
 92%|#########1| 55/60 [19:36<01:43, 20.76s/it] 93%|#########3| 56/60 [19:45<01:09, 17.30s/it] 95%|#########5| 57/60 [19:55<00:44, 14.96s/it] 97%|#########6| 58/60 [20:20<00:36, 18.16s/it] 98%|#########8| 59/60 [20:41<00:19, 19.11s/it]100%|##########| 60/60 [21:08<00:00, 21.39s/it]                                               {'loss': -0.0348, 'grad_norm': 1.1321344375610352, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 176062.0, 'completions/mean_length': 88.5375, 'completions/min_length': 25.4, 'completions/max_length': 227.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 88.5375, 'completions/min_terminated_length': 25.4, 'completions/max_terminated_length': 227.4, 'rewards/format_reward_func/mean': 0.48125, 'rewards/format_reward_func/std': 0.075, 'rewards/correctness_reward_func/mean': 0.8, 'rewards/correctness_reward_func/std': 0.970750880241394, 'reward': 1.28125, 'reward_std': 0.6067829966545105, 'frac_reward_zero_std': 0.35, 'kl': 0.07110716614406556, 'entropy': 0.8320047616958618, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 18.101245200200356, 'epoch': 0.38}
100%|##########| 60/60 [21:08<00:00, 21.39s/it]                                               {'train_runtime': 1269.357, 'train_samples_per_second': 0.756, 'train_steps_per_second': 0.047, 'train_loss': 0.05171126748124758, 'epoch': 0.38}
100%|##########| 60/60 [21:09<00:00, 21.39s/it]100%|##########| 60/60 [21:09<00:00, 21.16s/it]
Accuracy on Task A (Math): 26.00%
Accuracy on Task B (Logic): 76.00%
>>> Method 2: Replay COMPLETED SUCCESSFULLY.

====================
STARTING Method 3: Task Arithmetic
====================

=== METHOD 3: TASK ARITHMETIC (MERGING) ===

>>> Training: m3_indep_math
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:41<40:55, 41.61s/it]  3%|3         | 2/60 [01:24<40:41, 42.10s/it]  5%|5         | 3/60 [01:50<33:22, 35.13s/it]  7%|6         | 4/60 [02:09<26:43, 28.63s/it]  8%|8         | 5/60 [02:42<27:48, 30.34s/it]                                              {'loss': 0.0125, 'grad_norm': 0.7205731272697449, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 27006.0, 'completions/mean_length': 227.325, 'completions/min_length': 76.4, 'completions/max_length': 404.2, 'completions/clipped_ratio': 0.0625, 'completions/mean_terminated_length': 209.65412292480468, 'completions/min_terminated_length': 76.4, 'completions/max_terminated_length': 348.0, 'rewards/format_reward_func/mean': 0.15625, 'rewards/format_reward_func/std': 0.23413876593112945, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.7907753109931945, 'reward': 0.79375, 'reward_std': 0.5950500965118408, 'frac_reward_zero_std': 0.1, 'kl': 0.001778986069257371, 'entropy': 0.8802082255482674, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 32.05043531619886, 'epoch': 0.04}
  8%|8         | 5/60 [02:42<27:48, 30.34s/it] 10%|#         | 6/60 [03:18<28:59, 32.22s/it] 12%|#1        | 7/60 [03:47<27:23, 31.01s/it] 13%|#3        | 8/60 [04:16<26:17, 30.33s/it] 15%|#5        | 9/60 [04:41<24:27, 28.78s/it] 17%|#6        | 10/60 [05:07<23:16, 27.94s/it]                                               {'loss': 0.0038, 'grad_norm': 0.7360445261001587, 'learning_rate': 1.7e-05, 'num_tokens': 51696.0, 'completions/mean_length': 206.025, 'completions/min_length': 75.6, 'completions/max_length': 375.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 206.025, 'completions/min_terminated_length': 75.6, 'completions/max_terminated_length': 375.4, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.25238566994667055, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.8169429302215576, 'reward': 0.7375, 'reward_std': 0.7079315304756164, 'frac_reward_zero_std': 0.0, 'kl': 0.004561235883738845, 'entropy': 0.6777708187699318, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.406859050199273, 'epoch': 0.08}
 17%|#6        | 10/60 [05:07<23:16, 27.94s/it] 18%|#8        | 11/60 [05:43<24:54, 30.50s/it] 20%|##        | 12/60 [06:26<27:25, 34.29s/it] 22%|##1       | 13/60 [06:56<25:39, 32.75s/it] 23%|##3       | 14/60 [07:34<26:31, 34.60s/it] 25%|##5       | 15/60 [08:06<25:20, 33.79s/it]                                               {'loss': 0.0355, 'grad_norm': 0.5045266151428223, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 80011.0, 'completions/mean_length': 243.7875, 'completions/min_length': 88.0, 'completions/max_length': 446.4, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 238.125, 'completions/min_terminated_length': 88.0, 'completions/max_terminated_length': 439.0, 'rewards/format_reward_func/mean': 0.275, 'rewards/format_reward_func/std': 0.25074589252471924, 'rewards/correctness_reward_func/mean': 0.4375, 'rewards/correctness_reward_func/std': 0.7332215189933777, 'reward': 0.7125, 'reward_std': 0.5979347169399262, 'frac_reward_zero_std': 0.15, 'kl': 0.009054907143581658, 'entropy': 1.0140393495559692, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 35.30313293338695, 'epoch': 0.12}
 25%|##5       | 15/60 [08:06<25:20, 33.79s/it] 27%|##6       | 16/60 [08:48<26:29, 36.12s/it] 28%|##8       | 17/60 [09:29<26:53, 37.53s/it] 30%|###       | 18/60 [10:10<27:01, 38.60s/it] 32%|###1      | 19/60 [10:37<24:01, 35.15s/it] 33%|###3      | 20/60 [11:17<24:24, 36.61s/it]                                               {'loss': 0.042, 'grad_norm': 0.7339351773262024, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 107151.0, 'completions/mean_length': 235.35, 'completions/min_length': 84.8, 'completions/max_length': 470.8, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 224.09750061035157, 'completions/min_terminated_length': 84.8, 'completions/max_terminated_length': 384.4, 'rewards/format_reward_func/mean': 0.30625, 'rewards/format_reward_func/std': 0.2389538586139679, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.8748960256576538, 'reward': 0.95625, 'reward_std': 0.6929036378860474, 'frac_reward_zero_std': 0.05, 'kl': 0.013404644047841429, 'entropy': 0.872581185400486, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 37.54774460819608, 'epoch': 0.16}
 33%|###3      | 20/60 [11:17<24:24, 36.61s/it] 35%|###5      | 21/60 [11:50<23:08, 35.61s/it] 37%|###6      | 22/60 [12:14<20:20, 32.13s/it] 38%|###8      | 23/60 [12:42<18:58, 30.76s/it] 40%|####      | 24/60 [13:14<18:47, 31.31s/it] 42%|####1     | 25/60 [13:41<17:24, 29.85s/it]                                               {'loss': -0.0361, 'grad_norm': 0.6781320571899414, 'learning_rate': 1.2e-05, 'num_tokens': 133521.0, 'completions/mean_length': 220.975, 'completions/min_length': 113.0, 'completions/max_length': 348.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 220.975, 'completions/min_terminated_length': 113.0, 'completions/max_terminated_length': 348.4, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.2073718011379242, 'rewards/correctness_reward_func/mean': 0.775, 'rewards/correctness_reward_func/std': 0.9489079475402832, 'reward': 1.16875, 'reward_std': 0.8403115510940552, 'frac_reward_zero_std': 0.1, 'kl': 0.01769334776327014, 'entropy': 0.7995841801166534, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.27572924180422, 'epoch': 0.2}
 42%|####1     | 25/60 [13:41<17:24, 29.85s/it] 43%|####3     | 26/60 [14:15<17:37, 31.11s/it] 45%|####5     | 27/60 [14:50<17:48, 32.37s/it] 47%|####6     | 28/60 [15:23<17:17, 32.41s/it] 48%|####8     | 29/60 [15:50<15:53, 30.76s/it] 50%|#####     | 30/60 [16:20<15:23, 30.78s/it]                                               {'loss': 0.0259, 'grad_norm': 0.6396528482437134, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 158491.0, 'completions/mean_length': 214.575, 'completions/min_length': 89.2, 'completions/max_length': 392.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 214.575, 'completions/min_terminated_length': 89.2, 'completions/max_terminated_length': 392.8, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.20262537002563477, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.926913321018219, 'reward': 1.25625, 'reward_std': 0.8410307705402374, 'frac_reward_zero_std': 0.05, 'kl': 0.017241076100617647, 'entropy': 0.7573109328746795, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 31.384621116999188, 'epoch': 0.24}
 50%|#####     | 30/60 [16:21<15:23, 30.78s/it] 52%|#####1    | 31/60 [17:03<16:34, 34.31s/it] 53%|#####3    | 32/60 [17:45<17:02, 36.53s/it] 55%|#####5    | 33/60 [18:25<17:00, 37.78s/it] 57%|#####6    | 34/60 [19:07<16:53, 38.99s/it] 58%|#####8    | 35/60 [19:48<16:29, 39.56s/it]                                               {'loss': 0.0829, 'grad_norm': 0.6629019379615784, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 188300.0, 'completions/mean_length': 262.4625, 'completions/min_length': 91.8, 'completions/max_length': 512.0, 'completions/clipped_ratio': 0.1125, 'completions/mean_terminated_length': 232.40809936523436, 'completions/min_terminated_length': 91.8, 'completions/max_terminated_length': 428.6, 'rewards/format_reward_func/mean': 0.35625, 'rewards/format_reward_func/std': 0.23077536523342132, 'rewards/correctness_reward_func/mean': 0.725, 'rewards/correctness_reward_func/std': 0.911711573600769, 'reward': 1.08125, 'reward_std': 0.7194646954536438, 'frac_reward_zero_std': 0.1, 'kl': 0.020241344207897784, 'entropy': 1.067509551346302, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 40.91454928318562, 'epoch': 0.28}
 58%|#####8    | 35/60 [19:48<16:29, 39.56s/it] 60%|######    | 36/60 [20:24<15:23, 38.47s/it] 62%|######1   | 37/60 [21:07<15:13, 39.73s/it] 63%|######3   | 38/60 [21:49<14:48, 40.39s/it] 65%|######5   | 39/60 [22:24<13:36, 38.87s/it] 67%|######6   | 40/60 [23:09<13:32, 40.63s/it]                                               {'loss': 0.0611, 'grad_norm': 0.6721694469451904, 'learning_rate': 7e-06, 'num_tokens': 218293.0, 'completions/mean_length': 267.5625, 'completions/min_length': 93.2, 'completions/max_length': 484.4, 'completions/clipped_ratio': 0.05, 'completions/mean_terminated_length': 256.40607299804685, 'completions/min_terminated_length': 93.2, 'completions/max_terminated_length': 464.6, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.19680694341659546, 'rewards/correctness_reward_func/mean': 0.3625, 'rewards/correctness_reward_func/std': 0.6613142728805542, 'reward': 0.76875, 'reward_std': 0.6043181002140046, 'frac_reward_zero_std': 0.2, 'kl': 0.02213592892512679, 'entropy': 1.2195569545030593, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.528301566405574, 'epoch': 0.32}
 67%|######6   | 40/60 [23:09<13:32, 40.63s/it] 68%|######8   | 41/60 [23:50<12:54, 40.77s/it] 70%|#######   | 42/60 [24:31<12:14, 40.83s/it] 72%|#######1  | 43/60 [25:03<10:50, 38.28s/it] 73%|#######3  | 44/60 [25:44<10:24, 39.06s/it] 75%|#######5  | 45/60 [26:20<09:34, 38.29s/it]                                               {'loss': 0.0069, 'grad_norm': 0.6349403262138367, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 247370.0, 'completions/mean_length': 249.9625, 'completions/min_length': 115.6, 'completions/max_length': 468.0, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 243.33499755859376, 'completions/min_terminated_length': 115.6, 'completions/max_terminated_length': 427.4, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.15246951282024385, 'rewards/correctness_reward_func/mean': 0.6875, 'rewards/correctness_reward_func/std': 0.8672120094299316, 'reward': 1.1375, 'reward_std': 0.7290844857692719, 'frac_reward_zero_std': 0.15, 'kl': 0.03091249456629157, 'entropy': 0.8035079091787338, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 37.77489843379881, 'epoch': 0.36}
 75%|#######5  | 45/60 [26:20<09:34, 38.29s/it] 77%|#######6  | 46/60 [26:52<08:28, 36.35s/it] 78%|#######8  | 47/60 [27:32<08:04, 37.25s/it] 80%|########  | 48/60 [28:14<07:44, 38.72s/it] 82%|########1 | 49/60 [28:49<06:52, 37.54s/it] 83%|########3 | 50/60 [29:18<05:49, 34.99s/it]                                               {'loss': 0.0071, 'grad_norm': 0.6130396127700806, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 272406.0, 'completions/mean_length': 216.5, 'completions/min_length': 96.2, 'completions/max_length': 399.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 213.13250122070312, 'completions/min_terminated_length': 96.2, 'completions/max_terminated_length': 380.0, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.10562257766723633, 'rewards/correctness_reward_func/mean': 0.75, 'rewards/correctness_reward_func/std': 0.9016423702239991, 'reward': 1.20625, 'reward_std': 0.7817476630210877, 'frac_reward_zero_std': 0.1, 'kl': 0.02762110368348658, 'entropy': 0.8818802192807198, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 35.010284225002394, 'epoch': 0.4}
 83%|########3 | 50/60 [29:18<05:49, 34.99s/it] 85%|########5 | 51/60 [29:56<05:25, 36.14s/it] 87%|########6 | 52/60 [30:42<05:10, 38.85s/it] 88%|########8 | 53/60 [31:20<04:30, 38.61s/it] 90%|######### | 54/60 [32:02<03:58, 39.73s/it] 92%|#########1| 55/60 [32:36<03:10, 38.09s/it]                                               {'loss': 0.0522, 'grad_norm': 0.5736122727394104, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 299944.0, 'completions/mean_length': 241.625, 'completions/min_length': 116.8, 'completions/max_length': 471.0, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 230.31749877929687, 'completions/min_terminated_length': 116.8, 'completions/max_terminated_length': 423.2, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.18891051709651946, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.9283154964447021, 'reward': 1.275, 'reward_std': 0.7355756759643555, 'frac_reward_zero_std': 0.1, 'kl': 0.02801445033401251, 'entropy': 0.8554733961820602, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.1352983165998, 'epoch': 0.44}
 92%|#########1| 55/60 [32:36<03:10, 38.09s/it] 93%|#########3| 56/60 [33:21<02:39, 39.97s/it] 95%|#########5| 57/60 [33:56<01:55, 38.51s/it] 97%|#########6| 58/60 [34:31<01:15, 37.64s/it] 98%|#########8| 59/60 [35:14<00:39, 39.24s/it]100%|##########| 60/60 [35:50<00:00, 38.30s/it]                                               {'loss': -0.0301, 'grad_norm': 0.48767897486686707, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 328233.0, 'completions/mean_length': 245.5125, 'completions/min_length': 118.4, 'completions/max_length': 442.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 245.5125, 'completions/min_terminated_length': 118.4, 'completions/max_terminated_length': 442.4, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.1433130085468292, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.9061808824539185, 'reward': 1.16875, 'reward_std': 0.5530204951763154, 'frac_reward_zero_std': 0.25, 'kl': 0.0294767202809453, 'entropy': 0.8587960407137871, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 38.27240260020189, 'epoch': 0.48}
100%|##########| 60/60 [35:50<00:00, 38.30s/it]                                               {'train_runtime': 2152.0893, 'train_samples_per_second': 0.446, 'train_steps_per_second': 0.028, 'train_loss': 0.021983899424473444, 'epoch': 0.48}
100%|##########| 60/60 [35:52<00:00, 38.30s/it]100%|##########| 60/60 [35:52<00:00, 35.87s/it]

>>> Training: m3_indep_logic
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:24<23:57, 24.37s/it]  3%|3         | 2/60 [00:38<17:36, 18.21s/it]  5%|5         | 3/60 [01:04<20:36, 21.69s/it]  7%|6         | 4/60 [01:21<18:40, 20.01s/it]  8%|8         | 5/60 [01:37<16:57, 18.49s/it]                                              {'loss': 0.0101, 'grad_norm': 1.2048015594482422, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 14202.0, 'completions/mean_length': 89.875, 'completions/min_length': 12.6, 'completions/max_length': 234.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 89.875, 'completions/min_terminated_length': 12.6, 'completions/max_terminated_length': 234.6, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.24293359220027924, 'rewards/correctness_reward_func/mean': 0.375, 'rewards/correctness_reward_func/std': 0.4854445576667786, 'reward': 0.5875, 'reward_std': 0.3441216260194778, 'frac_reward_zero_std': 0.15, 'kl': 0.0036696528259199113, 'entropy': 1.1630759447813035, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.106724124992617, 'epoch': 0.04}
  8%|8         | 5/60 [01:37<16:57, 18.49s/it] 10%|#         | 6/60 [01:55<16:27, 18.29s/it] 12%|#1        | 7/60 [02:17<17:25, 19.73s/it] 13%|#3        | 8/60 [02:32<15:42, 18.12s/it] 15%|#5        | 9/60 [02:47<14:29, 17.04s/it] 17%|#6        | 10/60 [03:06<14:53, 17.87s/it]                                               {'loss': -0.0904, 'grad_norm': 1.6631624698638916, 'learning_rate': 1.7e-05, 'num_tokens': 28121.0, 'completions/mean_length': 85.4875, 'completions/min_length': 12.8, 'completions/max_length': 226.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 85.4875, 'completions/min_terminated_length': 12.8, 'completions/max_terminated_length': 226.2, 'rewards/format_reward_func/mean': 0.33125, 'rewards/format_reward_func/std': 0.2389538586139679, 'rewards/correctness_reward_func/mean': 0.4875, 'rewards/correctness_reward_func/std': 0.4770470380783081, 'reward': 0.81875, 'reward_std': 0.4527752161026001, 'frac_reward_zero_std': 0.0, 'kl': 0.017083421675488354, 'entropy': 1.1343500912189484, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.589262682799017, 'epoch': 0.08}
 17%|#6        | 10/60 [03:07<14:53, 17.87s/it] 18%|#8        | 11/60 [03:47<20:14, 24.78s/it] 20%|##        | 12/60 [03:56<16:05, 20.11s/it] 22%|##1       | 13/60 [04:32<19:25, 24.80s/it] 23%|##3       | 14/60 [04:47<16:43, 21.83s/it] 25%|##5       | 15/60 [05:09<16:25, 21.90s/it]                                               {'loss': 0.0866, 'grad_norm': 1.2750109434127808, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 41769.0, 'completions/mean_length': 78.4, 'completions/min_length': 15.2, 'completions/max_length': 305.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 78.4, 'completions/min_terminated_length': 15.2, 'completions/max_terminated_length': 305.4, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.20422180593013764, 'rewards/correctness_reward_func/mean': 0.5125, 'rewards/correctness_reward_func/std': 0.4939549446105957, 'reward': 0.9125, 'reward_std': 0.46092681884765624, 'frac_reward_zero_std': 0.05, 'kl': 0.031225374457426368, 'entropy': 1.257548514008522, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 24.086357558600138, 'epoch': 0.12}
 25%|##5       | 15/60 [05:09<16:25, 21.90s/it] 27%|##6       | 16/60 [05:34<16:41, 22.76s/it] 28%|##8       | 17/60 [05:56<16:09, 22.55s/it] 30%|###       | 18/60 [06:11<14:15, 20.36s/it] 32%|###1      | 19/60 [06:31<13:45, 20.13s/it] 33%|###3      | 20/60 [07:11<17:27, 26.20s/it]                                               {'loss': 0.1901, 'grad_norm': 1.0071810483932495, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 57880.0, 'completions/mean_length': 102.1875, 'completions/min_length': 18.8, 'completions/max_length': 309.4, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 97.35083312988282, 'completions/min_terminated_length': 18.8, 'completions/max_terminated_length': 254.4, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.202961727976799, 'rewards/correctness_reward_func/mean': 0.375, 'rewards/correctness_reward_func/std': 0.5142955720424652, 'reward': 0.775, 'reward_std': 0.45111349821090696, 'frac_reward_zero_std': 0.25, 'kl': 0.024920726008713246, 'entropy': 1.1920863151550294, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 23.958802808000474, 'epoch': 0.16}
 33%|###3      | 20/60 [07:11<17:27, 26.20s/it] 35%|###5      | 21/60 [07:25<14:33, 22.40s/it] 37%|###6      | 22/60 [07:40<12:46, 20.18s/it] 38%|###8      | 23/60 [07:53<11:07, 18.03s/it] 40%|####      | 24/60 [08:14<11:26, 19.08s/it] 42%|####1     | 25/60 [08:26<09:47, 16.79s/it]                                               {'loss': 0.0455, 'grad_norm': 1.8867968320846558, 'learning_rate': 1.2e-05, 'num_tokens': 69469.0, 'completions/mean_length': 56.0625, 'completions/min_length': 19.0, 'completions/max_length': 181.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 56.0625, 'completions/min_terminated_length': 19.0, 'completions/max_terminated_length': 181.0, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.11831300854682922, 'rewards/correctness_reward_func/mean': 0.55, 'rewards/correctness_reward_func/std': 0.5080508947372436, 'reward': 1.025, 'reward_std': 0.3673589289188385, 'frac_reward_zero_std': 0.3, 'kl': 0.04431482404470444, 'entropy': 0.9833300992846489, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.593533800399745, 'epoch': 0.2}
 42%|####1     | 25/60 [08:26<09:47, 16.79s/it] 43%|####3     | 26/60 [08:48<10:29, 18.53s/it] 45%|####5     | 27/60 [09:00<09:10, 16.68s/it] 47%|####6     | 28/60 [09:13<08:10, 15.32s/it] 48%|####8     | 29/60 [09:20<06:38, 12.85s/it] 50%|#####     | 30/60 [09:29<05:53, 11.79s/it]                                               {'loss': -0.0514, 'grad_norm': 2.6661887168884277, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 80336.0, 'completions/mean_length': 45.8875, 'completions/min_length': 16.0, 'completions/max_length': 147.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 45.8875, 'completions/min_terminated_length': 16.0, 'completions/max_terminated_length': 147.4, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.19206051230430604, 'rewards/correctness_reward_func/mean': 0.575, 'rewards/correctness_reward_func/std': 0.466357547044754, 'reward': 0.98125, 'reward_std': 0.30644230246543885, 'frac_reward_zero_std': 0.3, 'kl': 0.05623802673071623, 'entropy': 0.8997589275240898, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.420531466801185, 'epoch': 0.24}
 50%|#####     | 30/60 [09:29<05:53, 11.79s/it] 52%|#####1    | 31/60 [09:46<06:28, 13.40s/it] 53%|#####3    | 32/60 [10:01<06:29, 13.90s/it] 55%|#####5    | 33/60 [10:21<06:59, 15.55s/it] 57%|#####6    | 34/60 [10:37<06:48, 15.70s/it] 58%|#####8    | 35/60 [10:51<06:19, 15.18s/it]                                               {'loss': 0.0434, 'grad_norm': 1.1737215518951416, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 93142.0, 'completions/mean_length': 68.775, 'completions/min_length': 21.4, 'completions/max_length': 202.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 68.775, 'completions/min_terminated_length': 21.4, 'completions/max_terminated_length': 202.0, 'rewards/format_reward_func/mean': 0.44375, 'rewards/format_reward_func/std': 0.13977908194065095, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.5153132677078247, 'reward': 0.96875, 'reward_std': 0.32451180219650266, 'frac_reward_zero_std': 0.35, 'kl': 0.0338642546441406, 'entropy': 1.0595213651657105, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 16.002532925005653, 'epoch': 0.28}
 58%|#####8    | 35/60 [10:51<06:19, 15.18s/it] 60%|######    | 36/60 [10:58<05:07, 12.80s/it] 62%|######1   | 37/60 [11:22<06:09, 16.05s/it] 63%|######3   | 38/60 [11:37<05:51, 15.99s/it] 65%|######5   | 39/60 [12:06<06:52, 19.64s/it] 67%|######6   | 40/60 [12:20<06:00, 18.04s/it]                                               {'loss': -0.0838, 'grad_norm': 1.2358317375183105, 'learning_rate': 7e-06, 'num_tokens': 105615.0, 'completions/mean_length': 67.8125, 'completions/min_length': 20.8, 'completions/max_length': 216.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 67.8125, 'completions/min_terminated_length': 20.8, 'completions/max_terminated_length': 216.8, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.09946779310703277, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.4627369403839111, 'reward': 1.1125, 'reward_std': 0.38621277213096616, 'frac_reward_zero_std': 0.25, 'kl': 0.04220401719212532, 'entropy': 0.996608453989029, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.486758533396642, 'epoch': 0.32}
 67%|######6   | 40/60 [12:20<06:00, 18.04s/it] 68%|######8   | 41/60 [12:41<06:00, 19.00s/it] 70%|#######   | 42/60 [13:10<06:35, 21.99s/it] 72%|#######1  | 43/60 [13:30<06:02, 21.31s/it] 73%|#######3  | 44/60 [13:41<04:51, 18.22s/it] 75%|#######5  | 45/60 [14:03<04:50, 19.38s/it]                                               {'loss': 0.1319, 'grad_norm': 1.1826684474945068, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 119764.0, 'completions/mean_length': 76.1125, 'completions/min_length': 19.2, 'completions/max_length': 252.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 76.1125, 'completions/min_terminated_length': 19.2, 'completions/max_terminated_length': 252.4, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.10862429738044739, 'rewards/correctness_reward_func/mean': 0.425, 'rewards/correctness_reward_func/std': 0.5031512618064881, 'reward': 0.88125, 'reward_std': 0.47410252690315247, 'frac_reward_zero_std': 0.1, 'kl': 0.03338031647726893, 'entropy': 1.093638327717781, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.21140624198888, 'epoch': 0.36}
 75%|#######5  | 45/60 [14:03<04:50, 19.38s/it] 77%|#######6  | 46/60 [14:22<04:28, 19.20s/it] 78%|#######8  | 47/60 [14:37<03:54, 18.00s/it] 80%|########  | 48/60 [14:49<03:15, 16.26s/it] 82%|########1 | 49/60 [15:00<02:42, 14.80s/it] 83%|########3 | 50/60 [15:14<02:25, 14.52s/it]                                               {'loss': 0.0512, 'grad_norm': 1.0878783464431763, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 133232.0, 'completions/mean_length': 67.95, 'completions/min_length': 17.6, 'completions/max_length': 170.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 67.95, 'completions/min_terminated_length': 17.6, 'completions/max_terminated_length': 170.8, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.11531128883361816, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.4758143723011017, 'reward': 0.9875, 'reward_std': 0.4169958531856537, 'frac_reward_zero_std': 0.25, 'kl': 0.036847513634711504, 'entropy': 0.9664400070905685, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.979067425205722, 'epoch': 0.4}
 83%|########3 | 50/60 [15:14<02:25, 14.52s/it] 85%|########5 | 51/60 [15:28<02:08, 14.28s/it] 87%|########6 | 52/60 [15:48<02:06, 15.85s/it] 88%|########8 | 53/60 [16:01<01:45, 15.08s/it] 90%|######### | 54/60 [16:15<01:28, 14.73s/it] 92%|#########1| 55/60 [16:27<01:10, 14.04s/it]                                               {'loss': 0.1852, 'grad_norm': 1.354972243309021, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 144347.0, 'completions/mean_length': 51.0375, 'completions/min_length': 20.8, 'completions/max_length': 176.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 51.0375, 'completions/min_terminated_length': 20.8, 'completions/max_terminated_length': 176.8, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.44924116134643555, 'reward': 0.975, 'reward_std': 0.27369458973407745, 'frac_reward_zero_std': 0.45, 'kl': 0.04695229730568826, 'entropy': 0.9184969812631607, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.258857958193403, 'epoch': 0.44}
 92%|#########1| 55/60 [16:27<01:10, 14.04s/it] 93%|#########3| 56/60 [16:43<00:58, 14.65s/it] 95%|#########5| 57/60 [16:52<00:38, 12.87s/it] 97%|#########6| 58/60 [17:08<00:27, 13.75s/it] 98%|#########8| 59/60 [17:29<00:15, 15.97s/it]100%|##########| 60/60 [17:43<00:00, 15.28s/it]                                               {'loss': 0.0408, 'grad_norm': 1.4887140989303589, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 156591.0, 'completions/mean_length': 57.45, 'completions/min_length': 16.8, 'completions/max_length': 180.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 57.45, 'completions/min_terminated_length': 16.8, 'completions/max_terminated_length': 180.0, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.12887786626815795, 'rewards/correctness_reward_func/mean': 0.5125, 'rewards/correctness_reward_func/std': 0.5277891397476197, 'reward': 0.9625, 'reward_std': 0.4567859351634979, 'frac_reward_zero_std': 0.15, 'kl': 0.047705307975411414, 'entropy': 0.9324046432971954, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.779221058203257, 'epoch': 0.48}
100%|##########| 60/60 [17:43<00:00, 15.28s/it]                                               {'train_runtime': 1063.831, 'train_samples_per_second': 0.902, 'train_steps_per_second': 0.056, 'train_loss': 0.04658882642785708, 'epoch': 0.48}
100%|##########| 60/60 [17:43<00:00, 15.28s/it]100%|##########| 60/60 [17:43<00:00, 17.73s/it]
>>> Merging Adapters...
Loading Base Model on mps...
Accuracy on Task A (Math): 20.00%
Accuracy on Task B (Logic): 78.00%
>>> Method 3: Task Arithmetic COMPLETED SUCCESSFULLY.

====================
STARTING Method 4: EWC Lite
====================

=== METHOD 4: ANCHORING (EWC-LITE) ===

>>> Training: m4_step1_math
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:41<40:45, 41.44s/it]  3%|3         | 2/60 [01:23<40:36, 42.01s/it]  5%|5         | 3/60 [01:51<33:42, 35.48s/it]  7%|6         | 4/60 [02:12<27:37, 29.59s/it]  8%|8         | 5/60 [02:54<31:22, 34.23s/it]                                              {'loss': 0.0196, 'grad_norm': 0.6742674112319946, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 27261.0, 'completions/mean_length': 230.5125, 'completions/min_length': 82.0, 'completions/max_length': 432.6, 'completions/clipped_ratio': 0.0625, 'completions/mean_terminated_length': 212.79685974121094, 'completions/min_terminated_length': 82.0, 'completions/max_terminated_length': 357.4, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.24565533995628358, 'rewards/correctness_reward_func/mean': 0.625, 'rewards/correctness_reward_func/std': 0.7776928305625915, 'reward': 0.8375, 'reward_std': 0.6737917900085449, 'frac_reward_zero_std': 0.05, 'kl': 0.0019530092948116362, 'entropy': 0.9574822530150413, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.358792516990796, 'epoch': 0.04}
  8%|8         | 5/60 [02:54<31:22, 34.23s/it] 10%|#         | 6/60 [03:35<32:45, 36.39s/it] 12%|#1        | 7/60 [03:58<28:21, 32.10s/it] 13%|#3        | 8/60 [04:38<29:59, 34.61s/it] 15%|#5        | 9/60 [05:09<28:34, 33.62s/it] 17%|#6        | 10/60 [05:51<30:05, 36.11s/it]                                               {'loss': 0.0209, 'grad_norm': 0.7963788509368896, 'learning_rate': 1.7e-05, 'num_tokens': 53568.0, 'completions/mean_length': 226.2375, 'completions/min_length': 73.6, 'completions/max_length': 448.2, 'completions/clipped_ratio': 0.05, 'completions/mean_terminated_length': 212.74237060546875, 'completions/min_terminated_length': 73.6, 'completions/max_terminated_length': 425.0, 'rewards/format_reward_func/mean': 0.275, 'rewards/format_reward_func/std': 0.2626740574836731, 'rewards/correctness_reward_func/mean': 0.5125, 'rewards/correctness_reward_func/std': 0.8402174711227417, 'reward': 0.7875, 'reward_std': 0.7154754936695099, 'frac_reward_zero_std': 0.05, 'kl': 0.005667408800218254, 'entropy': 0.7827825531363487, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.855073758008075, 'epoch': 0.08}
 17%|#6        | 10/60 [05:51<30:05, 36.11s/it] 18%|#8        | 11/60 [06:33<30:59, 37.94s/it] 20%|##        | 12/60 [07:15<31:23, 39.24s/it] 22%|##1       | 13/60 [07:43<27:58, 35.72s/it] 23%|##3       | 14/60 [08:25<28:49, 37.59s/it] 25%|##5       | 15/60 [09:03<28:18, 37.75s/it]                                               {'loss': -0.0127, 'grad_norm': 0.7926964163780212, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 81824.0, 'completions/mean_length': 243.05, 'completions/min_length': 53.2, 'completions/max_length': 468.4, 'completions/clipped_ratio': 0.0625, 'completions/mean_terminated_length': 226.4477569580078, 'completions/min_terminated_length': 53.2, 'completions/max_terminated_length': 399.8, 'rewards/format_reward_func/mean': 0.3625, 'rewards/format_reward_func/std': 0.24272599518299104, 'rewards/correctness_reward_func/mean': 0.5625, 'rewards/correctness_reward_func/std': 0.7833755254745484, 'reward': 0.925, 'reward_std': 0.6883241295814514, 'frac_reward_zero_std': 0.0, 'kl': 0.012271425046492368, 'entropy': 0.823385339975357, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 37.80569440019608, 'epoch': 0.12}
 25%|##5       | 15/60 [09:03<28:18, 37.75s/it] 27%|##6       | 16/60 [09:36<26:32, 36.20s/it] 28%|##8       | 17/60 [10:07<24:49, 34.63s/it] 30%|###       | 18/60 [10:31<22:00, 31.44s/it] 32%|###1      | 19/60 [11:11<23:19, 34.13s/it] 33%|###3      | 20/60 [11:46<23:00, 34.51s/it]                                               {'loss': -0.0025, 'grad_norm': 0.6455855369567871, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 109131.0, 'completions/mean_length': 237.4375, 'completions/min_length': 119.8, 'completions/max_length': 402.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 237.4375, 'completions/min_terminated_length': 119.8, 'completions/max_terminated_length': 402.4, 'rewards/format_reward_func/mean': 0.38125, 'rewards/format_reward_func/std': 0.21391051709651948, 'rewards/correctness_reward_func/mean': 0.95, 'rewards/correctness_reward_func/std': 0.9064032077789307, 'reward': 1.33125, 'reward_std': 0.5435834944248199, 'frac_reward_zero_std': 0.2, 'kl': 0.03810361449141055, 'entropy': 0.7238268211483956, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 32.13583219199499, 'epoch': 0.16}
 33%|###3      | 20/60 [11:46<23:00, 34.51s/it] 35%|###5      | 21/60 [12:15<21:21, 32.86s/it] 37%|###6      | 22/60 [12:58<22:35, 35.68s/it] 38%|###8      | 23/60 [13:39<22:57, 37.23s/it] 40%|####      | 24/60 [14:07<20:48, 34.67s/it] 42%|####1     | 25/60 [14:42<20:12, 34.63s/it]                                               {'loss': 0.0559, 'grad_norm': 0.6036158204078674, 'learning_rate': 1.2e-05, 'num_tokens': 136240.0, 'completions/mean_length': 230.2125, 'completions/min_length': 90.0, 'completions/max_length': 420.2, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 226.53333435058593, 'completions/min_terminated_length': 90.0, 'completions/max_terminated_length': 401.8, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.19065522849559785, 'rewards/correctness_reward_func/mean': 0.8, 'rewards/correctness_reward_func/std': 0.8781993985176086, 'reward': 1.2125, 'reward_std': 0.5526661992073059, 'frac_reward_zero_std': 0.2, 'kl': 0.025879579270258544, 'entropy': 0.7641634359955788, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.50195609960647, 'epoch': 0.2}
 42%|####1     | 25/60 [14:42<20:12, 34.63s/it] 43%|####3     | 26/60 [15:12<18:50, 33.26s/it] 45%|####5     | 27/60 [15:52<19:22, 35.22s/it] 47%|####6     | 28/60 [16:34<19:52, 37.26s/it] 48%|####8     | 29/60 [16:55<16:51, 32.62s/it] 50%|#####     | 30/60 [17:22<15:20, 30.70s/it]                                               {'loss': -0.0049, 'grad_norm': 0.7135864496231079, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 160922.0, 'completions/mean_length': 210.975, 'completions/min_length': 96.0, 'completions/max_length': 389.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 210.975, 'completions/min_terminated_length': 96.0, 'completions/max_terminated_length': 389.4, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.167780801653862, 'rewards/correctness_reward_func/mean': 0.925, 'rewards/correctness_reward_func/std': 0.8924699306488038, 'reward': 1.3625, 'reward_std': 0.6773419797420501, 'frac_reward_zero_std': 0.15, 'kl': 0.027024511341005565, 'entropy': 0.6935084208846092, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 31.472998607801856, 'epoch': 0.24}
 50%|#####     | 30/60 [17:22<15:20, 30.70s/it] 52%|#####1    | 31/60 [18:05<16:36, 34.37s/it] 53%|#####3    | 32/60 [18:48<17:15, 36.97s/it] 55%|#####5    | 33/60 [19:11<14:50, 32.96s/it] 57%|#####6    | 34/60 [19:50<15:03, 34.75s/it] 58%|#####8    | 35/60 [20:27<14:47, 35.51s/it]                                               {'loss': 0.0213, 'grad_norm': 0.7283806800842285, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 189261.0, 'completions/mean_length': 244.0875, 'completions/min_length': 95.4, 'completions/max_length': 435.4, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 238.15178833007812, 'completions/min_terminated_length': 95.4, 'completions/max_terminated_length': 407.4, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.18905572295188905, 'rewards/correctness_reward_func/mean': 0.825, 'rewards/correctness_reward_func/std': 0.8773019552230835, 'reward': 1.23125, 'reward_std': 0.6745367646217346, 'frac_reward_zero_std': 0.15, 'kl': 0.02512463997118175, 'entropy': 0.8046540379524231, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.582903383197845, 'epoch': 0.28}
 58%|#####8    | 35/60 [20:28<14:47, 35.51s/it] 60%|######    | 36/60 [21:07<14:38, 36.61s/it] 62%|######1   | 37/60 [21:43<14:01, 36.57s/it] 63%|######3   | 38/60 [22:28<14:18, 39.04s/it] 65%|######5   | 39/60 [23:02<13:06, 37.43s/it] 67%|######6   | 40/60 [23:47<13:15, 39.78s/it]                                               {'loss': 0.0882, 'grad_norm': 0.6698045134544373, 'learning_rate': 7e-06, 'num_tokens': 218729.0, 'completions/mean_length': 261.0, 'completions/min_length': 97.2, 'completions/max_length': 459.0, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 255.4441650390625, 'completions/min_terminated_length': 97.2, 'completions/max_terminated_length': 452.4, 'rewards/format_reward_func/mean': 0.36875, 'rewards/format_reward_func/std': 0.20551764369010925, 'rewards/correctness_reward_func/mean': 0.4375, 'rewards/correctness_reward_func/std': 0.6529669046401978, 'reward': 0.80625, 'reward_std': 0.6385946869850159, 'frac_reward_zero_std': 0.1, 'kl': 0.022728350758552552, 'entropy': 1.079333335161209, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.28702340879827, 'epoch': 0.32}
 67%|######6   | 40/60 [23:47<13:15, 39.78s/it] 68%|######8   | 41/60 [24:28<12:46, 40.33s/it] 70%|#######   | 42/60 [25:05<11:47, 39.30s/it] 72%|#######1  | 43/60 [25:38<10:32, 37.22s/it] 73%|#######3  | 44/60 [26:21<10:22, 38.91s/it] 75%|#######5  | 45/60 [26:55<09:22, 37.47s/it]                                               {'loss': 0.0278, 'grad_norm': 0.5192548632621765, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 247739.0, 'completions/mean_length': 249.125, 'completions/min_length': 125.4, 'completions/max_length': 433.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 245.3875, 'completions/min_terminated_length': 125.4, 'completions/max_terminated_length': 412.6, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.167780801653862, 'rewards/correctness_reward_func/mean': 0.8375, 'rewards/correctness_reward_func/std': 0.8931044697761535, 'reward': 1.275, 'reward_std': 0.6483131051063538, 'frac_reward_zero_std': 0.2, 'kl': 0.02241577785462141, 'entropy': 0.7760683298110962, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.96697789139871, 'epoch': 0.36}
 75%|#######5  | 45/60 [26:55<09:22, 37.47s/it] 77%|#######6  | 46/60 [27:34<08:50, 37.90s/it] 78%|#######8  | 47/60 [28:16<08:30, 39.25s/it] 80%|########  | 48/60 [29:00<08:09, 40.82s/it] 82%|########1 | 49/60 [29:49<07:53, 43.04s/it] 83%|########3 | 50/60 [30:30<07:05, 42.52s/it]                                               {'loss': 0.0509, 'grad_norm': 1.2058420181274414, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 272539.0, 'completions/mean_length': 213.55, 'completions/min_length': 84.4, 'completions/max_length': 458.2, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 209.7933319091797, 'completions/min_terminated_length': 84.4, 'completions/max_terminated_length': 415.0, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.18750216364860534, 'rewards/correctness_reward_func/mean': 0.6, 'rewards/correctness_reward_func/std': 0.8868868827819825, 'reward': 1.01875, 'reward_std': 0.6574114203453064, 'frac_reward_zero_std': 0.15, 'kl': 0.03016138249076903, 'entropy': 0.8143232196569443, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 42.64771699999983, 'epoch': 0.4}
 83%|########3 | 50/60 [30:30<07:05, 42.52s/it] 85%|########5 | 51/60 [30:57<05:40, 37.88s/it] 87%|########6 | 52/60 [31:47<05:31, 41.46s/it] 88%|########8 | 53/60 [32:29<04:51, 41.67s/it] 90%|######### | 54/60 [33:04<03:57, 39.66s/it] 92%|#########1| 55/60 [33:36<03:06, 37.36s/it]                                               {'loss': -0.0653, 'grad_norm': 0.6099587678909302, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 298358.0, 'completions/mean_length': 220.1375, 'completions/min_length': 58.2, 'completions/max_length': 415.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 220.1375, 'completions/min_terminated_length': 58.2, 'completions/max_terminated_length': 415.2, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.20121701657772065, 'rewards/correctness_reward_func/mean': 0.9375, 'rewards/correctness_reward_func/std': 0.9651719689369201, 'reward': 1.3375, 'reward_std': 0.6401887893676758, 'frac_reward_zero_std': 0.2, 'kl': 0.03344678673893213, 'entropy': 0.7704147607088089, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.620340832998046, 'epoch': 0.44}
 92%|#########1| 55/60 [33:36<03:06, 37.36s/it] 93%|#########3| 56/60 [34:22<02:40, 40.02s/it] 95%|#########5| 57/60 [34:57<01:55, 38.44s/it] 97%|#########6| 58/60 [35:31<01:14, 37.20s/it] 98%|#########8| 59/60 [36:12<00:38, 38.40s/it]100%|##########| 60/60 [36:45<00:00, 36.63s/it]                                               {'loss': -0.006, 'grad_norm': 0.6973119378089905, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 325093.0, 'completions/mean_length': 226.0875, 'completions/min_length': 84.8, 'completions/max_length': 428.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 226.0875, 'completions/min_terminated_length': 84.8, 'completions/max_terminated_length': 428.0, 'rewards/format_reward_func/mean': 0.44375, 'rewards/format_reward_func/std': 0.13202786147594453, 'rewards/correctness_reward_func/mean': 0.725, 'rewards/correctness_reward_func/std': 0.9499430656433105, 'reward': 1.16875, 'reward_std': 0.5950387597084046, 'frac_reward_zero_std': 0.25, 'kl': 0.027570348186418413, 'entropy': 0.8340720415115357, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 37.247285991406535, 'epoch': 0.48}
100%|##########| 60/60 [36:45<00:00, 36.63s/it]                                               {'train_runtime': 2206.4558, 'train_samples_per_second': 0.435, 'train_steps_per_second': 0.027, 'train_loss': 0.016098535247147085, 'epoch': 0.48}
100%|##########| 60/60 [36:46<00:00, 36.63s/it]100%|##########| 60/60 [36:46<00:00, 36.77s/it]

>>> Training: m4_step2_logic
>>> Continuing training on existing Adapter...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:34<33:30, 34.07s/it]  3%|3         | 2/60 [00:48<21:29, 22.22s/it]  5%|5         | 3/60 [01:03<18:02, 19.00s/it]  7%|6         | 4/60 [01:21<17:38, 18.90s/it]  8%|8         | 5/60 [01:38<16:30, 18.01s/it]                                              {'loss': -0.0256, 'grad_norm': 0.9982960820198059, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 13656.0, 'completions/mean_length': 83.05, 'completions/min_length': 17.2, 'completions/max_length': 247.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 83.05, 'completions/min_terminated_length': 17.2, 'completions/max_terminated_length': 247.2, 'rewards/format_reward_func/mean': 0.43125, 'rewards/format_reward_func/std': 0.1709338665008545, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.6810596346855163, 'reward': 0.95625, 'reward_std': 0.6013188123703003, 'frac_reward_zero_std': 0.1, 'kl': 0.032367571559734645, 'entropy': 1.0292574435472488, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.309349666401978, 'epoch': 0.04}
  8%|8         | 5/60 [01:38<16:30, 18.01s/it] 10%|#         | 6/60 [02:04<18:36, 20.68s/it] 12%|#1        | 7/60 [02:22<17:43, 20.06s/it] 13%|#3        | 8/60 [02:37<15:44, 18.16s/it] 15%|#5        | 9/60 [02:49<13:57, 16.41s/it] 17%|#6        | 10/60 [03:09<14:35, 17.51s/it]                                               {'loss': 0.0136, 'grad_norm': 0.9949154853820801, 'learning_rate': 1.7e-05, 'num_tokens': 28999.0, 'completions/mean_length': 103.2875, 'completions/min_length': 18.6, 'completions/max_length': 229.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 103.2875, 'completions/min_terminated_length': 18.6, 'completions/max_terminated_length': 229.8, 'rewards/format_reward_func/mean': 0.35, 'rewards/format_reward_func/std': 0.23290400803089142, 'rewards/correctness_reward_func/mean': 0.5375, 'rewards/correctness_reward_func/std': 0.5839635729789734, 'reward': 0.8875, 'reward_std': 0.5421283841133118, 'frac_reward_zero_std': 0.0, 'kl': 0.019410479394719005, 'entropy': 1.2001341789960862, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.876649741604343, 'epoch': 0.08}
 17%|#6        | 10/60 [03:09<14:35, 17.51s/it] 18%|#8        | 11/60 [03:35<16:18, 19.98s/it] 20%|##        | 12/60 [03:54<15:44, 19.68s/it] 22%|##1       | 13/60 [04:10<14:32, 18.57s/it] 23%|##3       | 14/60 [04:34<15:28, 20.18s/it] 25%|##5       | 15/60 [04:49<14:01, 18.70s/it]                                               {'loss': -0.0155, 'grad_norm': 0.9904918670654297, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 44823.0, 'completions/mean_length': 105.6, 'completions/min_length': 15.6, 'completions/max_length': 252.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 105.6, 'completions/min_terminated_length': 15.6, 'completions/max_terminated_length': 252.4, 'rewards/format_reward_func/mean': 0.31875, 'rewards/format_reward_func/std': 0.23605400323867798, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.48969765901565554, 'reward': 0.84375, 'reward_std': 0.4424747824668884, 'frac_reward_zero_std': 0.1, 'kl': 0.01843769697006792, 'entropy': 1.158642840385437, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.56265916620323, 'epoch': 0.12}
 25%|##5       | 15/60 [04:49<14:01, 18.70s/it] 27%|##6       | 16/60 [05:11<14:25, 19.67s/it] 28%|##8       | 17/60 [05:32<14:25, 20.13s/it] 30%|###       | 18/60 [06:02<16:04, 22.96s/it] 32%|###1      | 19/60 [06:23<15:21, 22.47s/it] 33%|###3      | 20/60 [06:57<17:19, 25.99s/it]                                               {'loss': -0.0106, 'grad_norm': 0.8214147686958313, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 63094.0, 'completions/mean_length': 129.1875, 'completions/min_length': 26.4, 'completions/max_length': 329.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 129.1875, 'completions/min_terminated_length': 26.4, 'completions/max_terminated_length': 329.2, 'rewards/format_reward_func/mean': 0.3625, 'rewards/format_reward_func/std': 0.22762537002563477, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.5552579879760742, 'reward': 0.8625, 'reward_std': 0.5397135257720947, 'frac_reward_zero_std': 0.05, 'kl': 0.016800862085074187, 'entropy': 1.2946870177984238, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 25.18244754099287, 'epoch': 0.16}
 33%|###3      | 20/60 [06:57<17:19, 25.99s/it] 35%|###5      | 21/60 [07:22<16:38, 25.59s/it] 37%|###6      | 22/60 [07:46<15:52, 25.07s/it] 38%|###8      | 23/60 [08:03<14:07, 22.90s/it] 40%|####      | 24/60 [08:25<13:31, 22.54s/it] 42%|####1     | 25/60 [08:48<13:08, 22.54s/it]                                               {'loss': -0.052, 'grad_norm': 1.2351397275924683, 'learning_rate': 1.2e-05, 'num_tokens': 78924.0, 'completions/mean_length': 109.075, 'completions/min_length': 19.2, 'completions/max_length': 281.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 109.075, 'completions/min_terminated_length': 19.2, 'completions/max_terminated_length': 281.0, 'rewards/format_reward_func/mean': 0.35, 'rewards/format_reward_func/std': 0.23201012313365937, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.5210976958274841, 'reward': 0.875, 'reward_std': 0.4592690706253052, 'frac_reward_zero_std': 0.05, 'kl': 0.019508131453767417, 'entropy': 1.2601615279912948, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 21.704032691998872, 'epoch': 0.2}
 42%|####1     | 25/60 [08:48<13:08, 22.54s/it] 43%|####3     | 26/60 [09:09<12:37, 22.29s/it] 45%|####5     | 27/60 [09:28<11:34, 21.04s/it] 47%|####6     | 28/60 [09:47<10:56, 20.52s/it] 48%|####8     | 29/60 [10:08<10:40, 20.66s/it] 50%|#####     | 30/60 [10:26<09:59, 19.98s/it]                                               {'loss': 0.0542, 'grad_norm': 1.4093399047851562, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 93581.0, 'completions/mean_length': 93.2625, 'completions/min_length': 18.0, 'completions/max_length': 248.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 93.2625, 'completions/min_terminated_length': 18.0, 'completions/max_terminated_length': 248.4, 'rewards/format_reward_func/mean': 0.3, 'rewards/format_reward_func/std': 0.25074589252471924, 'rewards/correctness_reward_func/mean': 0.625, 'rewards/correctness_reward_func/std': 0.47909392714500426, 'reward': 0.925, 'reward_std': 0.47939746379852294, 'frac_reward_zero_std': 0.05, 'kl': 0.014688219875097275, 'entropy': 1.2886569023132324, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.317467158389626, 'epoch': 0.24}
 50%|#####     | 30/60 [10:26<09:59, 19.98s/it] 52%|#####1    | 31/60 [10:49<10:07, 20.96s/it] 53%|#####3    | 32/60 [11:07<09:17, 19.90s/it] 55%|#####5    | 33/60 [11:25<08:45, 19.45s/it] 57%|#####6    | 34/60 [11:44<08:17, 19.13s/it] 58%|#####8    | 35/60 [12:09<08:48, 21.13s/it]                                               {'loss': 0.0184, 'grad_norm': 0.9774605631828308, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 109206.0, 'completions/mean_length': 104.0125, 'completions/min_length': 13.8, 'completions/max_length': 260.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 104.0125, 'completions/min_terminated_length': 13.8, 'completions/max_terminated_length': 260.4, 'rewards/format_reward_func/mean': 0.34375, 'rewards/format_reward_func/std': 0.23113397657871246, 'rewards/correctness_reward_func/mean': 0.45, 'rewards/correctness_reward_func/std': 0.5092282474040986, 'reward': 0.79375, 'reward_std': 0.4549559473991394, 'frac_reward_zero_std': 0.0, 'kl': 0.014524051360785961, 'entropy': 1.3420821964740752, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.248820091798553, 'epoch': 0.28}
 58%|#####8    | 35/60 [12:09<08:48, 21.13s/it] 60%|######    | 36/60 [12:24<07:41, 19.21s/it] 62%|######1   | 37/60 [12:53<08:26, 22.03s/it] 63%|######3   | 38/60 [13:08<07:22, 20.12s/it] 65%|######5   | 39/60 [13:34<07:39, 21.87s/it] 67%|######6   | 40/60 [13:54<07:06, 21.32s/it]                                               {'loss': 0.0348, 'grad_norm': 1.2079368829727173, 'learning_rate': 7e-06, 'num_tokens': 123618.0, 'completions/mean_length': 92.05, 'completions/min_length': 14.2, 'completions/max_length': 265.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 92.05, 'completions/min_terminated_length': 14.2, 'completions/max_terminated_length': 265.0, 'rewards/format_reward_func/mean': 0.30625, 'rewards/format_reward_func/std': 0.2399519830942154, 'rewards/correctness_reward_func/mean': 0.5375, 'rewards/correctness_reward_func/std': 0.5559180319309235, 'reward': 0.84375, 'reward_std': 0.47040162682533265, 'frac_reward_zero_std': 0.05, 'kl': 0.015535828424617648, 'entropy': 1.402157363295555, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.580580700014252, 'epoch': 0.32}
 67%|######6   | 40/60 [13:54<07:06, 21.32s/it] 68%|######8   | 41/60 [14:15<06:41, 21.15s/it] 70%|#######   | 42/60 [14:35<06:11, 20.64s/it] 72%|#######1  | 43/60 [14:52<05:34, 19.66s/it] 73%|#######3  | 44/60 [15:10<05:07, 19.19s/it] 75%|#######5  | 45/60 [15:27<04:38, 18.57s/it]                                               {'loss': -0.0046, 'grad_norm': 0.9609301090240479, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 139840.0, 'completions/mean_length': 102.025, 'completions/min_length': 20.6, 'completions/max_length': 230.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 102.025, 'completions/min_terminated_length': 20.6, 'completions/max_terminated_length': 230.2, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.18924687504768373, 'rewards/correctness_reward_func/mean': 0.4875, 'rewards/correctness_reward_func/std': 0.5541306734085083, 'reward': 0.90625, 'reward_std': 0.46268883943557737, 'frac_reward_zero_std': 0.05, 'kl': 0.015637785103172062, 'entropy': 1.2435397297143935, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 18.179330833200947, 'epoch': 0.36}
 75%|#######5  | 45/60 [15:27<04:38, 18.57s/it] 77%|#######6  | 46/60 [15:49<04:31, 19.40s/it] 78%|#######8  | 47/60 [16:07<04:07, 19.04s/it] 80%|########  | 48/60 [16:22<03:36, 18.01s/it] 82%|########1 | 49/60 [16:49<03:46, 20.63s/it] 83%|########3 | 50/60 [17:22<04:04, 24.45s/it]                                               {'loss': -0.086, 'grad_norm': 0.9063902497291565, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 157131.0, 'completions/mean_length': 115.7375, 'completions/min_length': 21.4, 'completions/max_length': 290.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 115.7375, 'completions/min_terminated_length': 21.4, 'completions/max_terminated_length': 290.4, 'rewards/format_reward_func/mean': 0.3875, 'rewards/format_reward_func/std': 0.21178187429904938, 'rewards/correctness_reward_func/mean': 0.6625, 'rewards/correctness_reward_func/std': 0.6133571982383728, 'reward': 1.05, 'reward_std': 0.5942513704299927, 'frac_reward_zero_std': 0.0, 'kl': 0.015697268629446627, 'entropy': 1.347000277042389, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.623558950194273, 'epoch': 0.4}
 83%|########3 | 50/60 [17:23<04:04, 24.45s/it] 85%|########5 | 51/60 [17:46<03:36, 24.11s/it] 87%|########6 | 52/60 [18:13<03:20, 25.08s/it] 88%|########8 | 53/60 [18:31<02:41, 23.01s/it] 90%|######### | 54/60 [18:46<02:03, 20.55s/it] 92%|#########1| 55/60 [19:04<01:38, 19.73s/it]                                               {'loss': 0.0026, 'grad_norm': 0.9140712022781372, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 171823.0, 'completions/mean_length': 95.75, 'completions/min_length': 18.4, 'completions/max_length': 252.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 95.75, 'completions/min_terminated_length': 18.4, 'completions/max_terminated_length': 252.8, 'rewards/format_reward_func/mean': 0.375, 'rewards/format_reward_func/std': 0.21388519704341888, 'rewards/correctness_reward_func/mean': 0.575, 'rewards/correctness_reward_func/std': 0.5161634147167206, 'reward': 0.95, 'reward_std': 0.46299809217453003, 'frac_reward_zero_std': 0.05, 'kl': 0.011293898453004658, 'entropy': 1.2346844881772996, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.892714500194415, 'epoch': 0.44}
 92%|#########1| 55/60 [19:04<01:38, 19.73s/it] 93%|#########3| 56/60 [19:21<01:15, 18.87s/it] 95%|#########5| 57/60 [19:43<01:00, 20.01s/it] 97%|#########6| 58/60 [20:11<00:44, 22.20s/it] 98%|#########8| 59/60 [20:36<00:23, 23.06s/it]100%|##########| 60/60 [20:58<00:00, 22.64s/it]                                               {'loss': 0.0796, 'grad_norm': 1.4163237810134888, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 187601.0, 'completions/mean_length': 101.625, 'completions/min_length': 13.0, 'completions/max_length': 281.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 101.625, 'completions/min_terminated_length': 13.0, 'completions/max_terminated_length': 281.6, 'rewards/format_reward_func/mean': 0.38125, 'rewards/format_reward_func/std': 0.21493186950683593, 'rewards/correctness_reward_func/mean': 0.5875, 'rewards/correctness_reward_func/std': 0.5751901805400849, 'reward': 0.96875, 'reward_std': 0.5159409999847412, 'frac_reward_zero_std': 0.1, 'kl': 0.011018381477333606, 'entropy': 1.4499048292636871, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.29636527459952, 'epoch': 0.48}
100%|##########| 60/60 [20:58<00:00, 22.64s/it]                                               {'train_runtime': 1258.7525, 'train_samples_per_second': 0.763, 'train_steps_per_second': 0.048, 'train_loss': 0.0007538706064224243, 'epoch': 0.48}
100%|##########| 60/60 [20:58<00:00, 22.64s/it]100%|##########| 60/60 [20:58<00:00, 20.98s/it]
Accuracy on Task A (Math): 18.00%
Accuracy on Task B (Logic): 66.00%
>>> Method 4: EWC Lite COMPLETED SUCCESSFULLY.

====================
STARTING Method 5: Orthogonal
====================

=== METHOD 5: ORTHOGONAL LORA ===

>>> Training: m5_step1_math
Loading Base Model on mps...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:38<37:44, 38.39s/it]  3%|3         | 2/60 [01:13<35:01, 36.24s/it]  5%|5         | 3/60 [01:46<33:05, 34.84s/it]  7%|6         | 4/60 [02:06<26:58, 28.91s/it]  8%|8         | 5/60 [02:45<29:57, 32.69s/it]                                              {'loss': 0.0289, 'grad_norm': 0.4768938422203064, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 27249.0, 'completions/mean_length': 230.3625, 'completions/min_length': 105.6, 'completions/max_length': 448.4, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 222.88083190917968, 'completions/min_terminated_length': 105.6, 'completions/max_terminated_length': 383.2, 'rewards/format_reward_func/mean': 0.14375, 'rewards/format_reward_func/std': 0.23077536523342132, 'rewards/correctness_reward_func/mean': 0.6125, 'rewards/correctness_reward_func/std': 0.5903200745582581, 'reward': 0.75625, 'reward_std': 0.5884455442428589, 'frac_reward_zero_std': 0.2, 'kl': 0.0019012131611816584, 'entropy': 0.8820623442530632, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 32.453594266597065, 'epoch': 0.04}
  8%|8         | 5/60 [02:45<29:57, 32.69s/it] 10%|#         | 6/60 [03:22<30:46, 34.19s/it] 12%|#1        | 7/60 [03:48<27:47, 31.47s/it] 13%|#3        | 8/60 [04:05<23:18, 26.90s/it] 15%|#5        | 9/60 [04:27<21:26, 25.22s/it] 17%|#6        | 10/60 [04:51<20:44, 24.89s/it]                                               {'loss': 0.001, 'grad_norm': 0.6432439684867859, 'learning_rate': 1.7e-05, 'num_tokens': 52264.0, 'completions/mean_length': 210.0875, 'completions/min_length': 90.4, 'completions/max_length': 359.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 206.86083374023437, 'completions/min_terminated_length': 90.4, 'completions/max_terminated_length': 351.0, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.24146220088005066, 'rewards/correctness_reward_func/mean': 0.575, 'rewards/correctness_reward_func/std': 0.8413861274719239, 'reward': 0.7875, 'reward_std': 0.703703886270523, 'frac_reward_zero_std': 0.05, 'kl': 0.004048559768125415, 'entropy': 0.6514632374048233, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 24.598087908001617, 'epoch': 0.08}
 17%|#6        | 10/60 [04:51<20:44, 24.89s/it] 18%|#8        | 11/60 [05:22<21:58, 26.90s/it] 20%|##        | 12/60 [06:01<24:24, 30.52s/it] 22%|##1       | 13/60 [06:23<21:52, 27.93s/it] 23%|##3       | 14/60 [06:48<20:50, 27.19s/it] 25%|##5       | 15/60 [07:16<20:22, 27.16s/it]                                               {'loss': 0.0179, 'grad_norm': 0.4669951796531677, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 78418.0, 'completions/mean_length': 216.775, 'completions/min_length': 71.6, 'completions/max_length': 404.6, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 213.3625, 'completions/min_terminated_length': 71.6, 'completions/max_terminated_length': 391.6, 'rewards/format_reward_func/mean': 0.33125, 'rewards/format_reward_func/std': 0.2344973772764206, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.7306506037712097, 'reward': 0.83125, 'reward_std': 0.5926555573940278, 'frac_reward_zero_std': 0.1, 'kl': 0.0056313201785087585, 'entropy': 0.7535815745592117, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.382027724408545, 'epoch': 0.12}
 25%|##5       | 15/60 [07:16<20:22, 27.16s/it] 27%|##6       | 16/60 [07:39<19:07, 26.09s/it] 28%|##8       | 17/60 [07:57<17:00, 23.73s/it] 30%|###       | 18/60 [08:23<17:01, 24.32s/it] 32%|###1      | 19/60 [08:52<17:29, 25.61s/it] 33%|###3      | 20/60 [09:30<19:38, 29.45s/it]                                               {'loss': -0.0026, 'grad_norm': 0.7457836866378784, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 102667.0, 'completions/mean_length': 199.2125, 'completions/min_length': 97.8, 'completions/max_length': 371.8, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 195.4991668701172, 'completions/min_terminated_length': 97.8, 'completions/max_terminated_length': 366.4, 'rewards/format_reward_func/mean': 0.25625, 'rewards/format_reward_func/std': 0.230112624168396, 'rewards/correctness_reward_func/mean': 0.875, 'rewards/correctness_reward_func/std': 0.9082416892051697, 'reward': 1.13125, 'reward_std': 0.583815050125122, 'frac_reward_zero_std': 0.15, 'kl': 0.007304722804110497, 'entropy': 0.6435657642781735, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 26.35863090819621, 'epoch': 0.16}
 33%|###3      | 20/60 [09:30<19:38, 29.45s/it] 35%|###5      | 21/60 [09:52<17:39, 27.18s/it] 37%|###6      | 22/60 [10:19<17:05, 27.00s/it] 38%|###8      | 23/60 [10:38<15:12, 24.65s/it] 40%|####      | 24/60 [11:01<14:27, 24.11s/it] 42%|####1     | 25/60 [11:25<14:06, 24.19s/it]                                               {'loss': 0.0311, 'grad_norm': 0.5901844501495361, 'learning_rate': 1.2e-05, 'num_tokens': 127200.0, 'completions/mean_length': 198.0125, 'completions/min_length': 99.6, 'completions/max_length': 309.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 198.0125, 'completions/min_terminated_length': 99.6, 'completions/max_terminated_length': 309.2, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.20911651253700256, 'rewards/correctness_reward_func/mean': 0.9375, 'rewards/correctness_reward_func/std': 0.968743646144867, 'reward': 1.33125, 'reward_std': 0.6876294553279877, 'frac_reward_zero_std': 0.15, 'kl': 0.011443620407953858, 'entropy': 0.5939632132649422, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.45615881679405, 'epoch': 0.2}
 42%|####1     | 25/60 [11:25<14:06, 24.19s/it] 43%|####3     | 26/60 [11:48<13:29, 23.81s/it] 45%|####5     | 27/60 [12:26<15:24, 28.00s/it] 47%|####6     | 28/60 [13:04<16:31, 30.99s/it] 48%|####8     | 29/60 [13:25<14:29, 28.05s/it] 50%|#####     | 30/60 [13:47<13:07, 26.26s/it]                                               {'loss': 0.0753, 'grad_norm': 0.7063488960266113, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 150757.0, 'completions/mean_length': 196.9125, 'completions/min_length': 79.0, 'completions/max_length': 389.4, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 184.8335693359375, 'completions/min_terminated_length': 79.0, 'completions/max_terminated_length': 339.2, 'rewards/format_reward_func/mean': 0.375, 'rewards/format_reward_func/std': 0.21477908194065093, 'rewards/correctness_reward_func/mean': 0.75, 'rewards/correctness_reward_func/std': 0.9030812025070191, 'reward': 1.125, 'reward_std': 0.8870942115783691, 'frac_reward_zero_std': 0.05, 'kl': 0.010303359199315309, 'entropy': 0.6836769670248032, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 27.834763891808688, 'epoch': 0.24}
 50%|#####     | 30/60 [13:47<13:07, 26.26s/it] 52%|#####1    | 31/60 [14:25<14:27, 29.91s/it] 53%|#####3    | 32/60 [14:51<13:22, 28.65s/it] 55%|#####5    | 33/60 [15:13<11:56, 26.55s/it] 57%|#####6    | 34/60 [15:49<12:48, 29.57s/it] 58%|#####8    | 35/60 [16:13<11:33, 27.74s/it]                                               {'loss': -0.0389, 'grad_norm': 0.6086689233779907, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 176361.0, 'completions/mean_length': 209.9, 'completions/min_length': 60.6, 'completions/max_length': 388.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 209.9, 'completions/min_terminated_length': 60.6, 'completions/max_terminated_length': 388.2, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.2043670117855072, 'rewards/correctness_reward_func/mean': 0.625, 'rewards/correctness_reward_func/std': 0.8693748712539673, 'reward': 1.01875, 'reward_std': 0.6936810970306396, 'frac_reward_zero_std': 0.05, 'kl': 0.016041952837258577, 'entropy': 0.7481559753417969, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.586661483402715, 'epoch': 0.28}
 58%|#####8    | 35/60 [16:13<11:33, 27.74s/it] 60%|######    | 36/60 [16:34<10:15, 25.64s/it] 62%|######1   | 37/60 [17:03<10:15, 26.76s/it] 63%|######3   | 38/60 [17:31<09:59, 27.23s/it] 65%|######5   | 39/60 [17:55<09:07, 26.08s/it] 67%|######6   | 40/60 [18:36<10:10, 30.52s/it]                                               {'loss': 0.0575, 'grad_norm': 0.7045319676399231, 'learning_rate': 7e-06, 'num_tokens': 201141.0, 'completions/mean_length': 202.4, 'completions/min_length': 81.6, 'completions/max_length': 372.6, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 198.38999938964844, 'completions/min_terminated_length': 81.6, 'completions/max_terminated_length': 360.0, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.1952105075120926, 'rewards/correctness_reward_func/mean': 0.35, 'rewards/correctness_reward_func/std': 0.6145491600036621, 'reward': 0.75, 'reward_std': 0.5519232213497162, 'frac_reward_zero_std': 0.15, 'kl': 0.016907228995114564, 'entropy': 0.8190918952226639, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 27.960444366600132, 'epoch': 0.32}
 67%|######6   | 40/60 [18:36<10:10, 30.52s/it] 68%|######8   | 41/60 [19:04<09:27, 29.86s/it] 70%|#######   | 42/60 [19:31<08:42, 29.05s/it] 72%|#######1  | 43/60 [19:57<07:57, 28.06s/it] 73%|#######3  | 44/60 [20:33<08:08, 30.52s/it] 75%|#######5  | 45/60 [20:54<06:53, 27.58s/it]                                               {'loss': 0.0103, 'grad_norm': 0.5681961178779602, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 226919.0, 'completions/mean_length': 208.725, 'completions/min_length': 67.8, 'completions/max_length': 364.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 208.725, 'completions/min_terminated_length': 67.8, 'completions/max_terminated_length': 364.2, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.17534393966197967, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.8077821493148803, 'reward': 1.05, 'reward_std': 0.6575324296951294, 'frac_reward_zero_std': 0.15, 'kl': 0.01898029975127429, 'entropy': 0.658744902908802, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 27.080908592001652, 'epoch': 0.36}
 75%|#######5  | 45/60 [20:54<06:53, 27.58s/it] 77%|#######6  | 46/60 [21:11<05:44, 24.58s/it] 78%|#######8  | 47/60 [21:36<05:21, 24.74s/it] 80%|########  | 48/60 [22:01<04:54, 24.55s/it] 82%|########1 | 49/60 [22:39<05:16, 28.81s/it] 83%|########3 | 50/60 [22:56<04:13, 25.33s/it]                                               {'loss': -0.0129, 'grad_norm': 0.46904927492141724, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 249325.0, 'completions/mean_length': 183.625, 'completions/min_length': 82.2, 'completions/max_length': 329.8, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 179.5174987792969, 'completions/min_terminated_length': 82.2, 'completions/max_terminated_length': 282.2, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.19680694341659546, 'rewards/correctness_reward_func/mean': 0.675, 'rewards/correctness_reward_func/std': 0.8717926502227783, 'reward': 1.08125, 'reward_std': 0.8045524477958679, 'frac_reward_zero_std': 0.1, 'kl': 0.016913016419857742, 'entropy': 0.5997999370098114, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 24.027009600197196, 'epoch': 0.4}
 83%|########3 | 50/60 [22:57<04:13, 25.33s/it] 85%|########5 | 51/60 [23:18<03:37, 24.13s/it] 87%|########6 | 52/60 [23:52<03:37, 27.16s/it] 88%|########8 | 53/60 [24:18<03:08, 26.91s/it] 90%|######### | 54/60 [24:52<02:54, 29.00s/it] 92%|#########1| 55/60 [25:14<02:14, 26.90s/it]                                               {'loss': 0.0086, 'grad_norm': 0.5583219528198242, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 272617.0, 'completions/mean_length': 188.55, 'completions/min_length': 93.6, 'completions/max_length': 355.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 188.55, 'completions/min_terminated_length': 93.6, 'completions/max_terminated_length': 355.8, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.184032142162323, 'rewards/correctness_reward_func/mean': 0.975, 'rewards/correctness_reward_func/std': 0.8213309049606323, 'reward': 1.4125, 'reward_std': 0.5422720074653625, 'frac_reward_zero_std': 0.25, 'kl': 0.01970121734775603, 'entropy': 0.6679738342761994, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 26.980859749796217, 'epoch': 0.44}
 92%|#########1| 55/60 [25:14<02:14, 26.90s/it] 93%|#########3| 56/60 [25:57<02:06, 31.59s/it] 95%|#########5| 57/60 [26:24<01:30, 30.21s/it] 97%|#########6| 58/60 [26:52<00:59, 29.70s/it] 98%|#########8| 59/60 [27:18<00:28, 28.35s/it]100%|##########| 60/60 [27:45<00:00, 28.07s/it]                                               {'loss': -0.0739, 'grad_norm': 0.681930422782898, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 297384.0, 'completions/mean_length': 201.4875, 'completions/min_length': 78.6, 'completions/max_length': 384.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 201.4875, 'completions/min_terminated_length': 78.6, 'completions/max_terminated_length': 384.0, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.13662601709365846, 'rewards/correctness_reward_func/mean': 0.5625, 'rewards/correctness_reward_func/std': 0.8344023585319519, 'reward': 1.0125, 'reward_std': 0.6501492142677308, 'frac_reward_zero_std': 0.2, 'kl': 0.017046980769373478, 'entropy': 0.6814995914697647, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 29.55981615819328, 'epoch': 0.48}
100%|##########| 60/60 [27:45<00:00, 28.07s/it]                                               {'train_runtime': 1666.1675, 'train_samples_per_second': 0.576, 'train_steps_per_second': 0.036, 'train_loss': 0.008520352902511756, 'epoch': 0.48}
100%|##########| 60/60 [27:46<00:00, 28.07s/it]100%|##########| 60/60 [27:46<00:00, 27.77s/it]
>>> Merging A for Orthogonal Step 2...

>>> Training: m5_step2_logic
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/peft/tuners/tuners_utils.py:282: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:13<12:52, 13.10s/it]  3%|3         | 2/60 [00:24<11:44, 12.14s/it]  5%|5         | 3/60 [00:49<16:57, 17.85s/it]  7%|6         | 4/60 [01:03<15:28, 16.59s/it]  8%|8         | 5/60 [01:17<14:15, 15.55s/it]                                              {'loss': -0.0823, 'grad_norm': 0.704960286617279, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 13548.0, 'completions/mean_length': 81.7, 'completions/min_length': 12.2, 'completions/max_length': 236.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 81.7, 'completions/min_terminated_length': 12.2, 'completions/max_terminated_length': 236.0, 'rewards/format_reward_func/mean': 0.3625, 'rewards/format_reward_func/std': 0.22762537002563477, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.631046736240387, 'reward': 0.8625, 'reward_std': 0.5499807238578797, 'frac_reward_zero_std': 0.0, 'kl': 0.001985558064188808, 'entropy': 1.0612694710493087, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 15.10110457520641, 'epoch': 0.04}
  8%|8         | 5/60 [01:17<14:15, 15.55s/it] 10%|#         | 6/60 [01:34<14:32, 16.16s/it] 12%|#1        | 7/60 [01:48<13:38, 15.44s/it] 13%|#3        | 8/60 [01:59<11:58, 13.82s/it] 15%|#5        | 9/60 [02:16<12:44, 14.99s/it] 17%|#6        | 10/60 [02:28<11:36, 13.93s/it]                                               {'loss': 0.1699, 'grad_norm': 0.727073609828949, 'learning_rate': 1.7e-05, 'num_tokens': 28271.0, 'completions/mean_length': 95.5375, 'completions/min_length': 21.2, 'completions/max_length': 217.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 95.5375, 'completions/min_terminated_length': 21.2, 'completions/max_terminated_length': 217.4, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.11972136199474334, 'rewards/correctness_reward_func/mean': 0.7375, 'rewards/correctness_reward_func/std': 0.8187178850173951, 'reward': 1.19375, 'reward_std': 0.6274260222911835, 'frac_reward_zero_std': 0.2, 'kl': 0.010593603795859963, 'entropy': 1.0760287165641784, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.774670342405443, 'epoch': 0.08}
 17%|#6        | 10/60 [02:28<11:36, 13.93s/it] 18%|#8        | 11/60 [02:46<12:26, 15.24s/it] 20%|##        | 12/60 [02:58<11:28, 14.34s/it] 22%|##1       | 13/60 [03:15<11:43, 14.97s/it] 23%|##3       | 14/60 [03:26<10:41, 13.94s/it] 25%|##5       | 15/60 [03:57<14:17, 19.05s/it]                                               {'loss': 0.0164, 'grad_norm': 0.659654438495636, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 43165.0, 'completions/mean_length': 93.975, 'completions/min_length': 22.8, 'completions/max_length': 269.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 93.975, 'completions/min_terminated_length': 22.8, 'completions/max_terminated_length': 269.0, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.1494677931070328, 'rewards/correctness_reward_func/mean': 0.675, 'rewards/correctness_reward_func/std': 0.7970243334770203, 'reward': 1.125, 'reward_std': 0.6647965550422669, 'frac_reward_zero_std': 0.15, 'kl': 0.01814878508448601, 'entropy': 1.1171842336654663, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.413114441800282, 'epoch': 0.12}
 25%|##5       | 15/60 [03:57<14:17, 19.05s/it] 27%|##6       | 16/60 [04:11<12:53, 17.58s/it] 28%|##8       | 17/60 [04:31<12:58, 18.10s/it] 30%|###       | 18/60 [04:50<12:53, 18.43s/it] 32%|###1      | 19/60 [05:02<11:20, 16.60s/it] 33%|###3      | 20/60 [05:17<10:42, 16.05s/it]                                               {'loss': -0.0455, 'grad_norm': 0.6594324111938477, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 58091.0, 'completions/mean_length': 87.375, 'completions/min_length': 22.0, 'completions/max_length': 242.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 87.375, 'completions/min_terminated_length': 22.0, 'completions/max_terminated_length': 242.4, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.044721361994743344, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.8937062621116638, 'reward': 1.1125, 'reward_std': 0.638801771402359, 'frac_reward_zero_std': 0.3, 'kl': 0.026833834359422326, 'entropy': 0.9914562165737152, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 15.523978008006816, 'epoch': 0.16}
 33%|###3      | 20/60 [05:17<10:42, 16.05s/it] 35%|###5      | 21/60 [05:30<09:45, 15.02s/it] 37%|###6      | 22/60 [05:40<08:33, 13.52s/it] 38%|###8      | 23/60 [05:57<08:59, 14.57s/it] 40%|####      | 24/60 [06:07<07:56, 13.24s/it] 42%|####1     | 25/60 [06:17<07:15, 12.43s/it]                                               {'loss': 0.0529, 'grad_norm': 0.588016152381897, 'learning_rate': 1.2e-05, 'num_tokens': 71414.0, 'completions/mean_length': 77.7375, 'completions/min_length': 19.8, 'completions/max_length': 179.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 77.7375, 'completions/min_terminated_length': 19.8, 'completions/max_terminated_length': 179.2, 'rewards/format_reward_func/mean': 0.48125, 'rewards/format_reward_func/std': 0.075, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.9384888768196106, 'reward': 1.34375, 'reward_std': 0.8722683787345886, 'frac_reward_zero_std': 0.05, 'kl': 0.0316306580323726, 'entropy': 0.8494746804237365, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 11.72785315021174, 'epoch': 0.2}
 42%|####1     | 25/60 [06:17<07:15, 12.43s/it] 43%|####3     | 26/60 [06:28<06:40, 11.79s/it] 45%|####5     | 27/60 [06:42<06:57, 12.65s/it] 47%|####6     | 28/60 [06:52<06:13, 11.66s/it] 48%|####8     | 29/60 [07:08<06:42, 12.98s/it] 50%|#####     | 30/60 [07:20<06:21, 12.72s/it]                                               {'loss': 0.0402, 'grad_norm': 0.423804372549057, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 84634.0, 'completions/mean_length': 75.3, 'completions/min_length': 17.0, 'completions/max_length': 190.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 75.3, 'completions/min_terminated_length': 17.0, 'completions/max_terminated_length': 190.4, 'rewards/format_reward_func/mean': 0.49375, 'rewards/format_reward_func/std': 0.025, 'rewards/correctness_reward_func/mean': 0.775, 'rewards/correctness_reward_func/std': 0.8941296935081482, 'reward': 1.26875, 'reward_std': 0.6768440485000611, 'frac_reward_zero_std': 0.3, 'kl': 0.03411860181950033, 'entropy': 0.9793807744979859, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.13328814980341, 'epoch': 0.24}
 50%|#####     | 30/60 [07:20<06:21, 12.72s/it] 52%|#####1    | 31/60 [07:31<05:53, 12.19s/it] 53%|#####3    | 32/60 [07:43<05:40, 12.15s/it] 55%|#####5    | 33/60 [07:57<05:47, 12.88s/it] 57%|#####6    | 34/60 [08:08<05:14, 12.09s/it] 58%|#####8    | 35/60 [08:21<05:11, 12.46s/it]                                               {'loss': -0.0075, 'grad_norm': 0.6400520205497742, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 98601.0, 'completions/mean_length': 83.2875, 'completions/min_length': 16.6, 'completions/max_length': 185.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 83.2875, 'completions/min_terminated_length': 16.6, 'completions/max_terminated_length': 185.8, 'rewards/format_reward_func/mean': 0.46875, 'rewards/format_reward_func/std': 0.06972136199474335, 'rewards/correctness_reward_func/mean': 1.0125, 'rewards/correctness_reward_func/std': 0.9065960288047791, 'reward': 1.48125, 'reward_std': 0.8413082599639893, 'frac_reward_zero_std': 0.1, 'kl': 0.029902816750109196, 'entropy': 0.9628507316112518, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 11.884359825006687, 'epoch': 0.28}
 58%|#####8    | 35/60 [08:21<05:11, 12.46s/it] 60%|######    | 36/60 [08:29<04:25, 11.08s/it] 62%|######1   | 37/60 [08:38<04:01, 10.51s/it] 63%|######3   | 38/60 [08:53<04:19, 11.79s/it] 65%|######5   | 39/60 [09:08<04:27, 12.72s/it] 67%|######6   | 40/60 [09:17<03:51, 11.55s/it]                                               {'loss': -0.0498, 'grad_norm': 0.7782373428344727, 'learning_rate': 7e-06, 'num_tokens': 110901.0, 'completions/mean_length': 65.65, 'completions/min_length': 15.4, 'completions/max_length': 161.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 65.65, 'completions/min_terminated_length': 15.4, 'completions/max_terminated_length': 161.0, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.6875, 'rewards/correctness_reward_func/std': 0.8212146639823914, 'reward': 1.1625, 'reward_std': 0.7016226291656494, 'frac_reward_zero_std': 0.1, 'kl': 0.032929819589480755, 'entropy': 0.9042492389678956, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 10.78712273380079, 'epoch': 0.32}
 67%|######6   | 40/60 [09:17<03:51, 11.55s/it] 68%|######8   | 41/60 [09:30<03:47, 11.99s/it] 70%|#######   | 42/60 [09:41<03:34, 11.94s/it] 72%|#######1  | 43/60 [09:57<03:41, 13.06s/it] 73%|#######3  | 44/60 [10:08<03:20, 12.50s/it] 75%|#######5  | 45/60 [10:25<03:25, 13.68s/it]                                               {'loss': -0.0363, 'grad_norm': 0.7009000182151794, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 126027.0, 'completions/mean_length': 88.325, 'completions/min_length': 15.4, 'completions/max_length': 204.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 88.325, 'completions/min_terminated_length': 15.4, 'completions/max_terminated_length': 204.8, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.8489865064620972, 'reward': 1.1875, 'reward_std': 0.625741320848465, 'frac_reward_zero_std': 0.25, 'kl': 0.02900310796685517, 'entropy': 1.0073058664798737, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.247574566601543, 'epoch': 0.36}
 75%|#######5  | 45/60 [10:25<03:25, 13.68s/it] 77%|#######6  | 46/60 [10:46<03:41, 15.84s/it] 78%|#######8  | 47/60 [10:58<03:11, 14.71s/it] 80%|########  | 48/60 [11:16<03:10, 15.85s/it] 82%|########1 | 49/60 [11:30<02:48, 15.28s/it] 83%|########3 | 50/60 [11:47<02:37, 15.71s/it]                                               {'loss': 0.1614, 'grad_norm': 0.7399528622627258, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 141425.0, 'completions/mean_length': 92.075, 'completions/min_length': 15.6, 'completions/max_length': 251.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 92.075, 'completions/min_terminated_length': 15.6, 'completions/max_terminated_length': 251.2, 'rewards/format_reward_func/mean': 0.4875, 'rewards/format_reward_func/std': 0.05, 'rewards/correctness_reward_func/mean': 0.6, 'rewards/correctness_reward_func/std': 0.7834021806716919, 'reward': 1.0875, 'reward_std': 0.6727690935134888, 'frac_reward_zero_std': 0.25, 'kl': 0.03225680883042514, 'entropy': 1.131230780482292, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 15.99351190799498, 'epoch': 0.4}
 83%|########3 | 50/60 [11:47<02:37, 15.71s/it] 85%|########5 | 51/60 [12:06<02:31, 16.78s/it] 87%|########6 | 52/60 [12:18<02:02, 15.27s/it] 88%|########8 | 53/60 [12:31<01:42, 14.60s/it] 90%|######### | 54/60 [12:39<01:15, 12.63s/it] 92%|#########1| 55/60 [12:49<00:59, 11.93s/it]                                               {'loss': -0.0779, 'grad_norm': 0.7371008396148682, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 154234.0, 'completions/mean_length': 72.2125, 'completions/min_length': 15.2, 'completions/max_length': 185.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 72.2125, 'completions/min_terminated_length': 15.2, 'completions/max_terminated_length': 185.6, 'rewards/format_reward_func/mean': 0.4875, 'rewards/format_reward_func/std': 0.05, 'rewards/correctness_reward_func/mean': 0.875, 'rewards/correctness_reward_func/std': 0.9038735747337341, 'reward': 1.3625, 'reward_std': 0.8397603869438172, 'frac_reward_zero_std': 0.1, 'kl': 0.03802727228030563, 'entropy': 0.9109203606843949, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.131670100599877, 'epoch': 0.44}
 92%|#########1| 55/60 [12:49<00:59, 11.93s/it] 93%|#########3| 56/60 [13:06<00:53, 13.28s/it] 95%|#########5| 57/60 [13:20<00:41, 13.67s/it] 97%|#########6| 58/60 [13:33<00:27, 13.53s/it] 98%|#########8| 59/60 [13:46<00:13, 13.18s/it]100%|##########| 60/60 [13:59<00:00, 13.34s/it]                                               {'loss': 0.0825, 'grad_norm': 0.6604143381118774, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 168315.0, 'completions/mean_length': 80.4125, 'completions/min_length': 14.8, 'completions/max_length': 214.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 80.4125, 'completions/min_terminated_length': 14.8, 'completions/max_terminated_length': 214.6, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.06831300854682923, 'rewards/correctness_reward_func/mean': 0.7875, 'rewards/correctness_reward_func/std': 0.8336018681526184, 'reward': 1.2625, 'reward_std': 0.5846475124359131, 'frac_reward_zero_std': 0.35, 'kl': 0.03300733747892082, 'entropy': 1.0122078567743302, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.67152022459195, 'epoch': 0.48}
100%|##########| 60/60 [13:59<00:00, 13.34s/it]                                               {'train_runtime': 840.5686, 'train_samples_per_second': 1.142, 'train_steps_per_second': 0.071, 'train_loss': 0.0186651515463988, 'epoch': 0.48}
100%|##########| 60/60 [14:00<00:00, 13.34s/it]100%|##########| 60/60 [14:00<00:00, 14.01s/it]
Accuracy on Task A (Math): 22.00%
Accuracy on Task B (Logic): 66.00%
>>> Method 5: Orthogonal COMPLETED SUCCESSFULLY.

====================
STARTING Method 6: Ensemble
====================

=== METHOD 6: ENSEMBLE (ORACLE) ===

>>> Training: m6_indep_math
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:41<40:44, 41.43s/it]  3%|3         | 2/60 [01:23<40:33, 41.95s/it]  5%|5         | 3/60 [01:50<33:16, 35.03s/it]  7%|6         | 4/60 [02:09<26:45, 28.66s/it]  8%|8         | 5/60 [02:42<27:51, 30.38s/it]                                              {'loss': 0.0125, 'grad_norm': 0.7205731272697449, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 27006.0, 'completions/mean_length': 227.325, 'completions/min_length': 76.4, 'completions/max_length': 404.2, 'completions/clipped_ratio': 0.0625, 'completions/mean_terminated_length': 209.65412292480468, 'completions/min_terminated_length': 76.4, 'completions/max_terminated_length': 348.0, 'rewards/format_reward_func/mean': 0.15625, 'rewards/format_reward_func/std': 0.23413876593112945, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.7907753109931945, 'reward': 0.79375, 'reward_std': 0.5950500965118408, 'frac_reward_zero_std': 0.1, 'kl': 0.001778986069257371, 'entropy': 0.8802082255482674, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 32.037632466608194, 'epoch': 0.04}
  8%|8         | 5/60 [02:42<27:51, 30.38s/it] 10%|#         | 6/60 [03:18<29:02, 32.27s/it] 12%|#1        | 7/60 [03:47<27:23, 31.01s/it] 13%|#3        | 8/60 [04:16<26:18, 30.35s/it] 15%|#5        | 9/60 [04:41<24:30, 28.82s/it] 17%|#6        | 10/60 [05:07<23:14, 27.89s/it]                                               {'loss': 0.0038, 'grad_norm': 0.7360445261001587, 'learning_rate': 1.7e-05, 'num_tokens': 51696.0, 'completions/mean_length': 206.025, 'completions/min_length': 75.6, 'completions/max_length': 375.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 206.025, 'completions/min_terminated_length': 75.6, 'completions/max_terminated_length': 375.4, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.25238566994667055, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.8169429302215576, 'reward': 0.7375, 'reward_std': 0.7079315304756164, 'frac_reward_zero_std': 0.0, 'kl': 0.004561235883738845, 'entropy': 0.6777708187699318, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.401996250005322, 'epoch': 0.08}
 17%|#6        | 10/60 [05:07<23:14, 27.89s/it] 18%|#8        | 11/60 [05:44<25:03, 30.68s/it] 20%|##        | 12/60 [06:28<27:41, 34.61s/it] 22%|##1       | 13/60 [06:57<25:57, 33.14s/it] 23%|##3       | 14/60 [07:37<26:53, 35.08s/it] 25%|##5       | 15/60 [08:09<25:39, 34.21s/it]                                               {'loss': 0.0355, 'grad_norm': 0.5045266151428223, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 80011.0, 'completions/mean_length': 243.7875, 'completions/min_length': 88.0, 'completions/max_length': 446.4, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 238.125, 'completions/min_terminated_length': 88.0, 'completions/max_terminated_length': 439.0, 'rewards/format_reward_func/mean': 0.275, 'rewards/format_reward_func/std': 0.25074589252471924, 'rewards/correctness_reward_func/mean': 0.4375, 'rewards/correctness_reward_func/std': 0.7332215189933777, 'reward': 0.7125, 'reward_std': 0.5979347169399262, 'frac_reward_zero_std': 0.15, 'kl': 0.009054907143581658, 'entropy': 1.0140393495559692, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 35.87311166680301, 'epoch': 0.12}
 25%|##5       | 15/60 [08:09<25:39, 34.21s/it] 27%|##6       | 16/60 [08:50<26:34, 36.24s/it] 28%|##8       | 17/60 [09:31<26:55, 37.58s/it] 30%|###       | 18/60 [10:12<27:02, 38.63s/it] 32%|###1      | 19/60 [10:39<23:59, 35.11s/it] 33%|###3      | 20/60 [11:19<24:25, 36.65s/it]                                               {'loss': 0.042, 'grad_norm': 0.7339351773262024, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 107151.0, 'completions/mean_length': 235.35, 'completions/min_length': 84.8, 'completions/max_length': 470.8, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 224.09750061035157, 'completions/min_terminated_length': 84.8, 'completions/max_terminated_length': 384.4, 'rewards/format_reward_func/mean': 0.30625, 'rewards/format_reward_func/std': 0.2389538586139679, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.8748960256576538, 'reward': 0.95625, 'reward_std': 0.6929036378860474, 'frac_reward_zero_std': 0.05, 'kl': 0.013404644047841429, 'entropy': 0.872581185400486, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 37.39640819139313, 'epoch': 0.16}
 33%|###3      | 20/60 [11:19<24:25, 36.65s/it] 35%|###5      | 21/60 [11:52<23:06, 35.56s/it] 37%|###6      | 22/60 [12:16<20:16, 32.01s/it] 38%|###8      | 23/60 [12:43<18:54, 30.65s/it] 40%|####      | 24/60 [13:16<18:45, 31.26s/it] 42%|####1     | 25/60 [13:42<17:22, 29.79s/it]                                               {'loss': -0.0361, 'grad_norm': 0.6781320571899414, 'learning_rate': 1.2e-05, 'num_tokens': 133521.0, 'completions/mean_length': 220.975, 'completions/min_length': 113.0, 'completions/max_length': 348.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 220.975, 'completions/min_terminated_length': 113.0, 'completions/max_terminated_length': 348.4, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.2073718011379242, 'rewards/correctness_reward_func/mean': 0.775, 'rewards/correctness_reward_func/std': 0.9489079475402832, 'reward': 1.16875, 'reward_std': 0.8403115510940552, 'frac_reward_zero_std': 0.1, 'kl': 0.01769334776327014, 'entropy': 0.7995841801166534, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 28.14107900840172, 'epoch': 0.2}
 42%|####1     | 25/60 [13:42<17:22, 29.79s/it] 43%|####3     | 26/60 [14:16<17:34, 31.01s/it] 45%|####5     | 27/60 [14:51<17:41, 32.17s/it] 47%|####6     | 28/60 [15:22<17:01, 31.93s/it] 48%|####8     | 29/60 [15:49<15:39, 30.30s/it] 50%|#####     | 30/60 [16:20<15:13, 30.44s/it]                                               {'loss': 0.0259, 'grad_norm': 0.6396528482437134, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 158491.0, 'completions/mean_length': 214.575, 'completions/min_length': 89.2, 'completions/max_length': 392.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 214.575, 'completions/min_terminated_length': 89.2, 'completions/max_terminated_length': 392.8, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.20262537002563477, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.926913321018219, 'reward': 1.25625, 'reward_std': 0.8410307705402374, 'frac_reward_zero_std': 0.05, 'kl': 0.017241076100617647, 'entropy': 0.7573109328746795, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 30.92369450039696, 'epoch': 0.24}
 50%|#####     | 30/60 [16:20<15:13, 30.44s/it] 52%|#####1    | 31/60 [17:02<16:28, 34.09s/it] 53%|#####3    | 32/60 [17:44<17:00, 36.43s/it] 55%|#####5    | 33/60 [18:25<16:57, 37.70s/it] 57%|#####6    | 34/60 [19:07<16:53, 38.99s/it] 58%|#####8    | 35/60 [19:49<16:41, 40.05s/it]                                               {'loss': 0.0829, 'grad_norm': 0.6629019379615784, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 188300.0, 'completions/mean_length': 262.4625, 'completions/min_length': 91.8, 'completions/max_length': 512.0, 'completions/clipped_ratio': 0.1125, 'completions/mean_terminated_length': 232.40809936523436, 'completions/min_terminated_length': 91.8, 'completions/max_terminated_length': 428.6, 'rewards/format_reward_func/mean': 0.35625, 'rewards/format_reward_func/std': 0.23077536523342132, 'rewards/correctness_reward_func/mean': 0.725, 'rewards/correctness_reward_func/std': 0.911711573600769, 'reward': 1.08125, 'reward_std': 0.7194646954536438, 'frac_reward_zero_std': 0.1, 'kl': 0.020241344207897784, 'entropy': 1.067509551346302, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 41.289995458201155, 'epoch': 0.28}
 58%|#####8    | 35/60 [19:49<16:41, 40.05s/it] 60%|######    | 36/60 [20:25<15:29, 38.75s/it] 62%|######1   | 37/60 [21:07<15:14, 39.76s/it] 63%|######3   | 38/60 [21:49<14:47, 40.36s/it] 65%|######5   | 39/60 [22:24<13:36, 38.90s/it] 67%|######6   | 40/60 [23:10<13:36, 40.83s/it]                                               {'loss': 0.0611, 'grad_norm': 0.6721694469451904, 'learning_rate': 7e-06, 'num_tokens': 218293.0, 'completions/mean_length': 267.5625, 'completions/min_length': 93.2, 'completions/max_length': 484.4, 'completions/clipped_ratio': 0.05, 'completions/mean_terminated_length': 256.40607299804685, 'completions/min_terminated_length': 93.2, 'completions/max_terminated_length': 464.6, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.19680694341659546, 'rewards/correctness_reward_func/mean': 0.3625, 'rewards/correctness_reward_func/std': 0.6613142728805542, 'reward': 0.76875, 'reward_std': 0.6043181002140046, 'frac_reward_zero_std': 0.2, 'kl': 0.02213592892512679, 'entropy': 1.2195569545030593, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.4969326170045, 'epoch': 0.32}
 67%|######6   | 40/60 [23:10<13:36, 40.83s/it] 68%|######8   | 41/60 [23:51<12:57, 40.92s/it] 70%|#######   | 42/60 [24:31<12:14, 40.81s/it] 72%|#######1  | 43/60 [25:06<11:04, 39.11s/it] 73%|#######3  | 44/60 [25:47<10:33, 39.60s/it] 75%|#######5  | 45/60 [26:24<09:39, 38.63s/it]                                               {'loss': 0.0069, 'grad_norm': 0.6349403262138367, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 247370.0, 'completions/mean_length': 249.9625, 'completions/min_length': 115.6, 'completions/max_length': 468.0, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 243.33499755859376, 'completions/min_terminated_length': 115.6, 'completions/max_terminated_length': 427.4, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.15246951282024385, 'rewards/correctness_reward_func/mean': 0.6875, 'rewards/correctness_reward_func/std': 0.8672120094299316, 'reward': 1.1375, 'reward_std': 0.7290844857692719, 'frac_reward_zero_std': 0.15, 'kl': 0.03091249456629157, 'entropy': 0.8035079091787338, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 38.185787150004764, 'epoch': 0.36}
 75%|#######5  | 45/60 [26:24<09:39, 38.63s/it] 77%|#######6  | 46/60 [26:55<08:32, 36.59s/it] 78%|#######8  | 47/60 [27:35<08:07, 37.52s/it] 80%|########  | 48/60 [28:19<07:53, 39.43s/it] 82%|########1 | 49/60 [28:52<06:51, 37.42s/it] 83%|########3 | 50/60 [29:20<05:48, 34.81s/it]                                               {'loss': 0.0071, 'grad_norm': 0.6130396127700806, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 272406.0, 'completions/mean_length': 216.5, 'completions/min_length': 96.2, 'completions/max_length': 399.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 213.13250122070312, 'completions/min_terminated_length': 96.2, 'completions/max_terminated_length': 380.0, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.10562257766723633, 'rewards/correctness_reward_func/mean': 0.75, 'rewards/correctness_reward_func/std': 0.9016423702239991, 'reward': 1.20625, 'reward_std': 0.7817476630210877, 'frac_reward_zero_std': 0.1, 'kl': 0.02762110368348658, 'entropy': 0.8818802192807198, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 34.95680528340163, 'epoch': 0.4}
 83%|########3 | 50/60 [29:21<05:48, 34.81s/it] 85%|########5 | 51/60 [29:58<05:21, 35.72s/it] 87%|########6 | 52/60 [30:44<05:08, 38.62s/it] 88%|########8 | 53/60 [31:22<04:30, 38.67s/it] 90%|######### | 54/60 [32:05<03:59, 39.95s/it] 92%|#########1| 55/60 [32:42<03:14, 38.98s/it]                                               {'loss': 0.0522, 'grad_norm': 0.5736122727394104, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 299944.0, 'completions/mean_length': 241.625, 'completions/min_length': 116.8, 'completions/max_length': 471.0, 'completions/clipped_ratio': 0.0375, 'completions/mean_terminated_length': 230.31749877929687, 'completions/min_terminated_length': 116.8, 'completions/max_terminated_length': 423.2, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.18891051709651946, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.9283154964447021, 'reward': 1.275, 'reward_std': 0.7355756759643555, 'frac_reward_zero_std': 0.1, 'kl': 0.02801445033401251, 'entropy': 0.8554733961820602, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.74613310879795, 'epoch': 0.44}
 92%|#########1| 55/60 [32:42<03:14, 38.98s/it] 93%|#########3| 56/60 [33:27<02:43, 40.82s/it] 95%|#########5| 57/60 [34:03<01:58, 39.38s/it] 97%|#########6| 58/60 [34:41<01:17, 38.83s/it] 98%|#########8| 59/60 [35:24<00:40, 40.12s/it]100%|##########| 60/60 [36:03<00:00, 39.84s/it]                                               {'loss': -0.0301, 'grad_norm': 0.48767897486686707, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 328233.0, 'completions/mean_length': 245.5125, 'completions/min_length': 118.4, 'completions/max_length': 442.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 245.5125, 'completions/min_terminated_length': 118.4, 'completions/max_terminated_length': 442.4, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.1433130085468292, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.9061808824539185, 'reward': 1.16875, 'reward_std': 0.5530204951763154, 'frac_reward_zero_std': 0.25, 'kl': 0.0294767202809453, 'entropy': 0.8587960407137871, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 39.70763997520262, 'epoch': 0.48}
100%|##########| 60/60 [36:03<00:00, 39.84s/it]                                               {'train_runtime': 2164.8472, 'train_samples_per_second': 0.443, 'train_steps_per_second': 0.028, 'train_loss': 0.021983899424473444, 'epoch': 0.48}
100%|##########| 60/60 [36:04<00:00, 39.84s/it]100%|##########| 60/60 [36:04<00:00, 36.08s/it]

>>> Training: m6_indep_logic
Loading Base Model on mps...
>>> Attaching new LoRA adapter to dense model...
  0%|          | 0/60 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|1         | 1/60 [00:20<19:51, 20.19s/it]  3%|3         | 2/60 [00:33<15:48, 16.35s/it]  5%|5         | 3/60 [00:59<19:37, 20.65s/it]  7%|6         | 4/60 [01:17<18:05, 19.39s/it]  8%|8         | 5/60 [01:32<16:27, 17.96s/it]                                              {'loss': 0.0101, 'grad_norm': 1.2048015594482422, 'learning_rate': 1.866666666666667e-05, 'num_tokens': 14202.0, 'completions/mean_length': 89.875, 'completions/min_length': 12.6, 'completions/max_length': 234.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 89.875, 'completions/min_terminated_length': 12.6, 'completions/max_terminated_length': 234.6, 'rewards/format_reward_func/mean': 0.2125, 'rewards/format_reward_func/std': 0.24293359220027924, 'rewards/correctness_reward_func/mean': 0.375, 'rewards/correctness_reward_func/std': 0.4854445576667786, 'reward': 0.5875, 'reward_std': 0.3441216260194778, 'frac_reward_zero_std': 0.15, 'kl': 0.0036696528259199113, 'entropy': 1.1630759447813035, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 18.139737733188667, 'epoch': 0.04}
  8%|8         | 5/60 [01:32<16:27, 17.96s/it] 10%|#         | 6/60 [01:50<16:06, 17.90s/it] 12%|#1        | 7/60 [02:12<17:05, 19.35s/it] 13%|#3        | 8/60 [02:26<15:21, 17.72s/it] 15%|#5        | 9/60 [02:41<14:13, 16.73s/it] 17%|#6        | 10/60 [03:00<14:38, 17.56s/it]                                               {'loss': -0.0904, 'grad_norm': 1.6631624698638916, 'learning_rate': 1.7e-05, 'num_tokens': 28121.0, 'completions/mean_length': 85.4875, 'completions/min_length': 12.8, 'completions/max_length': 226.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 85.4875, 'completions/min_terminated_length': 12.8, 'completions/max_terminated_length': 226.2, 'rewards/format_reward_func/mean': 0.33125, 'rewards/format_reward_func/std': 0.2389538586139679, 'rewards/correctness_reward_func/mean': 0.4875, 'rewards/correctness_reward_func/std': 0.4770470380783081, 'reward': 0.81875, 'reward_std': 0.4527752161026001, 'frac_reward_zero_std': 0.0, 'kl': 0.017083421675488354, 'entropy': 1.1343500912189484, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.3239308660035, 'epoch': 0.08}
 17%|#6        | 10/60 [03:00<14:38, 17.56s/it] 18%|#8        | 11/60 [03:40<19:59, 24.48s/it] 20%|##        | 12/60 [03:50<15:54, 19.89s/it] 22%|##1       | 13/60 [04:25<19:14, 24.56s/it] 23%|##3       | 14/60 [04:40<16:34, 21.62s/it] 25%|##5       | 15/60 [05:02<16:15, 21.67s/it]                                               {'loss': 0.0866, 'grad_norm': 1.2750109434127808, 'learning_rate': 1.5333333333333334e-05, 'num_tokens': 41769.0, 'completions/mean_length': 78.4, 'completions/min_length': 15.2, 'completions/max_length': 305.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 78.4, 'completions/min_terminated_length': 15.2, 'completions/max_terminated_length': 305.4, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.20422180593013764, 'rewards/correctness_reward_func/mean': 0.5125, 'rewards/correctness_reward_func/std': 0.4939549446105957, 'reward': 0.9125, 'reward_std': 0.46092681884765624, 'frac_reward_zero_std': 0.05, 'kl': 0.031225374457426368, 'entropy': 1.257548514008522, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 23.880021708604183, 'epoch': 0.12}
 25%|##5       | 15/60 [05:02<16:15, 21.67s/it] 27%|##6       | 16/60 [05:27<16:35, 22.62s/it] 28%|##8       | 17/60 [05:49<16:03, 22.41s/it] 30%|###       | 18/60 [06:04<14:09, 20.23s/it] 32%|###1      | 19/60 [06:23<13:37, 19.94s/it] 33%|###3      | 20/60 [07:03<17:23, 26.09s/it]                                               {'loss': 0.1901, 'grad_norm': 1.0071810483932495, 'learning_rate': 1.3666666666666667e-05, 'num_tokens': 57880.0, 'completions/mean_length': 102.1875, 'completions/min_length': 18.8, 'completions/max_length': 309.4, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 97.35083312988282, 'completions/min_terminated_length': 18.8, 'completions/max_terminated_length': 254.4, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.202961727976799, 'rewards/correctness_reward_func/mean': 0.375, 'rewards/correctness_reward_func/std': 0.5142955720424652, 'reward': 0.775, 'reward_std': 0.45111349821090696, 'frac_reward_zero_std': 0.25, 'kl': 0.024920726008713246, 'entropy': 1.1920863151550294, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 23.87361627500213, 'epoch': 0.16}
 33%|###3      | 20/60 [07:03<17:23, 26.09s/it] 35%|###5      | 21/60 [07:17<14:27, 22.25s/it] 37%|###6      | 22/60 [07:31<12:40, 20.01s/it] 38%|###8      | 23/60 [07:44<11:00, 17.85s/it] 40%|####      | 24/60 [08:06<11:19, 18.88s/it] 42%|####1     | 25/60 [08:17<09:41, 16.60s/it]                                               {'loss': 0.0455, 'grad_norm': 1.8867968320846558, 'learning_rate': 1.2e-05, 'num_tokens': 69469.0, 'completions/mean_length': 56.0625, 'completions/min_length': 19.0, 'completions/max_length': 181.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 56.0625, 'completions/min_terminated_length': 19.0, 'completions/max_terminated_length': 181.0, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.11831300854682922, 'rewards/correctness_reward_func/mean': 0.55, 'rewards/correctness_reward_func/std': 0.5080508947372436, 'reward': 1.025, 'reward_std': 0.3673589289188385, 'frac_reward_zero_std': 0.3, 'kl': 0.04431482404470444, 'entropy': 0.9833300992846489, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.384520283795428, 'epoch': 0.2}
 42%|####1     | 25/60 [08:17<09:41, 16.60s/it] 43%|####3     | 26/60 [08:39<10:25, 18.38s/it] 45%|####5     | 27/60 [08:52<09:06, 16.55s/it] 47%|####6     | 28/60 [09:04<08:05, 15.17s/it] 48%|####8     | 29/60 [09:10<06:32, 12.66s/it] 50%|#####     | 30/60 [09:20<05:48, 11.61s/it]                                               {'loss': -0.0514, 'grad_norm': 2.6661887168884277, 'learning_rate': 1.0333333333333335e-05, 'num_tokens': 80336.0, 'completions/mean_length': 45.8875, 'completions/min_length': 16.0, 'completions/max_length': 147.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 45.8875, 'completions/min_terminated_length': 16.0, 'completions/max_terminated_length': 147.4, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.19206051230430604, 'rewards/correctness_reward_func/mean': 0.575, 'rewards/correctness_reward_func/std': 0.466357547044754, 'reward': 0.98125, 'reward_std': 0.30644230246543885, 'frac_reward_zero_std': 0.3, 'kl': 0.05623802673071623, 'entropy': 0.8997589275240898, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 12.258653158208471, 'epoch': 0.24}
 50%|#####     | 30/60 [09:20<05:48, 11.61s/it] 52%|#####1    | 31/60 [09:36<06:21, 13.17s/it] 53%|#####3    | 32/60 [09:51<06:23, 13.70s/it] 55%|#####5    | 33/60 [10:10<06:53, 15.32s/it] 57%|#####6    | 34/60 [10:26<06:43, 15.51s/it] 58%|#####8    | 35/60 [10:40<06:13, 14.93s/it]                                               {'loss': 0.0434, 'grad_norm': 1.1737215518951416, 'learning_rate': 8.666666666666668e-06, 'num_tokens': 93142.0, 'completions/mean_length': 68.775, 'completions/min_length': 21.4, 'completions/max_length': 202.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 68.775, 'completions/min_terminated_length': 21.4, 'completions/max_terminated_length': 202.0, 'rewards/format_reward_func/mean': 0.44375, 'rewards/format_reward_func/std': 0.13977908194065095, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.5153132677078247, 'reward': 0.96875, 'reward_std': 0.32451180219650266, 'frac_reward_zero_std': 0.35, 'kl': 0.0338642546441406, 'entropy': 1.0595213651657105, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 15.748701958204038, 'epoch': 0.28}
 58%|#####8    | 35/60 [10:40<06:13, 14.93s/it] 60%|######    | 36/60 [10:47<04:58, 12.43s/it] 62%|######1   | 37/60 [11:10<06:02, 15.74s/it] 63%|######3   | 38/60 [11:25<05:44, 15.65s/it] 65%|######5   | 39/60 [11:54<06:47, 19.39s/it] 67%|######6   | 40/60 [12:07<05:54, 17.73s/it]                                               {'loss': -0.0838, 'grad_norm': 1.2358317375183105, 'learning_rate': 7e-06, 'num_tokens': 105615.0, 'completions/mean_length': 67.8125, 'completions/min_length': 20.8, 'completions/max_length': 216.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 67.8125, 'completions/min_terminated_length': 20.8, 'completions/max_terminated_length': 216.8, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.09946779310703277, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.4627369403839111, 'reward': 1.1125, 'reward_std': 0.38621277213096616, 'frac_reward_zero_std': 0.25, 'kl': 0.04220401719212532, 'entropy': 0.996608453989029, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 17.14435105919547, 'epoch': 0.32}
 67%|######6   | 40/60 [12:07<05:54, 17.73s/it] 68%|######8   | 41/60 [12:28<05:52, 18.54s/it] 70%|#######   | 42/60 [12:56<06:25, 21.43s/it] 72%|#######1  | 43/60 [13:15<05:53, 20.77s/it] 73%|#######3  | 44/60 [13:26<04:43, 17.72s/it] 75%|#######5  | 45/60 [13:48<04:45, 19.02s/it]                                               {'loss': 0.1319, 'grad_norm': 1.1826684474945068, 'learning_rate': 5.333333333333334e-06, 'num_tokens': 119764.0, 'completions/mean_length': 76.1125, 'completions/min_length': 19.2, 'completions/max_length': 252.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 76.1125, 'completions/min_terminated_length': 19.2, 'completions/max_terminated_length': 252.4, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.10862429738044739, 'rewards/correctness_reward_func/mean': 0.425, 'rewards/correctness_reward_func/std': 0.5031512618064881, 'reward': 0.88125, 'reward_std': 0.47410252690315247, 'frac_reward_zero_std': 0.1, 'kl': 0.03338031647726893, 'entropy': 1.093638327717781, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 19.70407140000316, 'epoch': 0.36}
 75%|#######5  | 45/60 [13:48<04:45, 19.02s/it] 77%|#######6  | 46/60 [14:07<04:26, 19.05s/it] 78%|#######8  | 47/60 [14:22<03:51, 17.81s/it] 80%|########  | 48/60 [14:34<03:12, 16.06s/it] 82%|########1 | 49/60 [14:45<02:40, 14.62s/it] 83%|########3 | 50/60 [14:59<02:23, 14.32s/it]                                               {'loss': 0.0512, 'grad_norm': 1.0878783464431763, 'learning_rate': 3.6666666666666666e-06, 'num_tokens': 133232.0, 'completions/mean_length': 67.95, 'completions/min_length': 17.6, 'completions/max_length': 170.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 67.95, 'completions/min_terminated_length': 17.6, 'completions/max_terminated_length': 170.8, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.11531128883361816, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.4758143723011017, 'reward': 0.9875, 'reward_std': 0.4169958531856537, 'frac_reward_zero_std': 0.25, 'kl': 0.036847513634711504, 'entropy': 0.9664400070905685, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.869319766998524, 'epoch': 0.4}
 83%|########3 | 50/60 [14:59<02:23, 14.32s/it] 85%|########5 | 51/60 [15:12<02:07, 14.12s/it] 87%|########6 | 52/60 [15:32<02:05, 15.64s/it] 88%|########8 | 53/60 [15:45<01:44, 14.93s/it] 90%|######### | 54/60 [15:59<01:27, 14.53s/it] 92%|#########1| 55/60 [16:11<01:09, 13.83s/it]                                               {'loss': 0.1852, 'grad_norm': 1.354972243309021, 'learning_rate': 2.0000000000000003e-06, 'num_tokens': 144347.0, 'completions/mean_length': 51.0375, 'completions/min_length': 20.8, 'completions/max_length': 176.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 51.0375, 'completions/min_terminated_length': 20.8, 'completions/max_terminated_length': 176.8, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.44924116134643555, 'reward': 0.975, 'reward_std': 0.27369458973407745, 'frac_reward_zero_std': 0.45, 'kl': 0.04695229730568826, 'entropy': 0.9184969812631607, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.073564616593648, 'epoch': 0.44}
 92%|#########1| 55/60 [16:11<01:09, 13.83s/it] 93%|#########3| 56/60 [16:27<00:58, 14.52s/it] 95%|#########5| 57/60 [16:35<00:38, 12.74s/it] 97%|#########6| 58/60 [16:51<00:27, 13.63s/it] 98%|#########8| 59/60 [17:12<00:15, 15.76s/it]100%|##########| 60/60 [17:25<00:00, 15.11s/it]                                               {'loss': 0.0408, 'grad_norm': 1.4887140989303589, 'learning_rate': 3.3333333333333335e-07, 'num_tokens': 156591.0, 'completions/mean_length': 57.45, 'completions/min_length': 16.8, 'completions/max_length': 180.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 57.45, 'completions/min_terminated_length': 16.8, 'completions/max_terminated_length': 180.0, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.12887786626815795, 'rewards/correctness_reward_func/mean': 0.5125, 'rewards/correctness_reward_func/std': 0.5277891397476197, 'reward': 0.9625, 'reward_std': 0.4567859351634979, 'frac_reward_zero_std': 0.15, 'kl': 0.047705307975411414, 'entropy': 0.9324046432971954, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 14.642436149786226, 'epoch': 0.48}
100%|##########| 60/60 [17:25<00:00, 15.11s/it]                                               {'train_runtime': 1046.7796, 'train_samples_per_second': 0.917, 'train_steps_per_second': 0.057, 'train_loss': 0.04658882642785708, 'epoch': 0.48}
100%|##########| 60/60 [17:26<00:00, 15.11s/it]100%|##########| 60/60 [17:26<00:00, 17.45s/it]
Loading Base Model on mps...
Accuracy on Task A (Math): 18.00%
Accuracy on Task B (Logic): 70.00%
>>> Method 6: Ensemble COMPLETED SUCCESSFULLY.

==================================================
FINAL RESEARCH RESULTS SUMMARY
==================================================
Method               | Math (Old)   | Logic (New) 
--------------------------------------------------
Baseline             | 20.00%            | 68.00%
Replay               | 26.00%            | 76.00%
TaskArithmetic       | 20.00%            | 78.00%
EWC_Lite             | 18.00%            | 66.00%
Orthogonal           | 22.00%            | 66.00%
Ensemble             | 18.00%            | 70.00%
--------------------------------------------------
