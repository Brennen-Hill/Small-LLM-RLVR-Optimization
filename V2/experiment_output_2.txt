Experiment Starting...
Loading Datasets...
Map:   0%|          | 0/7473 [00:00<?, ? examples/s]Map:  35%|###5      | 2639/7473 [00:00<00:00, 26274.70 examples/s]Map:  74%|#######3  | 5525/7473 [00:00<00:00, 27787.83 examples/s]Map: 100%|##########| 7473/7473 [00:00<00:00, 26967.25 examples/s]
babi_train.jsonl: 0.00B [00:00, ?B/s]babi_train.jsonl: 208kB [00:00, 1.73MB/s]babi_train.jsonl: 434kB [00:00, 1.82MB/s]babi_train.jsonl: 670kB [00:00, 1.81MB/s]babi_train.jsonl: 1.01MB [00:00, 2.00MB/s]babi_train.jsonl: 1.22MB [00:00, 1.84MB/s]babi_train.jsonl: 1.51MB [00:00, 1.67MB/s]babi_train.jsonl: 1.73MB [00:01, 1.46MB/s]babi_train.jsonl: 1.96MB [00:01, 1.63MB/s]babi_train.jsonl: 2.17MB [00:01, 1.51MB/s]babi_train.jsonl: 2.42MB [00:01, 1.52MB/s]babi_train.jsonl: 2.62MB [00:01, 1.53MB/s]babi_train.jsonl: 2.83MB [00:01, 1.52MB/s]babi_train.jsonl: 3.10MB [00:01, 1.60MB/s]babi_train.jsonl: 3.32MB [00:02, 1.55MB/s]babi_train.jsonl: 3.51MB [00:02, 1.45MB/s]babi_train.jsonl: 3.68MB [00:02, 1.46MB/s]babi_train.jsonl: 3.83MB [00:02, 1.35MB/s]babi_train.jsonl: 4.01MB [00:02, 1.38MB/s]babi_train.jsonl: 4.17MB [00:02, 1.19MB/s]babi_train.jsonl: 4.36MB [00:02, 1.21MB/s]babi_train.jsonl: 4.51MB [00:03, 1.04MB/s]babi_train.jsonl: 4.69MB [00:03, 1.13MB/s]babi_train.jsonl: 4.81MB [00:03, 1.13MB/s]babi_train.jsonl: 5.25MB [00:03, 1.30MB/s]babi_train.jsonl: 5.49MB [00:03, 1.45MB/s]babi_train.jsonl: 5.73MB [00:03, 1.52MB/s]babi_train.jsonl: 5.91MB [00:04, 1.46MB/s]babi_train.jsonl: 6.12MB [00:04, 1.52MB/s]babi_train.jsonl: 6.55MB [00:04, 1.56MB/s]babi_train.jsonl: 6.71MB [00:04, 1.36MB/s]babi_train.jsonl: 6.88MB [00:04, 1.32MB/s]babi_train.jsonl: 7.00MB [00:04, 1.40MB/s]
babi_valid.jsonl: 0.00B [00:00, ?B/s]babi_valid.jsonl: 208kB [00:00, 1.40MB/s]babi_valid.jsonl: 483kB [00:00, 1.77MB/s]babi_valid.jsonl: 721kB [00:00, 1.92MB/s]babi_valid.jsonl: 770kB [00:00, 1.65MB/s]
babi_test.jsonl: 0.00B [00:00, ?B/s]babi_test.jsonl: 156kB [00:00, 1.43MB/s]babi_test.jsonl: 315kB [00:00, 1.06MB/s]babi_test.jsonl: 623kB [00:00, 1.61MB/s]babi_test.jsonl: 894kB [00:00, 1.33MB/s]babi_test.jsonl: 1.13MB [00:00, 1.51MB/s]babi_test.jsonl: 1.29MB [00:00, 1.54MB/s]babi_test.jsonl: 1.51MB [00:05, 136kB/s] babi_test.jsonl: 1.73MB [00:05, 196kB/s]babi_test.jsonl: 1.98MB [00:05, 285kB/s]babi_test.jsonl: 2.34MB [00:05, 456kB/s]babi_test.jsonl: 2.80MB [00:06, 670kB/s]babi_test.jsonl: 3.00MB [00:06, 740kB/s]babi_test.jsonl: 3.18MB [00:06, 835kB/s]babi_test.jsonl: 3.38MB [00:06, 967kB/s]babi_test.jsonl: 3.71MB [00:06, 1.14MB/s]babi_test.jsonl: 3.93MB [00:06, 1.28MB/s]babi_test.jsonl: 4.16MB [00:06, 1.35MB/s]babi_test.jsonl: 4.42MB [00:06, 1.56MB/s]babi_test.jsonl: 4.65MB [00:07, 1.62MB/s]babi_test.jsonl: 5.00MB [00:07, 1.49MB/s]babi_test.jsonl: 5.52MB [00:07, 1.53MB/s]babi_test.jsonl: 5.73MB [00:07, 1.29MB/s]babi_test.jsonl: 6.07MB [00:08, 1.49MB/s]babi_test.jsonl: 6.28MB [00:08, 1.48MB/s]babi_test.jsonl: 6.58MB [00:08, 1.58MB/s]babi_test.jsonl: 6.87MB [00:08, 1.56MB/s]babi_test.jsonl: 7.21MB [00:08, 1.83MB/s]babi_test.jsonl: 7.53MB [00:09, 1.53MB/s]babi_test.jsonl: 7.79MB [00:09, 1.55MB/s]babi_test.jsonl: 7.79MB [00:09, 849kB/s] 
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 18013 examples [00:00, 789087.77 examples/s]
Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 1987 examples [00:00, 356416.29 examples/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 20000 examples [00:00, 1510018.90 examples/s]
Filter:   0%|          | 0/18013 [00:00<?, ? examples/s]Filter: 100%|##########| 18013/18013 [00:00<00:00, 386718.32 examples/s]
Map:   0%|          | 0/900 [00:00<?, ? examples/s]Map: 100%|##########| 900/900 [00:00<00:00, 15498.74 examples/s]

========================================
PHASE 1: BASELINE
========================================
Loading Base Model on mps...

--- Evaluating Model on Dataset A (Math) (50 samples) ---
Sample Output:  
1. First, we need to determine how many clips Natalia sold in May.
2. We know that Natalia sold half as many clips in May as she did in April.
3. Na...
Accuracy on Dataset A (Math): 50.00%

--- Evaluating Model on Dataset B (Logic) (50 samples) ---
Sample Output:  
1. The context states that "Mary moved to the bathroom."
2. This implies that Mary is currently in a bathroom.
3. Therefore, we can conclude that Ma...
Accuracy on Dataset B (Logic): 72.00%

========================================
PHASE 2: SEQUENCE A -> B
========================================
>>> Step 2a: Finetuning on Dataset A (Math)

>>> Starting Run: phase2_step1_math
Loading Base Model on mps...
  0%|          | 0/50 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|2         | 1/50 [00:54<44:38, 54.66s/it]  4%|4         | 2/50 [01:46<42:30, 53.13s/it]  6%|6         | 3/50 [02:32<38:54, 49.68s/it]  8%|8         | 4/50 [03:20<37:40, 49.13s/it] 10%|#         | 5/50 [04:46<46:45, 62.34s/it]                                              {'loss': 0.0337, 'grad_norm': 0.6908472180366516, 'learning_rate': 1.8400000000000003e-05, 'num_tokens': 26761.0, 'completions/mean_length': 227.9125, 'completions/min_length': 55.8, 'completions/max_length': 446.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 227.9125, 'completions/min_terminated_length': 55.8, 'completions/max_terminated_length': 446.8, 'rewards/format_reward_func/mean': 0.23125, 'rewards/format_reward_func/std': 0.25198065042495726, 'rewards/correctness_reward_func/mean': 0.6125, 'rewards/correctness_reward_func/std': 0.846562671661377, 'reward': 0.84375, 'reward_std': 0.8139195799827575, 'frac_reward_zero_std': 0.0, 'kl': 0.00193829441559501, 'entropy': 0.8509978368878365, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 56.407050316194365, 'epoch': 0.0}
 10%|#         | 5/50 [04:46<46:45, 62.34s/it] 12%|#2        | 6/50 [05:42<44:05, 60.13s/it] 14%|#4        | 7/50 [06:28<39:54, 55.68s/it] 16%|#6        | 8/50 [07:29<40:11, 57.42s/it] 18%|#8        | 9/50 [08:18<37:22, 54.70s/it] 20%|##        | 10/50 [08:49<31:37, 47.43s/it]                                               {'loss': 0.0499, 'grad_norm': 0.6704838871955872, 'learning_rate': 1.64e-05, 'num_tokens': 51988.0, 'completions/mean_length': 216.7375, 'completions/min_length': 75.8, 'completions/max_length': 437.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 216.7375, 'completions/min_terminated_length': 75.8, 'completions/max_terminated_length': 437.4, 'rewards/format_reward_func/mean': 0.30625, 'rewards/format_reward_func/std': 0.23413876593112945, 'rewards/correctness_reward_func/mean': 0.6, 'rewards/correctness_reward_func/std': 0.8730596780776978, 'reward': 0.90625, 'reward_std': 0.7089439034461975, 'frac_reward_zero_std': 0.05, 'kl': 0.005753982125315815, 'entropy': 0.8296605631709099, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 47.87154159999918, 'epoch': 0.01}
 20%|##        | 10/50 [08:49<31:37, 47.43s/it] 22%|##2       | 11/50 [10:05<36:23, 56.00s/it] 24%|##4       | 12/50 [12:08<48:29, 76.57s/it] 26%|##6       | 13/50 [13:12<44:54, 72.82s/it] 28%|##8       | 14/50 [14:20<42:42, 71.18s/it] 30%|###       | 15/50 [15:13<38:25, 65.87s/it]                                               {'loss': 0.0373, 'grad_norm': 0.6538989543914795, 'learning_rate': 1.4400000000000001e-05, 'num_tokens': 80869.0, 'completions/mean_length': 263.1625, 'completions/min_length': 66.6, 'completions/max_length': 610.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 263.1625, 'completions/min_terminated_length': 66.6, 'completions/max_terminated_length': 610.6, 'rewards/format_reward_func/mean': 0.38125, 'rewards/format_reward_func/std': 0.21493186950683593, 'rewards/correctness_reward_func/mean': 0.8125, 'rewards/correctness_reward_func/std': 0.7585510849952698, 'reward': 1.19375, 'reward_std': 0.780818772315979, 'frac_reward_zero_std': 0.0, 'kl': 0.009782606363296508, 'entropy': 0.8869637191295624, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 75.67771502519754, 'epoch': 0.01}
 30%|###       | 15/50 [15:13<38:25, 65.87s/it] 32%|###2      | 16/50 [16:17<36:58, 65.26s/it] 34%|###4      | 17/50 [17:44<39:22, 71.60s/it] 36%|###6      | 18/50 [18:23<32:56, 61.78s/it] 38%|###8      | 19/50 [19:02<28:28, 55.10s/it] 40%|####      | 20/50 [19:43<25:24, 50.82s/it]                                               {'loss': 0.0476, 'grad_norm': 0.9917558431625366, 'learning_rate': 1.2400000000000002e-05, 'num_tokens': 107503.0, 'completions/mean_length': 220.125, 'completions/min_length': 76.6, 'completions/max_length': 452.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 220.125, 'completions/min_terminated_length': 76.6, 'completions/max_terminated_length': 452.0, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.19065522849559785, 'rewards/correctness_reward_func/mean': 0.675, 'rewards/correctness_reward_func/std': 0.8275335192680359, 'reward': 1.0875, 'reward_std': 0.6740464091300964, 'frac_reward_zero_std': 0.1, 'kl': 0.02493815969210118, 'entropy': 0.9117977112531662, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 53.01687771680154, 'epoch': 0.01}
 40%|####      | 20/50 [19:43<25:24, 50.82s/it] 42%|####2     | 21/50 [20:23<23:03, 47.70s/it] 44%|####4     | 22/50 [21:35<25:35, 54.84s/it] 46%|####6     | 23/50 [22:35<25:25, 56.51s/it] 48%|####8     | 24/50 [25:43<41:29, 95.77s/it] 50%|#####     | 25/50 [27:18<39:52, 95.72s/it]                                               {'loss': 0.1051, 'grad_norm': 0.7150136828422546, 'learning_rate': 1.04e-05, 'num_tokens': 134626.0, 'completions/mean_length': 233.7375, 'completions/min_length': 72.8, 'completions/max_length': 612.2, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 223.76166687011718, 'completions/min_terminated_length': 72.8, 'completions/max_terminated_length': 539.4, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.18891051709651946, 'rewards/correctness_reward_func/mean': 0.6, 'rewards/correctness_reward_func/std': 0.8195385575294495, 'reward': 1.0125, 'reward_std': 0.6561046957969665, 'frac_reward_zero_std': 0.1, 'kl': 0.0910898978356272, 'entropy': 1.224038365483284, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 90.21816359159857, 'epoch': 0.01}
 50%|#####     | 25/50 [27:18<39:52, 95.72s/it] 52%|#####2    | 26/50 [28:18<33:55, 84.81s/it] 54%|#####4    | 27/50 [29:03<28:01, 73.11s/it] 56%|#####6    | 28/50 [30:20<27:12, 74.21s/it] 58%|#####8    | 29/50 [31:14<23:47, 67.98s/it] 60%|######    | 30/50 [32:05<20:57, 62.90s/it]                                               {'loss': 0.1112, 'grad_norm': 1.327979326248169, 'learning_rate': 8.400000000000001e-06, 'num_tokens': 163829.0, 'completions/mean_length': 249.5875, 'completions/min_length': 92.0, 'completions/max_length': 452.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 249.5875, 'completions/min_terminated_length': 92.0, 'completions/max_terminated_length': 452.4, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.1336242973804474, 'rewards/correctness_reward_func/mean': 0.475, 'rewards/correctness_reward_func/std': 0.7063157558441162, 'reward': 0.925, 'reward_std': 0.559322452545166, 'frac_reward_zero_std': 0.2, 'kl': 0.03589114332571626, 'entropy': 1.166670036315918, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 56.30902605059964, 'epoch': 0.02}
 60%|######    | 30/50 [32:05<20:57, 62.90s/it] 62%|######2   | 31/50 [33:55<24:23, 77.03s/it] 64%|######4   | 32/50 [34:43<20:29, 68.30s/it] 66%|######6   | 33/50 [35:30<17:32, 61.94s/it] 68%|######8   | 34/50 [37:05<19:12, 72.06s/it] 70%|#######   | 35/50 [38:20<18:13, 72.91s/it]                                               {'loss': 0.0043, 'grad_norm': 0.7387945055961609, 'learning_rate': 6.4000000000000006e-06, 'num_tokens': 189324.0, 'completions/mean_length': 214.9875, 'completions/min_length': 84.4, 'completions/max_length': 527.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 214.9875, 'completions/min_terminated_length': 84.4, 'completions/max_terminated_length': 527.8, 'rewards/format_reward_func/mean': 0.43125, 'rewards/format_reward_func/std': 0.17393558621406555, 'rewards/correctness_reward_func/mean': 0.525, 'rewards/correctness_reward_func/std': 0.8326179623603821, 'reward': 0.95625, 'reward_std': 0.6554141640663147, 'frac_reward_zero_std': 0.2, 'kl': 0.02810311778448522, 'entropy': 0.8970638200640678, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 73.94997113339632, 'epoch': 0.02}
 70%|#######   | 35/50 [38:20<18:13, 72.91s/it] 72%|#######2  | 36/50 [39:05<15:02, 64.44s/it] 74%|#######4  | 37/50 [39:46<12:26, 57.40s/it] 76%|#######6  | 38/50 [41:52<15:34, 77.90s/it] 78%|#######8  | 39/50 [42:39<12:35, 68.64s/it] 80%|########  | 40/50 [43:06<09:22, 56.22s/it]                                               {'loss': 0.0033, 'grad_norm': 0.6941386461257935, 'learning_rate': 4.4e-06, 'num_tokens': 212275.0, 'completions/mean_length': 182.6375, 'completions/min_length': 53.4, 'completions/max_length': 396.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 182.6375, 'completions/min_terminated_length': 53.4, 'completions/max_terminated_length': 396.6, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.1433130085468292, 'rewards/correctness_reward_func/mean': 0.725, 'rewards/correctness_reward_func/std': 0.8959709286689759, 'reward': 1.18125, 'reward_std': 0.7711047172546387, 'frac_reward_zero_std': 0.15, 'kl': 0.02657183688133955, 'entropy': 0.8540924862027168, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 56.21621466699871, 'epoch': 0.02}
 80%|########  | 40/50 [43:06<09:22, 56.22s/it] 82%|########2 | 41/50 [43:40<07:27, 49.74s/it] 84%|########4 | 42/50 [44:39<06:58, 52.35s/it] 86%|########6 | 43/50 [46:05<07:16, 62.32s/it] 88%|########8 | 44/50 [47:08<06:16, 62.78s/it] 90%|######### | 45/50 [48:28<05:39, 67.90s/it]                                               {'loss': 0.0357, 'grad_norm': 0.6705648899078369, 'learning_rate': 2.4000000000000003e-06, 'num_tokens': 237028.0, 'completions/mean_length': 206.7125, 'completions/min_length': 42.8, 'completions/max_length': 500.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 206.7125, 'completions/min_terminated_length': 42.8, 'completions/max_terminated_length': 500.0, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.12887786626815795, 'rewards/correctness_reward_func/mean': 0.6375, 'rewards/correctness_reward_func/std': 0.8987785458564759, 'reward': 1.0875, 'reward_std': 0.6549876689910888, 'frac_reward_zero_std': 0.2, 'kl': 0.02729109823703766, 'entropy': 0.9647499233484268, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 63.30923083340167, 'epoch': 0.02}
 90%|######### | 45/50 [48:28<05:39, 67.90s/it] 92%|#########2| 46/50 [49:00<03:47, 56.93s/it] 94%|#########3| 47/50 [49:25<02:22, 47.49s/it] 96%|#########6| 48/50 [49:56<01:25, 42.58s/it] 98%|#########8| 49/50 [50:28<00:39, 39.38s/it]100%|##########| 50/50 [51:05<00:00, 38.51s/it]                                               {'loss': -0.0209, 'grad_norm': 0.652861475944519, 'learning_rate': 4.0000000000000003e-07, 'num_tokens': 258103.0, 'completions/mean_length': 162.4375, 'completions/min_length': 65.2, 'completions/max_length': 261.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 162.4375, 'completions/min_terminated_length': 65.2, 'completions/max_terminated_length': 261.8, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.1, 'rewards/correctness_reward_func/mean': 0.7875, 'rewards/correctness_reward_func/std': 0.9399203538894654, 'reward': 1.2625, 'reward_std': 0.617516565322876, 'frac_reward_zero_std': 0.15, 'kl': 0.024717992963269354, 'entropy': 0.7024602964520454, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 30.587249082802735, 'epoch': 0.03}
100%|##########| 50/50 [51:05<00:00, 38.51s/it]                                               {'train_runtime': 3066.2792, 'train_samples_per_second': 0.261, 'train_steps_per_second': 0.016, 'train_loss': 0.04071592263877392, 'epoch': 0.03}
100%|##########| 50/50 [51:06<00:00, 38.51s/it]100%|##########| 50/50 [51:06<00:00, 61.33s/it]

--- Evaluating Model on Dataset A (Math) - After A (50 samples) ---
Sample Output:  
1. Natalia sold clips to 48 friends in April.
2. In May, she sold half as many clips as in April.
3. To find out how many clips she sold in May, we ...
Accuracy on Dataset A (Math) - After A: 48.00%

--- Evaluating Model on Dataset B (Logic) - After A (50 samples) ---
Sample Output:  
1. The context states that "Mary moved to the bathroom."
2. This implies that Mary is currently in the bathroom.
3. Therefore, we can conclude that ...
Accuracy on Dataset B (Logic) - After A: 50.00%
>>> Step 2b: Finetuning SAME model on Dataset B (Logic)

>>> Starting Run: phase2_step2_logic
>>> Continuing training on existing model weights...
  0%|          | 0/50 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|2         | 1/50 [00:29<24:07, 29.54s/it]  4%|4         | 2/50 [01:59<51:57, 64.94s/it]  6%|6         | 3/50 [03:21<56:56, 72.69s/it]  8%|8         | 4/50 [03:40<39:28, 51.49s/it] 10%|#         | 5/50 [04:05<31:25, 41.89s/it]                                              {'loss': 0.0839, 'grad_norm': 1.005665898323059, 'learning_rate': 1.8400000000000003e-05, 'num_tokens': 14299.0, 'completions/mean_length': 84.4375, 'completions/min_length': 10.0, 'completions/max_length': 416.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 84.4375, 'completions/min_terminated_length': 10.0, 'completions/max_terminated_length': 416.2, 'rewards/format_reward_func/mean': 0.3875, 'rewards/format_reward_func/std': 0.1958289325237274, 'rewards/correctness_reward_func/mean': 0.7375, 'rewards/correctness_reward_func/std': 0.6998455286026001, 'reward': 1.125, 'reward_std': 0.7084352731704712, 'frac_reward_zero_std': 0.1, 'kl': 0.04178878064267337, 'entropy': 1.2361834257841111, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 48.24142612519936, 'epoch': 0.02}
 10%|#         | 5/50 [04:05<31:25, 41.89s/it] 12%|#2        | 6/50 [04:26<25:30, 34.79s/it] 14%|#4        | 7/50 [04:53<23:11, 32.37s/it] 16%|#6        | 8/50 [05:23<22:07, 31.62s/it] 18%|#8        | 9/50 [05:45<19:39, 28.76s/it] 20%|##        | 10/50 [06:00<16:16, 24.41s/it]                                               {'loss': 0.1041, 'grad_norm': 1.7557215690612793, 'learning_rate': 1.64e-05, 'num_tokens': 28012.0, 'completions/mean_length': 76.9125, 'completions/min_length': 16.2, 'completions/max_length': 204.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 76.9125, 'completions/min_terminated_length': 16.2, 'completions/max_terminated_length': 204.4, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.14418915510177613, 'rewards/correctness_reward_func/mean': 0.7, 'rewards/correctness_reward_func/std': 0.8672876119613647, 'reward': 1.1375, 'reward_std': 0.7258163213729858, 'frac_reward_zero_std': 0.2, 'kl': 0.08249408602714539, 'entropy': 1.213251492381096, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.590207674799604, 'epoch': 0.04}
 20%|##        | 10/50 [06:00<16:16, 24.41s/it] 22%|##2       | 11/50 [06:14<13:42, 21.10s/it] 24%|##4       | 12/50 [06:35<13:21, 21.08s/it] 26%|##6       | 13/50 [07:02<14:14, 23.08s/it] 28%|##8       | 14/50 [07:48<17:58, 29.97s/it] 30%|###       | 15/50 [08:14<16:39, 28.57s/it]                                               {'loss': 0.0038, 'grad_norm': 0.9763779044151306, 'learning_rate': 1.4400000000000001e-05, 'num_tokens': 41604.0, 'completions/mean_length': 73.3, 'completions/min_length': 14.2, 'completions/max_length': 238.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 73.3, 'completions/min_terminated_length': 14.2, 'completions/max_terminated_length': 238.6, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.7036169528961181, 'reward': 1.1875, 'reward_std': 0.60728679895401, 'frac_reward_zero_std': 0.3, 'kl': 0.0816367237828672, 'entropy': 1.092402645945549, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 26.148776966800504, 'epoch': 0.07}
 30%|###       | 15/50 [08:14<16:39, 28.57s/it] 32%|###2      | 16/50 [08:51<17:46, 31.37s/it] 34%|###4      | 17/50 [09:07<14:42, 26.73s/it] 36%|###6      | 18/50 [09:36<14:33, 27.30s/it] 38%|###8      | 19/50 [09:52<12:18, 23.81s/it] 40%|####      | 20/50 [10:16<12:01, 24.06s/it]                                               {'loss': 0.1087, 'grad_norm': 1.2695424556732178, 'learning_rate': 1.2400000000000002e-05, 'num_tokens': 55643.0, 'completions/mean_length': 79.5875, 'completions/min_length': 14.6, 'completions/max_length': 212.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 79.5875, 'completions/min_terminated_length': 14.6, 'completions/max_terminated_length': 212.8, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.12446779310703278, 'rewards/correctness_reward_func/mean': 0.7375, 'rewards/correctness_reward_func/std': 0.9283842444419861, 'reward': 1.19375, 'reward_std': 0.777625560760498, 'frac_reward_zero_std': 0.15, 'kl': 0.11532995235174895, 'entropy': 1.2072296738624573, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 23.998021424801845, 'epoch': 0.09}
 40%|####      | 20/50 [10:16<12:01, 24.06s/it] 42%|####2     | 21/50 [10:41<11:42, 24.21s/it] 44%|####4     | 22/50 [10:58<10:19, 22.13s/it] 46%|####6     | 23/50 [11:15<09:16, 20.59s/it] 48%|####8     | 24/50 [11:45<10:04, 23.25s/it] 50%|#####     | 25/50 [12:02<08:56, 21.46s/it]                                               {'loss': 0.0916, 'grad_norm': 1.5533713102340698, 'learning_rate': 1.04e-05, 'num_tokens': 67591.0, 'completions/mean_length': 58.8, 'completions/min_length': 15.0, 'completions/max_length': 184.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 58.8, 'completions/min_terminated_length': 15.0, 'completions/max_terminated_length': 184.2, 'rewards/format_reward_func/mean': 0.46875, 'rewards/format_reward_func/std': 0.10915650427341461, 'rewards/correctness_reward_func/mean': 0.95, 'rewards/correctness_reward_func/std': 0.931629192829132, 'reward': 1.41875, 'reward_std': 0.7252260923385621, 'frac_reward_zero_std': 0.15, 'kl': 0.10290441773831845, 'entropy': 1.0051943331956863, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.64194644140225, 'epoch': 0.11}
 50%|#####     | 25/50 [12:02<08:56, 21.46s/it] 52%|#####2    | 26/50 [12:26<08:50, 22.11s/it] 54%|#####4    | 27/50 [12:49<08:34, 22.36s/it] 56%|#####6    | 28/50 [13:01<07:05, 19.34s/it] 58%|#####8    | 29/50 [13:18<06:32, 18.67s/it] 60%|######    | 30/50 [13:38<06:24, 19.20s/it]                                               {'loss': 0.0715, 'grad_norm': 1.3492262363433838, 'learning_rate': 8.400000000000001e-06, 'num_tokens': 79112.0, 'completions/mean_length': 53.5625, 'completions/min_length': 16.0, 'completions/max_length': 163.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 53.5625, 'completions/min_terminated_length': 16.0, 'completions/max_terminated_length': 163.8, 'rewards/format_reward_func/mean': 0.49375, 'rewards/format_reward_func/std': 0.025, 'rewards/correctness_reward_func/mean': 0.9625, 'rewards/correctness_reward_func/std': 0.9318387746810913, 'reward': 1.45625, 'reward_std': 0.6204515933990479, 'frac_reward_zero_std': 0.3, 'kl': 0.12339048162102699, 'entropy': 0.9102844536304474, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 18.85011123299919, 'epoch': 0.13}
 60%|######    | 30/50 [13:38<06:24, 19.20s/it] 62%|######2   | 31/50 [13:54<05:45, 18.20s/it] 64%|######4   | 32/50 [14:19<06:01, 20.10s/it] 66%|######6   | 33/50 [14:38<05:37, 19.84s/it] 68%|######8   | 34/50 [15:10<06:16, 23.56s/it] 70%|#######   | 35/50 [15:23<05:06, 20.41s/it]                                               {'loss': 0.1119, 'grad_norm': 1.70490562915802, 'learning_rate': 6.4000000000000006e-06, 'num_tokens': 91090.0, 'completions/mean_length': 54.275, 'completions/min_length': 15.6, 'completions/max_length': 182.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 54.275, 'completions/min_terminated_length': 15.6, 'completions/max_terminated_length': 182.0, 'rewards/format_reward_func/mean': 0.48125, 'rewards/format_reward_func/std': 0.075, 'rewards/correctness_reward_func/mean': 0.8375, 'rewards/correctness_reward_func/std': 0.9411686062812805, 'reward': 1.31875, 'reward_std': 0.764233124256134, 'frac_reward_zero_std': 0.2, 'kl': 0.13394604288041592, 'entropy': 1.0566064089536666, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 20.524724774797505, 'epoch': 0.16}
 70%|#######   | 35/50 [15:23<05:06, 20.41s/it] 72%|#######2  | 36/50 [15:55<05:31, 23.69s/it] 74%|#######4  | 37/50 [16:14<04:50, 22.35s/it] 76%|#######6  | 38/50 [16:29<04:03, 20.29s/it] 78%|#######8  | 39/50 [16:56<04:04, 22.24s/it] 80%|########  | 40/50 [17:19<03:43, 22.40s/it]                                               {'loss': -0.0239, 'grad_norm': 0.6275393962860107, 'learning_rate': 4.4e-06, 'num_tokens': 102945.0, 'completions/mean_length': 53.7375, 'completions/min_length': 14.0, 'completions/max_length': 204.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 53.7375, 'completions/min_terminated_length': 14.0, 'completions/max_terminated_length': 204.0, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.08415650427341462, 'rewards/correctness_reward_func/mean': 0.6875, 'rewards/correctness_reward_func/std': 0.9340631365776062, 'reward': 1.1625, 'reward_std': 0.5399946451187134, 'frac_reward_zero_std': 0.4, 'kl': 0.12640199158340693, 'entropy': 0.9772513955831528, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 22.607848458997616, 'epoch': 0.18}
 80%|########  | 40/50 [17:19<03:43, 22.40s/it] 82%|########2 | 41/50 [17:38<03:13, 21.53s/it] 84%|########4 | 42/50 [17:58<02:46, 20.83s/it] 86%|########6 | 43/50 [18:48<03:28, 29.84s/it] 88%|########8 | 44/50 [19:09<02:41, 26.92s/it] 90%|######### | 45/50 [19:29<02:05, 25.07s/it]                                               {'loss': 0.1311, 'grad_norm': 0.9980852603912354, 'learning_rate': 2.4000000000000003e-06, 'num_tokens': 116112.0, 'completions/mean_length': 64.8375, 'completions/min_length': 14.6, 'completions/max_length': 223.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 64.8375, 'completions/min_terminated_length': 14.6, 'completions/max_terminated_length': 223.8, 'rewards/format_reward_func/mean': 0.4875, 'rewards/format_reward_func/std': 0.05, 'rewards/correctness_reward_func/mean': 0.7, 'rewards/correctness_reward_func/std': 0.9251652956008911, 'reward': 1.1875, 'reward_std': 0.627721655368805, 'frac_reward_zero_std': 0.3, 'kl': 0.1391394568607211, 'entropy': 1.0990348130464553, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 25.582106099801603, 'epoch': 0.2}
 90%|######### | 45/50 [19:29<02:05, 25.07s/it] 92%|#########2| 46/50 [19:49<01:33, 23.40s/it] 94%|#########3| 47/50 [19:59<00:58, 19.58s/it] 96%|#########6| 48/50 [20:12<00:34, 17.39s/it] 98%|#########8| 49/50 [20:24<00:15, 15.82s/it]100%|##########| 50/50 [20:41<00:00, 16.07s/it]                                               {'loss': -0.0405, 'grad_norm': 1.0317533016204834, 'learning_rate': 4.0000000000000003e-07, 'num_tokens': 126526.0, 'completions/mean_length': 44.375, 'completions/min_length': 14.6, 'completions/max_length': 112.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 44.375, 'completions/min_terminated_length': 14.6, 'completions/max_terminated_length': 112.2, 'rewards/format_reward_func/mean': 0.475, 'rewards/format_reward_func/std': 0.1, 'rewards/correctness_reward_func/mean': 0.825, 'rewards/correctness_reward_func/std': 0.8163646221160888, 'reward': 1.3, 'reward_std': 0.6656285881996155, 'frac_reward_zero_std': 0.2, 'kl': 0.13802775461226702, 'entropy': 0.950947743654251, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 13.889923707999696, 'epoch': 0.22}
100%|##########| 50/50 [20:41<00:00, 16.07s/it]                                               {'train_runtime': 1241.8343, 'train_samples_per_second': 0.644, 'train_steps_per_second': 0.04, 'train_loss': 0.06423117339611054, 'epoch': 0.22}
100%|##########| 50/50 [20:41<00:00, 16.07s/it]100%|##########| 50/50 [20:41<00:00, 24.84s/it]

--- Evaluating Model on Dataset A (Math) - After A->B (50 samples) ---
Sample Output:  
To find out how many clips Natalia sold in total from April to May, we need to follow these steps:

1. Determine how many clips Natalia sold in May....
Accuracy on Dataset A (Math) - After A->B: 46.00%

--- Evaluating Model on Dataset B (Logic) - After A->B (50 samples) ---
Sample Output:  
Mary moved to the bathroom, so she must be in the bathroom.
<answer> bathroom </answer>...
Accuracy on Dataset B (Logic) - After A->B: 48.00%

========================================
PHASE 3: SEQUENCE B -> A (RESET MODEL)
========================================
>>> Step 3a: Finetuning on Dataset B (Logic)

>>> Starting Run: phase3_step1_logic
Loading Base Model on mps...
  0%|          | 0/50 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|2         | 1/50 [00:26<21:51, 26.76s/it]  4%|4         | 2/50 [00:53<21:21, 26.69s/it]  6%|6         | 3/50 [01:32<25:23, 32.42s/it]  8%|8         | 4/50 [02:04<24:36, 32.10s/it] 10%|#         | 5/50 [02:32<22:56, 30.58s/it]                                              {'loss': 0.0001, 'grad_norm': 1.3939125537872314, 'learning_rate': 1.8400000000000003e-05, 'num_tokens': 15889.0, 'completions/mean_length': 104.3125, 'completions/min_length': 9.8, 'completions/max_length': 276.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 104.3125, 'completions/min_terminated_length': 9.8, 'completions/max_terminated_length': 276.6, 'rewards/format_reward_func/mean': 0.19375, 'rewards/format_reward_func/std': 0.23769378066062927, 'rewards/correctness_reward_func/mean': 0.4, 'rewards/correctness_reward_func/std': 0.4845838785171509, 'reward': 0.59375, 'reward_std': 0.4364138185977936, 'frac_reward_zero_std': 0.1, 'kl': 0.002075165184214711, 'entropy': 1.277819859981537, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 29.7790368663962, 'epoch': 0.02}
 10%|#         | 5/50 [02:32<22:56, 30.58s/it] 12%|#2        | 6/50 [03:05<23:04, 31.46s/it] 14%|#4        | 7/50 [03:35<22:15, 31.05s/it] 16%|#6        | 8/50 [04:00<20:17, 28.98s/it] 18%|#8        | 9/50 [04:40<22:11, 32.47s/it] 20%|##        | 10/50 [05:21<23:28, 35.21s/it]                                               {'loss': -0.2591, 'grad_norm': 1.302228569984436, 'learning_rate': 1.64e-05, 'num_tokens': 31436.0, 'completions/mean_length': 99.8375, 'completions/min_length': 12.6, 'completions/max_length': 310.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 99.8375, 'completions/min_terminated_length': 12.6, 'completions/max_terminated_length': 310.8, 'rewards/format_reward_func/mean': 0.225, 'rewards/format_reward_func/std': 0.2540254473686218, 'rewards/correctness_reward_func/mean': 0.4125, 'rewards/correctness_reward_func/std': 0.5549131453037262, 'reward': 0.6375, 'reward_std': 0.5079244494438171, 'frac_reward_zero_std': 0.05, 'kl': 0.006401691574137658, 'entropy': 1.3789263874292375, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 33.17885445019492, 'epoch': 0.04}
 20%|##        | 10/50 [05:21<23:28, 35.21s/it] 22%|##2       | 11/50 [05:56<22:54, 35.25s/it] 24%|##4       | 12/50 [06:35<22:53, 36.15s/it] 26%|##6       | 13/50 [07:33<26:21, 42.75s/it] 28%|##8       | 14/50 [08:55<32:45, 54.60s/it] 30%|###       | 15/50 [09:48<31:41, 54.34s/it]                                               {'loss': 0.0276, 'grad_norm': 0.9716355204582214, 'learning_rate': 1.4400000000000001e-05, 'num_tokens': 51767.0, 'completions/mean_length': 157.5375, 'completions/min_length': 23.0, 'completions/max_length': 465.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 157.5375, 'completions/min_terminated_length': 23.0, 'completions/max_terminated_length': 465.8, 'rewards/format_reward_func/mean': 0.30625, 'rewards/format_reward_func/std': 0.2433386117219925, 'rewards/correctness_reward_func/mean': 0.5125, 'rewards/correctness_reward_func/std': 0.6405696988105773, 'reward': 0.81875, 'reward_std': 0.6740626811981201, 'frac_reward_zero_std': 0.05, 'kl': 0.011141966469585896, 'entropy': 1.7038972586393357, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 52.601950025200495, 'epoch': 0.07}
 30%|###       | 15/50 [09:48<31:41, 54.34s/it] 32%|###2      | 16/50 [10:36<29:40, 52.37s/it] 34%|###4      | 17/50 [11:15<26:31, 48.24s/it] 36%|###6      | 18/50 [11:47<23:10, 43.45s/it] 38%|###8      | 19/50 [12:18<20:32, 39.76s/it] 40%|####      | 20/50 [12:55<19:28, 38.93s/it]                                               {'loss': -0.0118, 'grad_norm': 0.8966016173362732, 'learning_rate': 1.2400000000000002e-05, 'num_tokens': 72413.0, 'completions/mean_length': 162.175, 'completions/min_length': 18.8, 'completions/max_length': 340.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 162.175, 'completions/min_terminated_length': 18.8, 'completions/max_terminated_length': 340.6, 'rewards/format_reward_func/mean': 0.39375, 'rewards/format_reward_func/std': 0.2103765904903412, 'rewards/correctness_reward_func/mean': 0.475, 'rewards/correctness_reward_func/std': 0.623397707939148, 'reward': 0.86875, 'reward_std': 0.5719933629035949, 'frac_reward_zero_std': 0.05, 'kl': 0.015026321238838136, 'entropy': 1.5603544533252716, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.63874392420257, 'epoch': 0.09}
 40%|####      | 20/50 [12:55<19:28, 38.93s/it] 42%|####2     | 21/50 [14:16<24:50, 51.39s/it] 44%|####4     | 22/50 [14:46<21:03, 45.14s/it] 46%|####6     | 23/50 [15:37<21:04, 46.83s/it] 48%|####8     | 24/50 [16:53<24:05, 55.59s/it] 50%|#####     | 25/50 [17:29<20:42, 49.72s/it]                                               {'loss': -0.0743, 'grad_norm': 1.0204627513885498, 'learning_rate': 1.04e-05, 'num_tokens': 93089.0, 'completions/mean_length': 167.9, 'completions/min_length': 36.8, 'completions/max_length': 464.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 167.9, 'completions/min_terminated_length': 36.8, 'completions/max_terminated_length': 464.4, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.1982152968645096, 'rewards/correctness_reward_func/mean': 0.5375, 'rewards/correctness_reward_func/std': 0.5963717222213745, 'reward': 0.9375, 'reward_std': 0.5809727907180786, 'frac_reward_zero_std': 0.0, 'kl': 0.04002919378690421, 'entropy': 1.6107915937900543, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 53.950844508802405, 'epoch': 0.11}
 50%|#####     | 25/50 [17:29<20:42, 49.72s/it] 52%|#####2    | 26/50 [18:25<20:35, 51.48s/it] 54%|#####4    | 27/50 [19:23<20:31, 53.56s/it] 56%|#####6    | 28/50 [20:15<19:30, 53.19s/it] 58%|#####8    | 29/50 [20:47<16:18, 46.60s/it] 60%|######    | 30/50 [21:22<14:25, 43.28s/it]                                               {'loss': 0.0419, 'grad_norm': 0.9085631370544434, 'learning_rate': 8.400000000000001e-06, 'num_tokens': 114764.0, 'completions/mean_length': 180.4875, 'completions/min_length': 48.8, 'completions/max_length': 403.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 180.4875, 'completions/min_terminated_length': 48.8, 'completions/max_terminated_length': 403.6, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.14418915510177613, 'rewards/correctness_reward_func/mean': 0.4875, 'rewards/correctness_reward_func/std': 0.579081004858017, 'reward': 0.925, 'reward_std': 0.47809324860572816, 'frac_reward_zero_std': 0.15, 'kl': 0.022088813502341507, 'entropy': 1.5753155767917633, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 45.77908301679854, 'epoch': 0.13}
 60%|######    | 30/50 [21:22<14:25, 43.28s/it] 62%|######2   | 31/50 [22:40<17:00, 53.71s/it] 64%|######4   | 32/50 [23:44<17:03, 56.88s/it] 66%|######6   | 33/50 [24:31<15:14, 53.77s/it] 68%|######8   | 34/50 [25:21<14:01, 52.58s/it] 70%|#######   | 35/50 [25:51<11:27, 45.81s/it]                                               {'loss': 0.0223, 'grad_norm': 0.7954778075218201, 'learning_rate': 6.4000000000000006e-06, 'num_tokens': 138643.0, 'completions/mean_length': 203.0375, 'completions/min_length': 73.2, 'completions/max_length': 456.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 203.0375, 'completions/min_terminated_length': 73.2, 'completions/max_terminated_length': 456.6, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.1336242973804474, 'rewards/correctness_reward_func/mean': 0.55, 'rewards/correctness_reward_func/std': 0.5590160012245178, 'reward': 1.0, 'reward_std': 0.46308663487434387, 'frac_reward_zero_std': 0.2, 'kl': 0.020017517358064653, 'entropy': 1.6740223824977876, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 52.850653166601845, 'epoch': 0.16}
 70%|#######   | 35/50 [25:51<11:27, 45.81s/it] 72%|#######2  | 36/50 [26:49<11:33, 49.55s/it] 74%|#######4  | 37/50 [27:26<09:54, 45.75s/it] 76%|#######6  | 38/50 [28:14<09:16, 46.39s/it] 78%|#######8  | 39/50 [28:49<07:55, 43.19s/it] 80%|########  | 40/50 [29:39<07:32, 45.23s/it]                                               {'loss': -0.0065, 'grad_norm': 0.7703163027763367, 'learning_rate': 4.4e-06, 'num_tokens': 162436.0, 'completions/mean_length': 202.9625, 'completions/min_length': 60.2, 'completions/max_length': 391.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 202.9625, 'completions/min_terminated_length': 60.2, 'completions/max_terminated_length': 391.8, 'rewards/format_reward_func/mean': 0.4625, 'rewards/format_reward_func/std': 0.09946779310703277, 'rewards/correctness_reward_func/mean': 0.3375, 'rewards/correctness_reward_func/std': 0.5010316610336304, 'reward': 0.8, 'reward_std': 0.39109971225261686, 'frac_reward_zero_std': 0.3, 'kl': 0.020092531060799956, 'entropy': 1.6227962911128997, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 44.94098367519909, 'epoch': 0.18}
 80%|########  | 40/50 [29:40<07:32, 45.23s/it] 82%|########2 | 41/50 [30:26<06:50, 45.57s/it] 84%|########4 | 42/50 [31:07<05:54, 44.27s/it] 86%|########6 | 43/50 [31:49<05:05, 43.67s/it] 88%|########8 | 44/50 [32:54<05:00, 50.12s/it] 90%|######### | 45/50 [33:37<03:59, 47.85s/it]                                               {'loss': 0.072, 'grad_norm': 0.8495636582374573, 'learning_rate': 2.4000000000000003e-06, 'num_tokens': 187816.0, 'completions/mean_length': 217.5, 'completions/min_length': 96.4, 'completions/max_length': 413.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 217.5, 'completions/min_terminated_length': 96.4, 'completions/max_terminated_length': 413.8, 'rewards/format_reward_func/mean': 0.44375, 'rewards/format_reward_func/std': 0.13503265082836152, 'rewards/correctness_reward_func/mean': 0.3125, 'rewards/correctness_reward_func/std': 0.5436249792575836, 'reward': 0.75625, 'reward_std': 0.494923347234726, 'frac_reward_zero_std': 0.2, 'kl': 0.018249592604115607, 'entropy': 1.6754677414894104, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 46.693601325205236, 'epoch': 0.2}
 90%|######### | 45/50 [33:37<03:59, 47.85s/it] 92%|#########2| 46/50 [34:16<03:00, 45.11s/it] 94%|#########3| 47/50 [34:59<02:13, 44.59s/it] 96%|#########6| 48/50 [35:41<01:27, 43.71s/it] 98%|#########8| 49/50 [36:19<00:42, 42.14s/it]100%|##########| 50/50 [36:53<00:00, 39.68s/it]                                               {'loss': 0.0398, 'grad_norm': 0.8745402693748474, 'learning_rate': 4.0000000000000003e-07, 'num_tokens': 208572.0, 'completions/mean_length': 173.65, 'completions/min_length': 67.0, 'completions/max_length': 332.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 173.65, 'completions/min_terminated_length': 67.0, 'completions/max_terminated_length': 332.0, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.1494677931070328, 'rewards/correctness_reward_func/mean': 0.6125, 'rewards/correctness_reward_func/std': 0.5569595754146576, 'reward': 1.0625, 'reward_std': 0.5241601884365081, 'frac_reward_zero_std': 0.1, 'kl': 0.019301694817841053, 'entropy': 1.414835023880005, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 38.46451879180095, 'epoch': 0.22}
100%|##########| 50/50 [36:53<00:00, 39.68s/it]                                               {'train_runtime': 2214.604, 'train_samples_per_second': 0.361, 'train_steps_per_second': 0.023, 'train_loss': -0.014802887365221977, 'epoch': 0.22}
100%|##########| 50/50 [36:54<00:00, 39.68s/it]100%|##########| 50/50 [36:54<00:00, 44.29s/it]

--- Evaluating Model on Dataset A (Math) - After B (50 samples) ---
Sample Output:  
1. First, we need to determine how many clips Natalia sold in May. According to the problem, she sold half as many clips in May as she did in April....
Accuracy on Dataset A (Math) - After B: 38.00%

--- Evaluating Model on Dataset B (Logic) - After B (50 samples) ---
Sample Output:  
1. The context states that "Mary moved to the bathroom."
2. This directly tells us where Mary is located.
3. Therefore, we can conclude that Mary is...
Accuracy on Dataset B (Logic) - After B: 56.00%
>>> Step 3b: Finetuning SAME model on Dataset A (Math)

>>> Starting Run: phase3_step2_math
>>> Continuing training on existing model weights...
  0%|          | 0/50 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|2         | 1/50 [02:22<1:56:24, 142.54s/it]  4%|4         | 2/50 [03:23<1:15:31, 94.42s/it]   6%|6         | 3/50 [04:44<1:09:08, 88.28s/it]  8%|8         | 4/50 [07:07<1:24:21, 110.03s/it] 10%|#         | 5/50 [08:06<1:08:45, 91.68s/it]                                                 {'loss': 0.1056, 'grad_norm': 0.7101908922195435, 'learning_rate': 1.8400000000000003e-05, 'num_tokens': 33620.0, 'completions/mean_length': 313.65, 'completions/min_length': 113.6, 'completions/max_length': 749.2, 'completions/clipped_ratio': 0.025, 'completions/mean_terminated_length': 295.38416748046876, 'completions/min_terminated_length': 113.6, 'completions/max_terminated_length': 552.8, 'rewards/format_reward_func/mean': 0.35625, 'rewards/format_reward_func/std': 0.2288601279258728, 'rewards/correctness_reward_func/mean': 0.45, 'rewards/correctness_reward_func/std': 0.6185278177261353, 'reward': 0.80625, 'reward_std': 0.6284391164779664, 'frac_reward_zero_std': 0.05, 'kl': 0.01056382933165878, 'entropy': 1.1672463834285736, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 96.05759938340489, 'epoch': 0.0}
 10%|#         | 5/50 [08:06<1:08:45, 91.68s/it] 12%|#2        | 6/50 [08:52<55:51, 76.17s/it]   14%|#4        | 7/50 [09:26<44:39, 62.31s/it] 16%|#6        | 8/50 [10:25<42:44, 61.07s/it] 18%|#8        | 9/50 [11:04<37:06, 54.30s/it] 20%|##        | 10/50 [11:41<32:40, 49.02s/it]                                               {'loss': -0.0382, 'grad_norm': 0.5494969487190247, 'learning_rate': 1.64e-05, 'num_tokens': 59466.0, 'completions/mean_length': 224.475, 'completions/min_length': 66.2, 'completions/max_length': 393.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 224.475, 'completions/min_terminated_length': 66.2, 'completions/max_terminated_length': 393.4, 'rewards/format_reward_func/mean': 0.44375, 'rewards/format_reward_func/std': 0.13503265082836152, 'rewards/correctness_reward_func/mean': 0.6125, 'rewards/correctness_reward_func/std': 0.8466069459915161, 'reward': 1.05625, 'reward_std': 0.6809638381004334, 'frac_reward_zero_std': 0.1, 'kl': 0.019772466365247966, 'entropy': 0.7734899029135704, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 42.16100420000002, 'epoch': 0.01}
 20%|##        | 10/50 [11:41<32:40, 49.02s/it] 22%|##2       | 11/50 [12:36<33:01, 50.80s/it] 24%|##4       | 12/50 [13:44<35:26, 55.95s/it] 26%|##6       | 13/50 [14:48<36:03, 58.49s/it] 28%|##8       | 14/50 [15:37<33:19, 55.53s/it] 30%|###       | 15/50 [16:35<32:52, 56.35s/it]                                               {'loss': 0.0422, 'grad_norm': 0.6881222724914551, 'learning_rate': 1.4400000000000001e-05, 'num_tokens': 89511.0, 'completions/mean_length': 277.7125, 'completions/min_length': 147.0, 'completions/max_length': 491.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 277.7125, 'completions/min_terminated_length': 147.0, 'completions/max_terminated_length': 491.6, 'rewards/format_reward_func/mean': 0.41875, 'rewards/format_reward_func/std': 0.16265043914318084, 'rewards/correctness_reward_func/mean': 0.625, 'rewards/correctness_reward_func/std': 0.8214950799942017, 'reward': 1.04375, 'reward_std': 0.8235961318016052, 'frac_reward_zero_std': 0.05, 'kl': 0.01745030819438398, 'entropy': 0.901800811290741, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 57.847613550398094, 'epoch': 0.01}
 30%|###       | 15/50 [16:35<32:52, 56.35s/it] 32%|###2      | 16/50 [17:31<31:51, 56.21s/it] 34%|###4      | 17/50 [18:43<33:35, 61.08s/it] 36%|###6      | 18/50 [19:30<30:20, 56.88s/it] 38%|###8      | 19/50 [20:13<27:14, 52.72s/it] 40%|####      | 20/50 [21:26<29:21, 58.72s/it]                                               {'loss': 0.0298, 'grad_norm': 0.6292780041694641, 'learning_rate': 1.2400000000000002e-05, 'num_tokens': 119545.0, 'completions/mean_length': 262.625, 'completions/min_length': 127.0, 'completions/max_length': 456.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 262.625, 'completions/min_terminated_length': 127.0, 'completions/max_terminated_length': 456.4, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.1336242973804474, 'rewards/correctness_reward_func/mean': 0.6125, 'rewards/correctness_reward_func/std': 0.8382244110107422, 'reward': 1.0625, 'reward_std': 0.6364316523075104, 'frac_reward_zero_std': 0.2, 'kl': 0.02367488406598568, 'entropy': 1.0577275633811951, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 57.15955697539903, 'epoch': 0.01}
 40%|####      | 20/50 [21:26<29:21, 58.72s/it] 42%|####2     | 21/50 [22:40<30:36, 63.32s/it] 44%|####4     | 22/50 [23:39<28:58, 62.11s/it] 46%|####6     | 23/50 [24:31<26:29, 58.88s/it] 48%|####8     | 24/50 [25:42<27:04, 62.47s/it] 50%|#####     | 25/50 [27:05<28:35, 68.62s/it]                                               {'loss': 0.0423, 'grad_norm': 0.6649124026298523, 'learning_rate': 1.04e-05, 'num_tokens': 147655.0, 'completions/mean_length': 246.075, 'completions/min_length': 105.6, 'completions/max_length': 465.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 246.075, 'completions/min_terminated_length': 105.6, 'completions/max_terminated_length': 465.6, 'rewards/format_reward_func/mean': 0.43125, 'rewards/format_reward_func/std': 0.17393558621406555, 'rewards/correctness_reward_func/mean': 0.425, 'rewards/correctness_reward_func/std': 0.715797770023346, 'reward': 0.85625, 'reward_std': 0.49181843400001524, 'frac_reward_zero_std': 0.2, 'kl': 0.026691019954159855, 'entropy': 1.1360263705253602, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 66.39964848339733, 'epoch': 0.01}
 50%|#####     | 25/50 [27:05<28:35, 68.62s/it] 52%|#####2    | 26/50 [28:19<28:10, 70.42s/it] 54%|#####4    | 27/50 [29:36<27:41, 72.23s/it] 56%|#####6    | 28/50 [31:06<28:31, 77.79s/it] 58%|#####8    | 29/50 [32:00<24:41, 70.55s/it] 60%|######    | 30/50 [33:21<24:33, 73.67s/it]                                               {'loss': 0.0107, 'grad_norm': 0.9626745581626892, 'learning_rate': 8.400000000000001e-06, 'num_tokens': 181462.0, 'completions/mean_length': 307.1375, 'completions/min_length': 111.8, 'completions/max_length': 539.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 307.1375, 'completions/min_terminated_length': 111.8, 'completions/max_terminated_length': 539.6, 'rewards/format_reward_func/mean': 0.45625, 'rewards/format_reward_func/std': 0.12446779310703278, 'rewards/correctness_reward_func/mean': 0.55, 'rewards/correctness_reward_func/std': 0.8199957132339477, 'reward': 1.00625, 'reward_std': 0.5408740699291229, 'frac_reward_zero_std': 0.25, 'kl': 0.03187585105188191, 'entropy': 1.2203232675790787, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 74.28670044179599, 'epoch': 0.02}
 60%|######    | 30/50 [33:21<24:33, 73.67s/it] 62%|######2   | 31/50 [34:55<25:13, 79.65s/it] 64%|######4   | 32/50 [35:40<20:48, 69.36s/it] 66%|######6   | 33/50 [36:18<16:59, 60.00s/it] 68%|######8   | 34/50 [37:29<16:50, 63.15s/it] 70%|#######   | 35/50 [38:53<17:22, 69.50s/it]                                               {'loss': -0.0067, 'grad_norm': 0.5803121328353882, 'learning_rate': 6.4000000000000006e-06, 'num_tokens': 211935.0, 'completions/mean_length': 277.2125, 'completions/min_length': 136.0, 'completions/max_length': 478.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 277.2125, 'completions/min_terminated_length': 136.0, 'completions/max_terminated_length': 478.8, 'rewards/format_reward_func/mean': 0.46875, 'rewards/format_reward_func/std': 0.09331300854682922, 'rewards/correctness_reward_func/mean': 0.6625, 'rewards/correctness_reward_func/std': 0.8389799356460571, 'reward': 1.13125, 'reward_std': 0.6278424143791199, 'frac_reward_zero_std': 0.3, 'kl': 0.021176053024828435, 'entropy': 0.9118507236242295, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 65.15253851620218, 'epoch': 0.02}
 70%|#######   | 35/50 [38:53<17:22, 69.50s/it] 72%|#######2  | 36/50 [40:13<16:55, 72.53s/it] 74%|#######4  | 37/50 [41:14<15:01, 69.34s/it] 76%|#######6  | 38/50 [42:49<15:24, 77.05s/it] 78%|#######8  | 39/50 [43:40<12:39, 69.07s/it] 80%|########  | 40/50 [45:06<12:21, 74.19s/it]                                               {'loss': 0.0862, 'grad_norm': 1.0681060552597046, 'learning_rate': 4.4e-06, 'num_tokens': 240712.0, 'completions/mean_length': 255.4625, 'completions/min_length': 103.4, 'completions/max_length': 523.0, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 255.4625, 'completions/min_terminated_length': 103.4, 'completions/max_terminated_length': 523.0, 'rewards/format_reward_func/mean': 0.40625, 'rewards/format_reward_func/std': 0.175, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.9421278357505798, 'reward': 1.11875, 'reward_std': 0.7417312681674957, 'frac_reward_zero_std': 0.1, 'kl': 0.03215785692445934, 'entropy': 0.9325139909982681, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 73.22629936680168, 'epoch': 0.02}
 80%|########  | 40/50 [45:06<12:21, 74.19s/it] 82%|########2 | 41/50 [45:52<09:50, 65.64s/it] 84%|########4 | 42/50 [46:47<08:20, 62.62s/it] 86%|########6 | 43/50 [47:51<07:21, 63.01s/it] 88%|########8 | 44/50 [49:21<07:06, 71.13s/it] 90%|######### | 45/50 [50:41<06:08, 73.65s/it]                                               {'loss': 0.0422, 'grad_norm': 0.45746344327926636, 'learning_rate': 2.4000000000000003e-06, 'num_tokens': 269819.0, 'completions/mean_length': 261.1375, 'completions/min_length': 92.8, 'completions/max_length': 499.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 261.1375, 'completions/min_terminated_length': 92.8, 'completions/max_terminated_length': 499.2, 'rewards/format_reward_func/mean': 0.44375, 'rewards/format_reward_func/std': 0.13977908194065095, 'rewards/correctness_reward_func/mean': 0.5, 'rewards/correctness_reward_func/std': 0.8044093132019043, 'reward': 0.94375, 'reward_std': 0.5792267024517059, 'frac_reward_zero_std': 0.25, 'kl': 0.020991724077612163, 'entropy': 1.028691053390503, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 65.69739278320048, 'epoch': 0.02}
 90%|######### | 45/50 [50:41<06:08, 73.65s/it] 92%|#########2| 46/50 [51:37<04:33, 68.37s/it] 94%|#########3| 47/50 [52:28<03:09, 63.11s/it] 96%|#########6| 48/50 [53:38<02:10, 65.36s/it] 98%|#########8| 49/50 [55:14<01:14, 74.48s/it]100%|##########| 50/50 [56:16<00:00, 70.81s/it]                                               {'loss': 0.0913, 'grad_norm': 0.5383933782577515, 'learning_rate': 4.0000000000000003e-07, 'num_tokens': 297116.0, 'completions/mean_length': 240.2125, 'completions/min_length': 101.2, 'completions/max_length': 479.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 240.2125, 'completions/min_terminated_length': 101.2, 'completions/max_terminated_length': 479.4, 'rewards/format_reward_func/mean': 0.425, 'rewards/format_reward_func/std': 0.17834565937519073, 'rewards/correctness_reward_func/mean': 0.8125, 'rewards/correctness_reward_func/std': 0.9578370332717896, 'reward': 1.2375, 'reward_std': 0.5691242098808289, 'frac_reward_zero_std': 0.2, 'kl': 0.030182944145053625, 'entropy': 0.9769942134618759, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 66.18570400000172, 'epoch': 0.03}
100%|##########| 50/50 [56:16<00:00, 70.81s/it]                                               {'train_runtime': 3377.9015, 'train_samples_per_second': 0.237, 'train_steps_per_second': 0.015, 'train_loss': 0.04053036786615848, 'epoch': 0.03}
100%|##########| 50/50 [56:17<00:00, 70.81s/it]100%|##########| 50/50 [56:17<00:00, 67.56s/it]

--- Evaluating Model on Dataset A (Math) - After B->A (50 samples) ---
Sample Output:  
1. First, we need to determine how many clips Natalia sold in May. According to the problem, she sold half as many clips in May as she did in April....
Accuracy on Dataset A (Math) - After B->A: 40.00%

--- Evaluating Model on Dataset B (Logic) - After B->A (50 samples) ---
Sample Output:  
1. The context states that "Mary moved to the bathroom."
2. This directly implies that Mary is currently in the bathroom.
3. Therefore, we can concl...
Accuracy on Dataset B (Logic) - After B->A: 56.00%

========================================
PHASE 4: JOINT TRAINING (RESET MODEL)
========================================
>>> Step 4: Finetuning on Joint Dataset

>>> Starting Run: phase4_joint
Loading Base Model on mps...
  0%|          | 0/50 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
  2%|2         | 1/50 [00:40<33:21, 40.86s/it]  4%|4         | 2/50 [01:24<34:02, 42.54s/it]  6%|6         | 3/50 [02:04<32:25, 41.39s/it]  8%|8         | 4/50 [04:21<1:00:39, 79.11s/it] 10%|#         | 5/50 [04:50<45:53, 61.19s/it]                                                {'loss': -0.0272, 'grad_norm': 0.5860866904258728, 'learning_rate': 1.8400000000000003e-05, 'num_tokens': 22184.0, 'completions/mean_length': 176.2, 'completions/min_length': 54.2, 'completions/max_length': 478.0, 'completions/clipped_ratio': 0.0125, 'completions/mean_terminated_length': 165.61416625976562, 'completions/min_terminated_length': 54.2, 'completions/max_terminated_length': 330.2, 'rewards/format_reward_func/mean': 0.225, 'rewards/format_reward_func/std': 0.24546725451946258, 'rewards/correctness_reward_func/mean': 0.6625, 'rewards/correctness_reward_func/std': 0.8879955291748047, 'reward': 0.8875, 'reward_std': 0.731707113981247, 'frac_reward_zero_std': 0.05, 'kl': 0.0020122837566304954, 'entropy': 0.6922027543187141, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 57.24517734159745, 'epoch': 0.0}
 10%|#         | 5/50 [04:50<45:53, 61.19s/it] 12%|#2        | 6/50 [05:41<42:17, 57.67s/it] 14%|#4        | 7/50 [06:46<42:52, 59.84s/it] 16%|#6        | 8/50 [07:27<37:40, 53.82s/it] 18%|#8        | 9/50 [07:55<31:27, 46.04s/it] 20%|##        | 10/50 [08:34<29:10, 43.75s/it]                                               {'loss': 0.0409, 'grad_norm': 0.9232770204544067, 'learning_rate': 1.64e-05, 'num_tokens': 43451.0, 'completions/mean_length': 160.5375, 'completions/min_length': 38.2, 'completions/max_length': 391.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 160.5375, 'completions/min_terminated_length': 38.2, 'completions/max_terminated_length': 391.2, 'rewards/format_reward_func/mean': 0.26875, 'rewards/format_reward_func/std': 0.2460835874080658, 'rewards/correctness_reward_func/mean': 0.4375, 'rewards/correctness_reward_func/std': 0.7071112871170044, 'reward': 0.70625, 'reward_std': 0.6339875817298889, 'frac_reward_zero_std': 0.0, 'kl': 0.005079790414310992, 'entropy': 0.9019195333123207, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 43.86411469220038, 'epoch': 0.0}
 20%|##        | 10/50 [08:34<29:10, 43.75s/it] 22%|##2       | 11/50 [09:25<29:52, 45.96s/it] 24%|##4       | 12/50 [10:10<28:55, 45.68s/it] 26%|##6       | 13/50 [10:58<28:39, 46.47s/it] 28%|##8       | 14/50 [11:54<29:36, 49.34s/it] 30%|###       | 15/50 [12:55<30:49, 52.84s/it]                                               {'loss': -0.0175, 'grad_norm': 0.9912307858467102, 'learning_rate': 1.4400000000000001e-05, 'num_tokens': 69889.0, 'completions/mean_length': 223.675, 'completions/min_length': 84.4, 'completions/max_length': 449.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 223.675, 'completions/min_terminated_length': 84.4, 'completions/max_terminated_length': 449.2, 'rewards/format_reward_func/mean': 0.33125, 'rewards/format_reward_func/std': 0.2416988343000412, 'rewards/correctness_reward_func/mean': 0.7125, 'rewards/correctness_reward_func/std': 0.8954182505607605, 'reward': 1.04375, 'reward_std': 0.6804182589054107, 'frac_reward_zero_std': 0.05, 'kl': 0.007894313777796924, 'entropy': 0.8249419704079628, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 51.37701006660209, 'epoch': 0.01}
 30%|###       | 15/50 [12:55<30:49, 52.84s/it] 32%|###2      | 16/50 [13:36<27:48, 49.06s/it] 34%|###4      | 17/50 [15:17<35:39, 64.83s/it] 36%|###6      | 18/50 [16:17<33:50, 63.45s/it] 38%|###8      | 19/50 [17:05<30:22, 58.79s/it] 40%|####      | 20/50 [17:56<28:14, 56.47s/it]                                               {'loss': -0.0173, 'grad_norm': 0.6406159996986389, 'learning_rate': 1.2400000000000002e-05, 'num_tokens': 97661.0, 'completions/mean_length': 236.1, 'completions/min_length': 81.6, 'completions/max_length': 481.2, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 236.1, 'completions/min_terminated_length': 81.6, 'completions/max_terminated_length': 481.2, 'rewards/format_reward_func/mean': 0.31875, 'rewards/format_reward_func/std': 0.24506223499774932, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.8802489399909973, 'reward': 0.96875, 'reward_std': 0.7267062425613403, 'frac_reward_zero_std': 0.1, 'kl': 0.013043209095485508, 'entropy': 0.925851471722126, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 59.242565241201376, 'epoch': 0.01}
 40%|####      | 20/50 [17:56<28:14, 56.47s/it] 42%|####2     | 21/50 [18:50<26:49, 55.50s/it] 44%|####4     | 22/50 [19:25<23:02, 49.37s/it] 46%|####6     | 23/50 [21:01<28:37, 63.61s/it] 48%|####8     | 24/50 [22:01<27:04, 62.46s/it] 50%|#####     | 25/50 [22:40<23:06, 55.48s/it]                                               {'loss': -0.0408, 'grad_norm': 0.7987353205680847, 'learning_rate': 1.04e-05, 'num_tokens': 120766.0, 'completions/mean_length': 186.4125, 'completions/min_length': 40.8, 'completions/max_length': 427.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 186.4125, 'completions/min_terminated_length': 40.8, 'completions/max_terminated_length': 427.8, 'rewards/format_reward_func/mean': 0.375, 'rewards/format_reward_func/std': 0.22108665406703948, 'rewards/correctness_reward_func/mean': 0.8, 'rewards/correctness_reward_func/std': 0.9210726857185364, 'reward': 1.175, 'reward_std': 0.8267040729522706, 'frac_reward_zero_std': 0.0, 'kl': 0.01866166479885578, 'entropy': 0.7732758536934853, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 55.954706999995686, 'epoch': 0.01}
 50%|#####     | 25/50 [22:40<23:06, 55.48s/it] 52%|#####2    | 26/50 [23:42<22:54, 57.29s/it] 54%|#####4    | 27/50 [24:45<22:35, 58.92s/it] 56%|#####6    | 28/50 [27:02<30:13, 82.43s/it] 58%|#####8    | 29/50 [27:56<25:51, 73.89s/it] 60%|######    | 30/50 [28:44<22:00, 66.04s/it]                                               {'loss': 0.1121, 'grad_norm': 0.4489275813102722, 'learning_rate': 8.400000000000001e-06, 'num_tokens': 145650.0, 'completions/mean_length': 209.25, 'completions/min_length': 55.8, 'completions/max_length': 562.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 209.25, 'completions/min_terminated_length': 55.8, 'completions/max_terminated_length': 562.8, 'rewards/format_reward_func/mean': 0.4125, 'rewards/format_reward_func/std': 0.1936569482088089, 'rewards/correctness_reward_func/mean': 0.65, 'rewards/correctness_reward_func/std': 0.8864624500274658, 'reward': 1.0625, 'reward_std': 0.6836185097694397, 'frac_reward_zero_std': 0.15, 'kl': 0.021181967481970786, 'entropy': 0.8304910376667977, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 71.64187444140407, 'epoch': 0.01}
 60%|######    | 30/50 [28:44<22:00, 66.04s/it] 62%|######2   | 31/50 [29:20<18:05, 57.12s/it] 64%|######4   | 32/50 [30:20<17:23, 57.96s/it] 66%|######6   | 33/50 [31:00<14:52, 52.50s/it] 68%|######8   | 34/50 [31:49<13:43, 51.47s/it] 70%|#######   | 35/50 [33:02<14:31, 58.10s/it]                                               {'loss': -0.0279, 'grad_norm': 0.8344684839248657, 'learning_rate': 6.4000000000000006e-06, 'num_tokens': 167875.0, 'completions/mean_length': 184.8125, 'completions/min_length': 51.8, 'completions/max_length': 437.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 184.8125, 'completions/min_terminated_length': 51.8, 'completions/max_terminated_length': 437.8, 'rewards/format_reward_func/mean': 0.4, 'rewards/format_reward_func/std': 0.19821222722530366, 'rewards/correctness_reward_func/mean': 0.8625, 'rewards/correctness_reward_func/std': 0.9726320624351501, 'reward': 1.2625, 'reward_std': 0.9113108873367309, 'frac_reward_zero_std': 0.05, 'kl': 0.02369613414630294, 'entropy': 0.6669085055589676, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 50.79190210799716, 'epoch': 0.02}
 70%|#######   | 35/50 [33:02<14:31, 58.10s/it] 72%|#######2  | 36/50 [34:23<15:06, 64.78s/it] 74%|#######4  | 37/50 [34:51<11:38, 53.72s/it] 76%|#######6  | 38/50 [35:31<09:56, 49.68s/it] 78%|#######8  | 39/50 [36:13<08:41, 47.42s/it] 80%|########  | 40/50 [36:49<07:21, 44.14s/it]                                               {'loss': 0.0467, 'grad_norm': 0.6463157534599304, 'learning_rate': 4.4e-06, 'num_tokens': 190121.0, 'completions/mean_length': 178.225, 'completions/min_length': 47.4, 'completions/max_length': 353.8, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 178.225, 'completions/min_terminated_length': 47.4, 'completions/max_terminated_length': 353.8, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.16303437054157258, 'rewards/correctness_reward_func/mean': 0.6625, 'rewards/correctness_reward_func/std': 0.9038085103034973, 'reward': 1.1, 'reward_std': 0.8213346004486084, 'frac_reward_zero_std': 0.1, 'kl': 0.03891579895280302, 'entropy': 0.7054083973169327, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 44.4948839411998, 'epoch': 0.02}
 80%|########  | 40/50 [36:50<07:21, 44.14s/it] 82%|########2 | 41/50 [37:53<07:30, 50.02s/it] 84%|########4 | 42/50 [38:54<07:05, 53.22s/it] 86%|########6 | 43/50 [39:32<05:41, 48.80s/it] 88%|########8 | 44/50 [40:36<05:19, 53.23s/it] 90%|######### | 45/50 [41:41<04:43, 56.70s/it]                                               {'loss': 0.0531, 'grad_norm': 0.6530311703681946, 'learning_rate': 2.4000000000000003e-06, 'num_tokens': 214105.0, 'completions/mean_length': 198.55, 'completions/min_length': 81.8, 'completions/max_length': 414.4, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 198.55, 'completions/min_terminated_length': 81.8, 'completions/max_terminated_length': 414.4, 'rewards/format_reward_func/mean': 0.45, 'rewards/format_reward_func/std': 0.13062257766723634, 'rewards/correctness_reward_func/mean': 0.6125, 'rewards/correctness_reward_func/std': 0.8481065273284912, 'reward': 1.0625, 'reward_std': 0.6923979759216309, 'frac_reward_zero_std': 0.15, 'kl': 0.022345097688958048, 'entropy': 0.7098902761936188, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 57.16380040039803, 'epoch': 0.02}
 90%|######### | 45/50 [41:41<04:43, 56.70s/it] 92%|#########2| 46/50 [42:42<03:52, 58.06s/it] 94%|#########3| 47/50 [43:05<02:22, 47.54s/it] 96%|#########6| 48/50 [43:28<01:20, 40.08s/it] 98%|#########8| 49/50 [44:04<00:38, 38.89s/it]100%|##########| 50/50 [44:48<00:00, 40.54s/it]                                               {'loss': 0.0024, 'grad_norm': 0.7053087949752808, 'learning_rate': 4.0000000000000003e-07, 'num_tokens': 237136.0, 'completions/mean_length': 185.7875, 'completions/min_length': 58.2, 'completions/max_length': 388.6, 'completions/clipped_ratio': 0.0, 'completions/mean_terminated_length': 185.7875, 'completions/min_terminated_length': 58.2, 'completions/max_terminated_length': 388.6, 'rewards/format_reward_func/mean': 0.4375, 'rewards/format_reward_func/std': 0.17078252136707306, 'rewards/correctness_reward_func/mean': 0.7625, 'rewards/correctness_reward_func/std': 0.8955427527427673, 'reward': 1.2, 'reward_std': 0.8229282617568969, 'frac_reward_zero_std': 0.1, 'kl': 0.025921272113919258, 'entropy': 0.7258255943655968, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'step_time': 36.9247891409992, 'epoch': 0.02}
100%|##########| 50/50 [44:48<00:00, 40.54s/it]                                               {'train_runtime': 2689.4084, 'train_samples_per_second': 0.297, 'train_steps_per_second': 0.019, 'train_loss': 0.012459934670478106, 'epoch': 0.02}
100%|##########| 50/50 [44:49<00:00, 40.54s/it]100%|##########| 50/50 [44:49<00:00, 53.79s/it]

--- Evaluating Model on Dataset A (Math) - Joint (50 samples) ---
Sample Output:  
1. First, we need to determine how many clips Natalia sold in May. Since she sold half as many clips in May as she did in April, we can calculate th...
Accuracy on Dataset A (Math) - Joint: 50.00%

--- Evaluating Model on Dataset B (Logic) - Joint (50 samples) ---
Sample Output:  
The context tells us that "Mary moved to the bathroom." This means that Mary is currently in a bathroom, so we can conclude that Mary is in the bath...
Accuracy on Dataset B (Logic) - Joint: 48.00%
